--June NSE
--Email 1a - 2025-06-05
--Email 1b - 2025-06-07

--Push 1 - 2025-06-02
--Push 2 - 2025-06-09
--Push 2 - 2025-06-10
--Push 3 - 2025-06-16
--Push 4 - 2025-06-23

-- observation windows for outcomes
declare min_obs_date date default '2025-06-02';
declare max_obs_date date default '2025-06-26';

--- campaign declarations
declare email_dates_campaign array <string> default ['2025-06-05', '2025-06-07'];

declare push_dates_campaign array <string> default ['2025-06-02', '2025-06-09', '2025-06-10', '2025-06-16', '2025-06-23'];

declare sms_dates_campaign array <string> default [];

--customer profile fw
declare fiscal_week_id_customer_profile default (
  select
  max(fiscal_week_id) as max_date
  from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_dates_promo b
  where b.d_date<min_obs_date
);

declare run_fiscal_week_id_12_w_ago default (
select min(fiscal_week_id) from (
  select distinct fiscal_week_id
from (select distinct fiscal_week_id from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_Dates)
where fiscal_week_id<fiscal_week_id_customer_profile
QUALIFY ROW_NUMBER() over (partition by NULL order by fiscal_week_id desc)<=11
) 
);

--tvc population
create or replace temporary table tvc as
SELECT 
  CAST(household_id AS INT64) AS household_id,
  target_group,
 email_flag,
 push_flag,
 0 as sms_flag,
  CASE 
    WHEN email_flag = 1 AND push_flag=0 THEN '1.Email-only'
    WHEN email_flag = 0 AND push_flag=1 THEN '2.Push-only'
    WHEN email_flag = 1 AND push_flag=1 THEN '4.Email+Push'
  END AS channel,
  division_id AS division_id,
  b4u_status AS b4u_status,
  facts_seg AS facts_seg,
  pd_reds AS avg_weekly_spend_bucket,
  my_needs_segment_id AS my_needs_segment_id, 
  true_price_segment_id AS true_price_segment_id,
  ecom_ind AS ecom_ind
FROM gcp-abs-udco-bsvw-prod-prj-01.udco_ds_bizops.PZN_JUNE_NATIONAL_SALES_2025_CATCHALL;

------------------------------------TEST ENGAGED-----------------------------------------
--- population reached out to
create or replace temporary table kd_email_campaigns_hh as
with
email_hhs as (
  select 
  household_id,
  1 as email_flag,
  count(distinct retail_customer_uuid) as n_customers_email,
  count(send_date) as total_send_dates_email,
  count(distinct CONCAT(theme, DMID)) as n_campaigns_email,
  array_agg(delivery_label) as all_delivery_labels_email,
  count(1) as n_rows_email,
  sum(case when failed_to_send=0 then send else 0 end) as total_send_email, 
  sum(open) as total_open_email, 
  sum(click) as total_click_email,
  max(case when failed_to_send=0 then send else 0 end) as distinct_send_email,
  max(open) as  distinct_open_email, 
  max(click) as distinct_click_email,
  max(unsubscribe) as unsubscribe_email,
  max(case when click=1 then send_date else null end) as max_click_date_email,
  min(case when click=1 then send_date else null end) as min_click_date_email,
  max(case when open=1 then send_date else null end) as max_open_date_email,
  min(case when open=1 then send_date else null end) as min_open_date_email,
  from gcp-abs-udco-mkbz-prod-prj-01.udco_ds_dem.SQ_EMAIL_DATA
  where True
  and cast(send_date as string) in UNNEST(email_dates_campaign)
  --and lower(delivery_label) like email_delivery_label
  and cast(send_date as date) <= max_obs_date
  and ((lower(delivery_label) like '%slot10_ecom-snl-crm_junestockup_bau_engaged_20250605%') or 
       (lower(delivery_label) like '%slot10_ecom-snl-crm_junestockup_bau_nonengaged_20250605%') or 
       (lower(delivery_label) like '%slot10_ecom-snl-crm_junestockup_pzn_engaged_20250605%') or 
       (lower(delivery_label) like '%slot10_ecom-snl-crm_junestockup_pzn_nonengaged_20250605%') or 
       (lower(delivery_label) like '%slot10_ecom-snl-crm_junestockup_bau_engaged_20250607%') or 
       (lower(delivery_label) like '%slot10_ecom-snl-crm_junestockup_bau_nonengaged_20250607%') or 
       (lower(delivery_label) like '%slot10_ecom-snl-crm_junestockup_pzn_engaged_20250607%') or 
       (lower(delivery_label) like '%slot10_ecom-snl-crm_junestockup_pzn_nonengaged_20250607%'))
  group by 1,2
)
select * from email_hhs;

create or replace temporary table kd_push_campaigns_hh as
with
push_hhs as (
  select 
  household_id,
  1 as push_flag,
  count(distinct customer_guid) as n_customers_push,
  count(send_date) as total_send_dates_push,
  count(distinct CONCAT(campaign)) as n_campaigns_push,
  array_agg(delivery_label) as all_delivery_labels_push,
  count(1) as n_rows_push,
  sum(case when failed_to_send=0 then send else 0 end) as total_send_push, 
  sum(open) as total_open_push, 
  sum(click) as total_click_push,
  max(case when failed_to_send=0 then send else 0 end) as distinct_send_push,
  max(open) as  distinct_open_push, 
  max(click) as distinct_click_push,
  max(case when click=1 then send_date else null end) as max_click_date_push,
  min(case when click=1 then send_date else null end) as min_click_date_push,
  max(case when open=1 then send_date else null end) as max_open_date_push,
  min(case when open=1 then send_date else null end) as min_open_date_push,
  NULL as unsubscribe_push  
  from gcp-abs-udco-mkbz-prod-prj-01.udco_ds_dem.SQ_PUSH_DATA
  where True
  and cast(send_date as string) in UNNEST(push_dates_campaign)
  --and lower(delivery_label) like push_delivery_label
  and cast(send_date as date) <= max_obs_date
  and ((lower(delivery_label) like '%ecom-snl-crm_pzn-bau-pn_wk23_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-clipped-pn_wk23_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-not-clipped-pn_wk23_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-bau-pn_wk24_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-clipped-pn_wk24_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-not-clipped-pn_wk24_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-clipped-apology-pn_wk24_2025_tue%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-not-clipped-apology-pn_wk24_2025_tue%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-bau-den-port-sea-ak-pn_wk24_2025_tue%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-clipped-den-port-sea-ak-pn_wk24_2025_tue%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-not-clipped-den-port-sea-ak-pn_wk24_2025_tue%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-bau-remainder-pn_wk24_2025_tue%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-clipped-remainder-pn_wk24_2025_tue%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-not-clipped-remainder-pn_wk24_2025_tue%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-bau-pn_wk25_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-clipped-pn_wk25_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-not-clipped-pn_wk25_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-bau-pn_wk26_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-clipped-pn_wk26_2025_mon%') or 
       (lower(delivery_label) like '%ecom-snl-crm_pzn-not-clipped-pn_wk26_2025_mon%'))
  group by 1,2
)
select * from push_hhs;

create or replace temporary table kd_sms_campaigns_hh as
with
sms_hhs as (
  select 
  household_id,
  1 as sms_flag,
  count(distinct customer_guid) as n_customers_sms,
  count(send_date) as total_send_dates_sms,
  count(distinct CONCAT(campaign)) as n_campaigns_sms,
  array_agg(delivery_label) as all_delivery_labels_sms,
  count(1) as n_rows_sms,
  -- sum(send+failed_to_send) as total_send_sms, 
  sum(case when failed_to_send=0 then send else 0 end) as total_send_sms, 
  NULL as total_open_sms, 
  sum(click) as total_click_sms,
  -- max(send+failed_to_send) as distinct_send_sms,
  max(case when failed_to_send=0 then send else 0 end) as distinct_send_sms,
  sum(NULL) as  distinct_open_sms,  --opens not tracked
  max(click) as distinct_click_sms,
  max(case when click=1 then send_date else null end) as max_click_date_sms,
  min(case when click=1 then send_date else null end) as min_click_date_sms,
  max(case when False then send_date else null end) as max_open_date_sms, --opens not tracked
  min(case when False then send_date else null end) as min_open_date_sms, --opens not tracked
  NULL as unsubscribe_sms  
  from gcp-abs-udco-mkbz-prod-prj-01.udco_ds_dem.SQ_SMS_DATA
  where True
    and cast(send_date as string) in UNNEST(sms_dates_campaign)
    --and lower(delivery_label) like sms_delivery_label
    and cast(send_date as date) <= max_obs_date
    and ((lower(delivery_label) like '%xxxxxxxxxxxxxxxxxxxxx%'))
  group by all
)
select * from sms_hhs;

-- merge all campaigns
create or replace temporary table all_campaigns_hh as
with 
combined as (
select COALESCE(e.household_id, p.household_id, s.household_id) as household_id,
COALESCE(email_flag,0) as email_flag,
COALESCE(push_flag,0) as push_flag,
COALESCE(sms_flag,0) as sms_flag,
e.* except (household_id, email_flag),
p.* except (household_id, push_flag),
s.* except (household_id, sms_flag)
from kd_email_campaigns_hh e
FULL JOIN kd_push_campaigns_hh p on e.household_id=p.household_id
FULL JOIN kd_sms_campaigns_hh s on (s.household_id=COALESCE(e.household_id,p.household_id))
),
final as (
  select *,
  CASE WHEN
    GREATEST(
      COALESCE(distinct_click_email,0),
      COALESCE(distinct_open_push,0),
      COALESCE(distinct_click_push,0),
      COALESCE(distinct_open_sms,0),
      COALESCE(distinct_click_sms,0)
    )>0 then 1 else 0 end as engaged,
    LEAST(
      COALESCE(min_click_date_email,'2100-01-01'),
      COALESCE(min_open_date_email,'2100-01-01'),
      COALESCE(min_click_date_push,'2100-01-01'),
      COALESCE(min_open_date_push,'2100-01-01'),
      COALESCE(min_click_date_sms,'2100-01-01'),
      COALESCE(min_open_date_push,'2100-01-01')
    ) as engaged_date_int
  from combined
)
select * except (engaged_date_int),
case when engaged != 1 then NULL else engaged_date_int end as engaged_date
from final
;

-----------------------------------FUNNEL------------------------------------------------------


-- --clips
-- create or replace temporary table clip_in_observation_hh as
-- select hh.household_id,
-- 1 as clipped, 
-- count(distinct hh.client_offer_id) as n_clips
-- from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_CLIPS hh --clips_raw clips
-- where clip_dt between min_obs_date and max_obs_date and household_id is not null
-- group by 1,2;

-- --clips
-- create or replace temporary table clip_in_observation_hh as
-- select hh.household_id,
-- 1 as clipped, 
-- count(household_id) as n_clips,
-- count(case when ((upper(OFFER_TYPE) = 'PD') and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')) then household_id else null end) as pd_clips,
-- count(case when ((upper(OFFER_TYPE) = 'SC') and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')) then household_id else null end) as sc_clips,
-- count(case when ((upper(OFFER_TYPE) = 'MF') and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')) then household_id else null end) as mf_clips,
-- count(case when ((upper(OFFER_TYPE) = 'GR') and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')) then household_id else null end) as gr_clips
-- from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_CLIPS hh --clips_raw clips
-- where clip_dt between min_obs_date and max_obs_date and household_id is not null
-- group by 1,2;

-- --redeemed
-- create or replace temporary table redeemed_in_observation_hh as
-- select household_id,
-- 1 as redeemed,
-- count(txn_id) as redemptions
-- --from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_REDEMPTIONS
-- from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.c360_online_redeeming_hhs
-- where txn_dte between min_obs_date and max_obs_date and household_id is not null
-- group by 1,2; 

-- --redeemed
-- create or replace temporary table redeemed_in_observation_hh as
-- select household_id,
-- 1 as redeemed,
-- count(txn_id) as redemptions,
-- count(case when ((upper(OFFER_TYPE) = 'PD') and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')) then household_id else null end) as pd_redemptions,
-- count(case when ((upper(OFFER_TYPE) = 'SC') and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')) then household_id else null end) as sc_redemptions,
-- count(case when ((upper(OFFER_TYPE) = 'MF') and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')) then household_id else null end) as mf_redemptions,
-- count(case when ((upper(OFFER_TYPE) = 'GR') and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')) then household_id else null end) as gr_redemptions
-- --from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_REDEMPTIONS
-- from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.c360_online_redeeming_hhs
-- where txn_dte between min_obs_date and max_obs_date and household_id is not null
-- group by 1,2; 

--clips
create or replace temporary table clip_in_observation_hh as
select hh.household_id,
1 as clipped, 
count(household_id) as n_clips,
count(case when (upper(OFFER_TYPE) = 'PD') then household_id else null end) as pd_clips,
count(case when (upper(OFFER_TYPE) = 'SC') then household_id else null end) as sc_clips,
count(case when (upper(OFFER_TYPE) = 'MF') then household_id else null end) as mf_clips,
count(case when (upper(OFFER_TYPE) = 'GR') then household_id else null end) as gr_clips
from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_CLIPS hh --clips_raw clips
where clip_dt between min_obs_date and max_obs_date and household_id is not null
and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') 
AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')
group by 1,2;

--redeemed
create or replace temporary table redeemed_in_observation_hh as
select household_id,
1 as redeemed,
count(household_id) as redemptions,
count(case when (upper(OFFER_TYPE) = 'PD') then household_id else null end) as pd_redemptions,
count(case when (upper(OFFER_TYPE) = 'SC') then household_id else null end) as sc_redemptions,
count(case when (upper(OFFER_TYPE) = 'MF') then household_id else null end) as mf_redemptions,
count(case when (upper(OFFER_TYPE) = 'GR') then household_id else null end) as gr_redemptions
--from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_REDEMPTIONS
from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.c360_online_redeeming_hhs
where txn_dte between min_obs_date and max_obs_date and household_id is not null
and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') 
AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')
group by 1,2; 

--shopped
create or replace temporary table shopped_in_observation_hh as
select household_id,
1 as shopped,
count(distinct txn_id) as txn_hh,
sum(item_qty) as qty_hh,
sum(net_sales) as net_sales_hh,
sum(net_sales- markdown_amt) as gross_sales_hh
from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_TXN
where txn_dte between min_obs_date and max_obs_date and household_id is not null
group by 1,2; 

--clips superbowl
create or replace temporary table clip_sb_in_observation_hh as
select hh.household_id,
1 as sb_clipped, 
count(household_id) as sb_n_clips,
count(case when (upper(OFFER_TYPE) = 'PD') then household_id else null end) as sb_pd_clips,
count(case when (upper(OFFER_TYPE) = 'SC') then household_id else null end) as sb_sc_clips,
count(case when (upper(OFFER_TYPE) = 'MF') then household_id else null end) as sb_mf_clips,
count(case when (upper(OFFER_TYPE) = 'GR') then household_id else null end) as sb_gr_clips
from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_CLIPS hh --clips_raw clips
where clip_dt between min_obs_date and max_obs_date and household_id is not null
and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') 
AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')
and client_offer_id in (
select distinct offer.client_offer_id from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_offer_upcs upc 
left join gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.c360_offer offer on upc.oms_offer_id = offer.oms_offer_id
-- where cast(upc.upc_id as numeric) in (select upc_id from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.c360_upc where department_nm in ('Meat', 'Seafood')))
where cast(upc.upc_id as numeric ) in (7114242378, 7114281777, 7114200948, 7572000854, 7572030020, 7572073411, 8265741157, 8265772323, 8265754221, 2259200811, 2259206669, 2259263777, 8304600817, 8304613480, 8304691164, 88939200031, 88939201017, 88939200028, 88939201019, 85248100715, 88939200090, 88939200091, 88939200170, 88939200172, 88939202131, 88939200075, 88939200130, 88939200174, 88939200032, 88939200132, 88939200154, 88939200176, 88939201002, 88939201001, 88939200134, 88939200156, 88939200178, 88939200059, 88939202139, 88939200139, 85248100712, 85248100711, 85248100710, 88939202141, 88939200086, 88939200362, 88939200120, 88939202143, 88939202145, 88939201014, 81829001279, 81829001280, 81829001193, 81829001281, 81829001282, 81829001381, 81829001851, 81829001833, 81829001834, 81829001937, 81829001850, 81829001832, 81829001283, 81829001382, 81829001284, 81829001285, 81829001275, 81829001672, 81829001277, 81829001854, 81829001944, 81829001626, 85977400784, 85977400727, 85977400772, 86998200005, 86998200001, 86998200000, 85977400742, 85977400783, 78616200151, 78616241107, 78616200612, 78616200610, 78616200622, 78616241121, 78616241076, 78616241059, 78616241068, 78616200608, 78616241069, 78616201000, 78616200530, 78616200298, 78616200485, 78616200498, 78616200531, 78616200379, 78616241074, 78616200425, 78616241083, 78616204000, 78616241188, 78616241186, 78616241136, 78616207000, 78616200297, 78616241134, 78616200296, 78616200373, 78616208000, 78616215000, 78616211000, 4900007935, 4900007940, 4900055573, 4900055572, 4900007933, 4900055571, 4900007934, 4900007931, 4900007942, 4900007932, 4900007937, 4900007938, 4900055417, 4900007936, 4900007939, 4900055444, 85817600206, 85000994257, 85000994233, 85817600248, 85817600205, 85817600227, 85817600217, 85000994259, 81011383022, 81011383134, 85817600250, 81011383136, 85817600211, 85817600277, 85817600213, 81011383140, 85817600295, 85000994231, 85817600252, 85817600296, 81011383021, 81011383020, 81011383130, 62830814009, 62830814011, 62830814010, 62830814031, 62825084280, 62825084276, 62825084278, 7342011614, 7342001614, 2529300149, 2529300099, 2529300098, 2529300136, 2529300119, 2529360217, 3663208014, 3663208078, 3663207267, 3663207268, 3663207735, 4127102564, 3663207974, 3663207810, 3663208006, 4127100955, 4127101788, 4127101997, 4127102502, 4127102568, 4127100970, 4127101993, 4127102258, 4127102256, 3663208092, 4127100472, 4127102253, 3663208091, 4127102260, 3663207809, 4127100908, 7457000400, 7457046203, 7457091010, 7457065140, 7457095015, 7457044400, 7457002400, 7457052400, 7457008406, 7457098025, 7457061739, 7457004408, 7457009400, 7457060686, 7457092849, 7457073192, 7457003400, 7457067459, 7457057918, 7457061532, 7457065057, 7457065058, 7457048338, 7457065030, 7457065176, 7457095003, 7457043400, 7457020864, 7457025117, 7457097608, 7457001400, 7457036092, 7457048418, 7457053400, 7457008400, 7457008005, 7457061007, 7457081011, 7457087659, 7457031995, 7457004400, 7457030544, 7457011400, 7457027400, 7255400154, 7255487026, 7255411146, 7255411057, 7255438745, 7255485201, 7255400153, 5000069659, 7255411119, 7255427399, 7255481457, 7255494573, 7255472183, 4154861004, 4154879245, 4154875095, 4154875150, 4154861404, 4154800004, 4154861604, 4154800005, 4154800007, 4154831260, 4154851718, 4154824404, 4154861204, 4154875092, 4154841362, 7457003310, 7457091935, 7457022403, 7457042854, 7457001310, 7457002310, 7457065562, 7255400004, 7255400003, 7255400005, 7255400002, 2780006763, 2780006558, 2780006469, 2780006557, 2780007657, 2780006644, 2780007810, 3010003319, 2780006467, 2780006555, 2780006643, 2780006477, 3010050561, 2780006476, 2780006586, 2780005860, 2780006794, 2780006970, 2780006571, 2780006394, 2780006570, 2780006580, 3010010026, 2780006480, 7225002108, 7225008396, 7225002109, 7225001137, 7225001138, 7225000685, 7225008420, 2840073740, 2840076296, 2840030850, 2840073580, 2840076014, 2840015458, 2840076017, 2840073742, 2840073745, 2840031501, 2840070504, 2840067973, 2840015463, 2840067971, 2840068427, 2840067977, 2840069836, 2840025492, 2840075056, 2840073314, 2840015443, 2840051549, 2840073756, 2840015446, 2840072955, 2840073759, 2840067960, 2840067969, 2840022772, 2840063763, 2840068537, 2840068856, 81060702497, 2840076238, 2840076239, 2840072749, 2840067950, 2840020546, 2840069335, 2840076000, 2840051288, 2840073894, 2840075995, 2840076644, 2840076009, 2840069291, 2840069405, 2840069603, 2840070553, 2840067947, 2840068119, 2840067945, 2840031041, 2840051779, 2840037649, 2840075088, 2840007230, 2840073228, 2840073701, 2840022988, 2840011262, 2840037650, 2840075092, 2840075095, 2840037619, 2840037618, 2840051783, 2840051782, 2840051781, 2840048277, 2840051780, 2840074003, 2840073994, 2840076105, 2840076548, 2840051784, 2840076305, 2840073997, 2840069347, 2840052838, 2840069346, 2840031040, 81060702508, 2840031046, 2840031044, 2840031283, 2840053274, 2840031407, 2840051776, 2840068690, 2840051775, 2840051774, 2840073720, 2840031406, 2840051773, 2840031403, 2840070648, 2840017335, 2840031404, 2840051778, 2840051777, 2840000617, 2840037790, 2840031409, 2840031050, 2840048278, 2840065979, 2840003400, 2840008314, 2840031058, 81060702443, 2840059888, 2840031054, 2840031055, 81060702445, 2840076607, 2840031413, 2840068751, 1600012479, 1600022195, 1600022233, 1600027532, 1600023117, 1600022205, 1600020104, 1600022235, 1600021658, 1600015163, 1600027515, 1600027526, 1600012254, 1600012222, 1600012025, 1600012399, 1600015128, 1600012544, 1600012542, 1600019707, 1600021191, 1800000401, 1800000501, 1800000211, 1800000415, 1800000526, 1800000757, 1800000512, 1800000420, 1800000058, 1800000210, 1800000075, 1800000142, 1800000186, 1800000183, 1800000260, 1800000182, 1800000918, 1800000318, 4280010953, 4280010915, 4280010924, 4280010921, 4280010954, 4280013828, 4280010952, 1600026460, 1600020094, 1600020093, 1600022098, 1600046684, 1600018793, 1600027706, 1600018794, 1600018892, 1600027707, 1600041727, 1600041126, 1600043980, 1600028920, 1600027855, 1600022101, 1600023121, 1600023119, 1600021211, 1600022242, 1600022243, 1600046679, 1600014481, 1600046757, 1600046758, 1600017944, 1600041314, 1600045898, 1600045798, 1600045897, 1600016893, 1600040761, 1600026470, 1600028372, 1600014732, 1600049298, 1600027700, 1600022693, 1600020088, 1600018145, 1600022931, 1600019430, 1600042419, 1600022782, 1600018573, 1600022228, 1600018910, 1600035540, 1600016212, 1600018575, 1600039700, 1600022093, 1600014711, 1600014733, 4119613975, 4119613974, 4119613978, 4119613976, 4119613977, 1583909719, 1583909721, 1583909720, 1583909671, 7835557010, 7835557000, 7835558000, 7835560035, 7835557025, 7835555000, 7835557005, 7835560018, 82951532226, 82951532580, 82951532616, 82951532653, 82951532577, 82951532645, 85186100609, 81118403028, 85186100607, 85186100606, 85186100616, 81118403144, 81118403125, 81118403025, 81118403020, 85186100612, 85186100611, 85186100666, 81118403000, 85186100610, 81118403186, 85186100686, 85186100671, 7261373945, 2420009456, 7261347410, 7261347420, 7261347415, 2420005448, 7261347418, 2420005347, 7261347417, 2420005386, 2420005482, 2420005362, 2420009420, 2420005467, 2420005464, 7261373916, 7261373978, 7261373947, 2420004490, 3760013872, 3760028428, 3760014173, 3760031639, 3760043470, 3760017534, 3760033658, 3760015121, 3760011544, 3760035930, 3760016900, 3760022121, 3760064205, 3760021758, 3760021750, 3760036215, 3760021753, 3760021756, 3760021760, 3760013260, 3760005849, 3760026524, 3760043561, 3760013282, 3760013264, 3760088385, 3760013283, 3760088384, 3760026030, 3760059320, 3760088388, 3760073580, 3760025836, 3760049767, 3760039051, 3760073620, 3760035629, 3760018237, 3760037939, 3760027468, 3760047371, 7287829078, 3760025756, 7287829079, 3760015491, 7287829080, 3760048713, 4410015618, 4410015619, 4410015620, 4410019081, 4410019092, 4410015621, 4410019080, 4410019093, 4157005617, 4157005621, 4157009915, 4157005670, 4157014999, 4157005618, 4157010993, 4157005625, 4157010964, 4410019074, 4410019095, 4410016502, 4410019094, 4410019076, 4410019075, 7357013000, 7357013006, 7357013007, 7357056575, 7357013033, 7357013003, 5150004815, 5150000630, 5150004816, 5150004962, 5150021179, 5150082556, 2550030407, 2550030439, 2550030442, 2550030443, 2550030440, 2550030441, 2550030411, 2550030444, 2550030445, 88810911010, 88810911180, 88810911060, 88810911061, 88810911385, 88810911423, 88810911224, 88810925261, 88810911503, 88810925022, 88810925584, 88810925661, 88810925266, 88810925614, 88810925458, 88810925937, 88810925934, 88810925616, 88810925858, 88810925935, 88810925939, 88810911497, 88810911016, 88810911058, 88810911059, 88810911411, 88810925450, 25136200000, 88810925454, 88810925850, 88810925688, 88810925524, 88810911084, 88810911001, 88810911485, 88810911401, 88810911006, 88810911402, 88810911004, 88810911009, 88810911007, 88810911525, 88810925488, 88810925437, 88810925559, 88810925999, 88810925556, 88810926008, 88810925439, 88810925516, 88810911078, 88810911155, 88810911079, 88810911198, 88810925032, 88810925472, 88810925475, 88810911403, 88810925994, 88810911535, 88810911459, 88810925514, 88810925901, 88810911121, 88810911131, 88810911138, 88810911244, 88810911428, 88810911064, 88810911312, 88810925744, 88810911090, 88810915003, 88810915004, 88810911188, 88810911065, 88810911088, 88810911154, 88810915002, 88810925465, 3997800844, 3997802596, 3997803420, 7430500132, 86000046850, 86000046853, 85004792019, 4364620128, 4364620400, 4364610482, 4364646101, 4364620758, 2410010685, 2410000017, 2410044077, 2410051445, 2410078925, 2410011098, 2410078887, 2410059473, 2410000019, 2410059475, 2410012137, 2410010633, 2410011660, 2410011487, 2410078909, 2410012418, 2410078938, 2410012090, 2410078914, 2410011062, 2410059441, 2410078895, 2410011060, 2410012292, 2410012424, 2410012435, 2410010443, 2410012129, 2410012404, 2410010445, 2410049384, 2410010608, 3010010057, 3010010055, 3010010068, 3010010309, 3010012460, 3010078458, 3010010614, 3010011176, 3010012902, 3010010070, 3010012977, 2410011441, 3800013841, 3800013927, 3800029312, 3800028445, 3800018060, 3800028447, 3800029835, 3800030500, 3800030263, 3800024939, 3800013881, 3800013860, 3800030190, 3800024556, 3800013863, 3800013843, 3800013887, 3800024553, 3800029741, 3800029322, 3800030498, 3800030496, 3800028017, 3800029888, 3800028458, 3800028019, 3800018371, 3800027647, 3800024349, 3800013872, 3800013897, 3800016527, 3800021791, 3800013857, 3800028021, 3800029310, 3800029376, 3800028023, 8768400107, 8768400094, 8768401063, 8768400287, 8768400113, 8768400112, 4300008403, 8768400100, 8768400099, 8768400110, 4300008401, 8768400097, 8768400095, 8768400106, 8768400115, 8768400114, 2100065883, 2100002809, 7766100316, 7766100313, 7766100412, 7766101513, 7766104813, 7766111909, 7766100112, 7766102913, 7766116185, 7766101413, 7766100813, 7766111792, 7766111593, 7766116628, 7766113858, 7766111798, 7766104213, 7766100012, 89824800107, 89824800150, 84029070014, 89824800184, 89824800156, 89824800157, 89824800110, 89824800143, 89824800100, 89824800111, 84029070031, 84029070030, 89824800106, 89824800158, 89824800148, 4767739129, 4767748527, 4767739128, 4767748525, 4400006023, 4400006045, 4400007299, 4400007298, 4400006842, 4400007975, 4400007215, 4400007214, 4400001473, 4400007378, 4400008142, 4400006041, 4400007803, 4400007767, 4400005903, 4400005869, 4400006518, 4400007805, 4400007465, 4400006017, 4400006699, 4400007227, 4400006016, 4400006697, 4400007742, 4400008151, 4400008152, 4400008070, 4400007183, 4400008108, 4400007739, 4400006024, 4400007550, 4400006028, 4400007832, 4400006027, 4400007798, 4400006026, 4400007511, 4400007797, 4400008168, 4400006025, 4400006063, 4400007196, 4400007590, 4400006854, 4400007708, 4400007706, 4400007705, 4400006112, 4400007321, 4400007320, 4400005389, 4400006039, 4400007722, 4400006038, 4400007963, 4400006113, 4400007759, 4400007515, 4400007559, 4400003111, 4400007773, 4400008104, 4400007249, 4400005781, 4400005043, 4400005094, 4400005041, 4400005109, 4400005105, 4400005129, 4400005106, 4400005104, 4400007771, 4400007545, 4400007770, 4400007970, 4400003483, 4400008039, 4400008248, 4400003133, 4400008343, 4400003113, 4400008042, 4400008175, 4400002389, 4400003115, 4400003545, 4400003117, 4400003116, 4400003544, 4400005359, 4400003119, 4400007905, 4400005098, 4400005550, 4400008107, 4400008067, 4400008066, 4400008143, 4400003049, 4400003048, 4400007526, 4400007525, 4400005549, 4400004472, 4400005166, 4400004471, 4400005642, 4400006457, 4400008078, 4400005643, 4400005840, 4400006456, 4400005168, 4400005839, 4400004546, 4400006923, 4400006922, 4400004545, 4400006409, 4400006925, 4400006924, 4400005099, 4400005132, 4400005133, 4400005174, 4400007232, 4400008404, 4400005136, 4400004488, 4400005134, 4400005135, 4400005172, 4400000878, 4400005801, 4400006458, 4400007828, 4400007827, 4400005100, 4400007524, 4400003047, 4400005101, 4400005138, 4400004446, 4400003219, 4400003394, 4400006397, 4400003223, 4400004466, 4400007269, 4400002991, 4400003221, 4400008131, 4400006393, 4400002456, 4400003225, 4400006986, 4400004913, 4400004637, 81029100100, 81029100775, 81029100797, 81029100896, 81029100876, 81029100413, 81029100778, 81029100719, 81029100101, 81029100685, 81029100102, 81029100783, 81029100367, 81029100445, 81029100687, 81029100104, 81029100105, 81029100766, 81029100106, 81029100446, 81029100724, 81029100768, 81029100108, 81029100109, 81029100208, 81029100092, 81029100192, 81029100370, 81029100230, 81029100790, 81029100176, 81029100694, 81029100771, 81029100298, 81029100696, 81029100795, 81029100894, 81029100794, 4400007841, 4400007792, 4400007840, 4400008125, 4400008010, 4400008021, 4400008172, 4400007836, 4400007835, 4400007846, 4400007834, 4400007845, 4400007844, 4400007839, 4400007838, 81029100982, 4400007837, 4470002454, 4470010319, 4470010416, 4470010417, 4470007092, 4470010349, 4470010426, 4470010320, 4470010321, 4470010351, 4470002410, 4470036000, 4470010350, 4470036002, 4470036035, 4470002411, 4470002455, 4470036001, 4470002458, 75166677155, 75166616505, 75166648005, 75166695005, 75166677225, 75166610315, 75166610305, 75166641685, 75166610345, 75166641645, 76770700214, 76770700106, 76770700167, 76770701480, 76770701350, 76770700125, 76770700215, 3077213451, 3077208813, 3077204311, 3077204312, 3077209204, 3077206132, 3077208797, 3077213217, 3077201570, 3077204170, 3077208471, 3077208470, 3077215705, 3077216014, 3077216019, 3077205662, 3077216041, 3077205630, 3077206166, 3077215663, 3077215662, 3077216020, 3077216277, 3077219274, 1200000230, 7800001356, 1200010542, 7800001397, 1200003098, 7800003532, 7800003536, 1200000971, 1200000496, 1200024029, 1200000935, 4300099608, 1200017226, 1200020237, 7800020746, 7092500030, 7800009846, 7800001407, 1200000492, 7800008246, 7800003552, 7800001371, 7800001336, 1200016346, 1200017237, 7800002300, 7800000408, 7800021546, 7800003119, 7800001416, 1200000113, 1200000311, 1200000233, 1200001321, 1200000231, 1200001881, 1200022147, 1200000952, 1660051312, 4300095265, 7800020646, 1200003066, 1200006453, 7800020446, 1200006452, 1200024014, 4171011288, 1200000341, 7800039416, 7800008346, 1200000746, 1200017213, 1200017258, 1200017252, 1200017176, 1200014092, 7800001315, 7800003507, 1200014113, 1200017173, 1200014093, 1200014095, 7800008239, 1200014094, 1200020320, 7800002639, 7800003823, 5200013513, 5200004234, 5200004233, 5200004232, 5200004231, 5200004678, 5200004314, 5200005028, 5200010411, 5200010410, 5200013508, 5200004704, 5200004328, 5200004327, 5200010241, 5200013490, 5200004403, 5200005798, 5200004400, 5200013514, 5200013515, 5200005451, 5200013516, 5200005230, 5200013517, 5200013519, 5200001029, 5200013528, 5200005802, 5200010297, 81809400577, 81809400580, 81809400581, 81809400582, 81809400583, 81809400585, 81809400860, 81809400025, 81809400300, 81809400586, 81809400587, 81809400588, 1200022092, 81809400589, 81809400828, 81809400070, 81809400590, 81809400591, 81809400592, 81809400593, 81809400594, 81809400873, 1200023071, 81809400875, 81809400998, 1200022186, 81809400681, 81809400002, 81809400840, 1200023041, 81809400208, 1200023043, 81809400691, 81809400495, 81809400650, 81809400497, 81809400574, 81809400575, 81809400971, 81809400499, 81809400576, 81809400973, 1200024060, 81809400578, 81809400579, 81809400975, 1200023051, 1200024062, 81809400537, 81809400977, 1200023053, 81809400858, 1200023045, 1200023047, 1200023049, 5200000339, 5200001361, 5200000296, 5200005035, 5200004154, 5200000342, 5200000297, 5200000344, 5200000299, 5200000343, 5200005270, 5200004274, 5200070778, 5200070777, 5200070779, 5200001358, 5200000338, 5200004749, 5200005490, 1200028617, 1200020649, 9800010035, 1200020651, 1200004283, 1200028621, 1200028620, 1200021351, 1200018094, 1200028624, 1200028623, 1200028622, 1200004643, 1200028618, 1200004117, 1200021346, 1200004644, 1200018103, 1200021348, 9800010043, 1200018105, 1200028619, 7701361557, 7701361559, 7701361563, 7701361574, 7701361598, 7701361570, 7701361581, 7701361572, 7701301172, 7701301317, 7701301314, 7701301065, 7701301131, 7701301130, 75579517501, 75579537539, 75579537504, 75579537527, 75579537513, 75579537535, 75579537568, 75579537514, 75579537577, 75579537545, 75579537567, 75579537575, 75579537551, 75579537573, 75579537552, 75579537574, 75579537571, 75579537550, 75579517502, 75579570000, 75579570007, 75579570008, 75579570101, 75579570003, 75579570005, 75579570001, 75579570100, 81006371030, 81006371170, 81006371031, 81006371130, 81006371032, 81006371033, 81006371055, 70958651483, 81006371105, 81006371007, 81006371029, 81006371008, 81006371107, 70958651489, 70958651487, 70958651485, 81006371088, 81006371012, 81006371013, 81006371035, 72419081287, 81006371014, 81006371036, 81006371059, 81006371016, 81006371017, 81006371039, 3000031182, 3000031181, 3000031280, 3000031407, 3000031188, 3000031271, 3000031282, 3000031184, 3000031175, 3000031269, 3000031180, 3000006322, 3000057322, 3000057802, 3000057801, 3000057812, 3000057853, 3000056083, 3000006354, 3000057323, 3000057288, 3000057321, 3000066507, 3000057361, 3000057578, 3000057362, 1530044051, 1530043053, 1530044082, 42630004801, 1530043048, 1530044017, 1530043047, 1530043006, 1530043028, 1530044016, 1530043980, 1530044035, 1530044036, 1530043024, 1530044033, 1530044132, 1530043023, 1530043061, 1530044032, 1530043060, 26755, 1530001406, 1530001428, 26757, 1530043059, 42632009101, 1530044049, 1530044002, 1530044025, 1530043034, 1530043078, 61126981899, 61126900312, 61126900214, 61126917452, 61126932121, 61126918246, 61126900192, 61126920643, 61126900173, 61126900130, 61126900252, 61126900165, 61126900101, 61126900244, 61126928310, 61126900226, 61126900304, 61126900206, 61126911357, 61126971646, 61126962373, 61126933282, 61126921245, 61126900184, 61126900261, 61126900164, 61126900270, 61126900276, 4610000122, 4610000123, 4610000189, 4610000222, 4610000223, 4610002048, 4610000121, 4610000165, 4610000221, 4610002046, 4610000226, 4610000106, 4610000125, 4610000224, 4610000268, 4610000107, 4610035788, 4610035786, 4610041107, 4610041106, 4610040059, 4610020303, 4610040076, 4610040096, 4610040051, 4610000692, 4610040012, 4610000272, 4610000233, 4610000113, 4610000110, 4610000694, 4610000114, 4610040092, 4610040029, 4610080085, 4610000163, 4610000164, 4610040002, 4610020295, 4610040066, 4610035403, 4610000941, 4610000942, 4610035627, 4610000940, 4610001115, 4610000967, 4610035339, 4610000968, 4610035338, 4610000943, 4610001912, 4610035632, 4610035631, 4610035341, 85006583502, 85006583508, 85006583504, 85006583512, 85006583500, 85006583510, 85006583514, 85006583532, 1657191030, 1657194035, 1657194037, 1657194038, 1657195087, 1657194033, 1657194034, 1657195084, 1657195085, 1657195086, 1657191126, 1657195924, 1657195926, 1657191125, 1657194039, 1657195920, 1657195889, 1657195922, 1657124611, 1657191031, 1657195477, 1657124614, 1657195352, 1657195396, 1657191032, 1657195030, 1657195790, 1657124574, 1657124573, 1657124576, 1657124575, 1657191037, 1657195436, 1657195437, 1657195267, 1657195268, 1657195424, 1657195780, 1657195781, 1657195029, 1657195696, 1657195334, 1657194042, 1657196023, 1657195210, 1657195211, 1657194040, 1657195535, 1657195810, 1657195338, 1657195812, 1657195966, 1657195968, 1657195970, 1657196055, 1657196059, 1657196061, 3022304156, 3022302433, 3022302432, 3022304218, 3022306138, 3022304114, 3022302434, 3022304230, 82486200631, 3022304150, 82486200630, 3022304074, 3022304151, 3022306099, 3022306110, 3022304152, 82486200632, 3022306161, 3022304206, 3022301198, 3022304109, 3022304048, 3022306126, 3022304225, 3022306008, 3022304186, 3022306200, 3022304189, 3022304064, 3022304185, 7283008114, 7283008141, 7283008140, 7283008101, 7283008123, 7283008122, 7283008144, 7283008121, 7283008143, 7283008105, 7283008127, 7283008104, 7283008126, 7283008103, 7283008125, 7283008109, 7283008108, 7283008107, 7283008129, 7283008106, 7283008112, 7283008111, 7283008110, 7283008132, 7283008116, 7283008138, 7283008115, 7283008137, 7283008136, 7283008113, 7283008119, 7283008118, 7283008139, 2370005588, 2370005585, 4800121348, 4800120436, 4800121358, 4800120437, 4800121351, 4800121350, 4800121372, 4800101663, 4800101662, 4800135450, 4800135428, 4800135385, 4800135384, 4800135449, 4800102599, 4800110896, 4800135386, 7585600110, 7585600170, 7585613901, 7585602415, 7585603114, 7585601113, 7585600089, 7585601120, 7585600084, 7756700154, 7756700158, 7756700157, 7756700388, 7756700156, 7756700365, 7756700121, 7756700363, 7756700384, 7756708516, 7756727442, 7756700381, 7222022032, 7222022041, 7222021997, 7222021996, 7222021994, 7222021990, 7222022034, 1411373406, 1411391084, 1411391061, 1411391063, 1411391085, 1411370194, 1411370238, 1411370035, 1411370156, 1411370036, 1411370104, 85002101543, 85005175526, 85002101526, 85002101562, 85002101544, 85002101532, 85002101565, 5000024731, 5000037753, 5000045530, 5000045676, 5000048025, 5000061599, 5000061944, 5000064869, 5000066617, 5000068446, 5000069669, 5000070500, 5000074875, 5000083281, 5000087685, 76211197222, 5000094788, 5000094919, 76211100099, 76211100109, 76211100139, 76211188810, 76211188811, 76211188812, 76211194958, 76211194960, 76211188813, 76211188818, 76211189531, 76211192557, 76211193025, 76211140508, 76211144221, 76211108024, 76211109333, 76211110555, 76211116504, 76211142732, 76211169195, 76211143432, 76211116506, 76211116543, 76211123603, 76211130100, 76211130528, 76211114275, 76211101439, 76211120602, 76211120603, 76211120604, 76211120605, 76211120609, 76211120611, 76211120612, 76211120613, 76211120624, 76211120625, 76211123334, 76211134374, 76211140598, 76211143514, 76211145398, 76211148306, 76211148308, 76211151103, 76211152983, 76211155935, 76211157059, 76211157170, 76211162281, 76211162285, 76211162286, 76211162287, 76211162289, 76211162290, 76211162291, 76211179575, 76211181056, 76211181059, 76211185714, 76211188554, 76211193428, 76211193446, 76211193448, 76211193598, 76211194980, 76211198040, 76211199617, 76211199618, 76211138012, 76211138013, 76211138015, 76211147021, 76211156158, 980000055, 980051204, 82926200034, 82926200033, 82926200143, 82926200035, 82926200069, 82926200218, 82926200452, 82926200453, 82926200454, 82926200469, 82926200468, 81012597069, 81012597070, 86373700016, 85174100833, 84026632458, 84026630000, 88939200116, 88939200128, 88939208076, 88939208061, 88939208862, 88939208005, 64384371448, 64384380086, 64384371466, 64384380073, 64384380095, 64384371451, 64384371504, 64384371658, 64384371655, 64384371610, 64384371502, 64384371667, 64384371588, 64384371590, 7007466897, 7007468167, 7007466891, 7007467166, 7007468461, 7007468170, 7007440711, 7007440705, 7007453807, 7007451785, 7007440701, 4167967566, 4167967466, 4167967666, 74982600016, 74982600008, 74982600019, 74982600010, 81771902240, 81771902175, 81771902165, 81771902248, 81771902171, 78656015312, 82926200181, 82926200183, 82926200184, 82926200182, 82926200023, 82926200095, 82926200096, 82926200020, 82926200031, 82926200010, 82926200021, 82926200170, 82926200094, 82926200004, 82926200007, 82926200022, 82926200001, 82926200002, 82926200003, 82926200157, 82926200008, 82926200009, 82926200331, 82926200386, 85777700423, 85777700418, 85777700419, 85777700468, 85777700420, 19390800517, 85777700474, 78769283961, 78769283964, 72225206876, 72225206869, 72225206877, 72225206879, 72225206878, 72225206880, 72225206882, 72225206881, 81000647272, 81000647270, 81000647984, 81000647278, 81000647280, 1204405897, 1204406060, 1204406064, 1204405892, 1204406309, 1204406320, 1204403753, 1204403752, 1204403861, 1204401113, 1204403963, 1204405654, 1204403969, 1204403869, 3700073388, 3700073413, 3700094479, 3700098325, 3700094480, 1204404494, 1204403750, 1204404609, 1204404610, 1204404611, 1204404612, 1204404613, 1204404614, 1204404816, 1204404817, 1204404989, 1204405381, 1204405657, 1204405661, 1204405666, 1204405667, 1204405670, 1204405671, 1204405678, 1204405737, 1204438970, 12044045145, 12044056769, 1204401560, 1204402036, 1204402180, 1204402335, 1204402983, 1204402999, 1204403000, 1204403006, 1204403756, 1204403759, 1204403962, 1204404089, 1204404108, 1204404407, 1204404511, 7940026654, 7940044834, 7940035299, 7940038641, 7940035293, 7940035297, 7940035120, 7940059301, 7940063101, 7940069144, 7940006671, 7940031153, 7940059303, 7940031152, 7940006672, 7940044603, 7940034218, 7940057629, 7940034242, 7940059146, 7940034219, 7940051183, 7940051182, 7940060068, 7940044778, 7940063428, 7940046946, 7940069179, 7940045814, 7940044786, 7940051753, 7940051776, 7940051755, 7940051978, 7940052806, 7940007217, 7940007216, 7940044821, 7940051995, 7940026655, 7940051996, 7940045025, 7940051999, 7940031247, 7940051997, 7940026540, 7940026570, 7940044870, 7940020570, 7940021628, 7940066914, 7940006147, 7940031260, 7940001343, 7940001743, 7940025190, 7940058719, 7940026560, 7940058708, 7940011802, 7940031175, 7940027532, 7940031268, 7940046170, 1111157598, 1111124093, 1111126285, 1111100793, 7940055020, 7940055110, 7940016118, 7940058983, 7940046106, 7940006125, 7940007365, 7940046105, 7940046969, 7940046978, 7940026102, 7940053430, 7940019720, 7940055300, 7940058987, 7940026094, 7940026093, 7940037997, 85003036052, 85003036030, 85004205829, 85003036042, 85005667118, 85005667119, 85005667120, 85005667168, 81215403001, 81215403081, 81215403508, 81215403838, 81215403008, 81215403018, 81215403117, 81215403005, 3077218337, 81215403003, 81215403144, 3077218340, 81215403172, 81215403293, 38371100250, 38371100249, 38371100246, 38371100247, 7940005248, 7940044659, 7940020239, 7940051328, 2279691670, 2279691006, 2279691611, 2279691005, 2279690090, 2279691612, 2279690092, 5280068184, 5280068187, 2279691671, 2279691015, 2279691014, 7940086660, 7940050730, 7940050740, 4589308053, 7940064948, 7940064949, 4589303305, 7940086670, 2240001176, 2240000521, 2240001408, 2240001407, 2240064045, 2240064261, 2240064316, 2240001392, 2240064336, 2240001173, 2240001393, 2240039368, 2240039366, 2240039365, 2240001177, 2240001394, 2240039363, 2240039362, 2240039361, 2240026512, 2240000522, 2240000800, 2240000205, 2240000986, 2240026518, 2240062374, 2240062392, 2240039379, 2240062366, 2240001181, 2240039377, 2240001143, 2240001264, 2240039375, 2240001362, 2240039373, 2240001147, 2240039372, 2240001145, 2240001266, 2240001146, 2240001267, 7940018181, 7940046666, 7940006664, 4589306359, 7940085860, 7940081670, 7940006296, 7940006663, 7940006661, 7940006662, 7940018182, 7940045031, 7940018183, 7940045030, 7940019375, 7940019373, 7940045953, 7940045948, 7940012196, 7940049593, 7940049597, 7940049592, 7940049596, 7940049594, 7940049599, 38371100049, 7940046535, 7940049797, 38371100048, 7940049272, 7940049269, 7940052235, 81215403327, 81215403849, 81215403328, 81215403658, 81215403657, 81215403535, 81215403325, 81215403534, 81215403324, 81215403533, 81215403323, 81215403322, 81215403531, 81215403762, 81215403850, 81215403761, 81215403661, 81215403660, 3077206325, 3077206328, 3077206329, 3077206324, 3077206301, 3077206299, 30772062999, 30772063019, 30772063248, 30772063255, 30772063286, 30772063293, 84031740079, 1204404622, 1204404624, 1204404604, 1204404593, 1204404771, 1204404597, 1204404773, 1700002404, 1700002411, 1111161011, 1111101073, 1111161164, 1111102717, 1111104066, 1111161015, 1111161334, 1111161117, 1111104898, 1111121648, 1111107626, 85523500748, 81000647159, 81000647801, 85523500751, 81793901861, 81793901860, 84353610788, 84353611137, 84353610024, 81793901858, 84353610482, 81793901859, 81793901856, 81793901944, 81793901857, 81793901945, 81793901855, 81215403329, 81215403504, 81215403334, 81215403344, 81215403685, 81215403332, 81215403330, 1204405139, 3700085205, 1204405084, 1204405082, 1204405086, 1204405097, 1204405136, 1204405089, 7940032362, 7940032371, 7940049667, 7940032363, 7940049784, 7940049780, 7940032369, 1111112425, 1111163154, 1111112331, 1111104908, 1111101722, 1111104008, 1111102583, 1111101040, 1111103344, 1111107973, 1111112518, 1111152720, 1111107470, 1111111522, 1111112224, 1111126270, 1111101412, 1111165323, 1111101413, 1111101414, 1700035085, 1700035079, 1700004728, 1700015083, 1700098870, 4589307224, 4589307227, 7214002747, 7214003606, 7214003517, 7214003205, 7214003520, 7214002717, 7214002739, 7965604971, 7965604496, 7965604972, 7965614296, 7965602451, 7965613321, 7965613323, 7965614297, 7965600025, 7965604663, 7965601332, 7965603165, 7965603178, 7965603179, 7965604968, 7965605080, 7965605140, 7965605141, 7965613089, 7965613153, 7965613160, 7965614029, 7965614293, 7965601806, 7965602560, 7965605082, 7965614030, 7548608989, 7548609112, 7548608965, 7548609192, 7548613763, 7548614034, 7548614035, 7548614292, 7548614294, 7548614295, 7548608747, 7548608742, 7548608743, 7548609191, 7548614311, 7548608987, 7548609114, 7548609117, 8680068790, 8680010039, 8680010038, 8680068785, 8680087025, 8680087270, 8680011282, 8680010357, 8680011082, 8680068770, 8680010043, 8680011158, 8680011151, 8680011254, 8680011253, 8680006650, 8680087274, 8680019456, 8680019370, 8680006645, 8680087272, 8680010032, 81134602003, 81134602001, 81134602007, 81134602009, 84105800564, 84105800338, 84105800549, 84105801990, 84105800562, 84105802345, 84105802209, 7033074663, 7033074915, 7033074784, 7033074938, 7033071417, 7033072259, 7033074181, 7033074327, 7033071987, 7033073231, 84105800520, 84105800526, 84105800528, 84105800529, 84105801196, 84105800365, 84105802009, 84105804802, 85424200604, 85538000428, 81007508012, 81007508016, 85462000805, 81000647929, 81007508170, 85538000487, 85462000801, 85462000803, 85523500799, 85424200608, 4740011579, 4740067214, 4740067215, 4740012598, 4740065867, 4740011566, 4740012602, 4740004474, 4740004472, 4740068036, 4740064990, 4740031391, 4740031535, 4740030071, 4740031389, 4740030106, 4740031392, 7830009922, 7830009923, 7830014110, 7830008136, 7830014108, 7830013518, 7830014109, 7830014038, 7830014022, 7830014044, 7830014042, 7830014043, 7830014027, 3700093755, 3700081684, 3700086648, 3700088761, 3700088757, 3700088736, 3700088707, 3700081022, 3700056218, 3700073804, 3700088727, 3700088730, 3700072810, 7301071441, 7301071447, 7301071830, 7301071135, 7301000922, 7301071124, 7301071631, 7301071633, 7301071338, 7301071450, 7301000455, 7301071453, 7301000915, 7301000370, 7301001217, 7301001531, 7301001347, 7301071133, 7301063111, 7301071513, 7301071297, 3077200441, 3077203236, 7301071302, 7301071629, 7301071630, 7301071829, 7301071831, 3700076566, 3700081756, 3077203242, 3700025540, 3700097949, 3700081690, 7007458050, 7007458059, 7007458056, 7007458053, 7007466920, 81957301066, 85269700128, 85269700127, 81957301027, 81957301566, 81957301699, 85269700129, 81957301553, 81957301700, 81957301173, 81957301592, 81957301171, 81957301172, 81957301590, 81957301067, 81957301232, 81957301552, 81957301231, 81957301170, 2392320196, 2392320459, 2392333498, 82951532364, 2392323624, 2392323603, 2392323627, 2392323628, 2392353295, 2392353297, 2392333012, 2392333013, 2392333011, 1500007437, 1500004414, 1500007439, 1500007458, 1500081018, 1500004411, 1500004466, 1500007433, 1500007444, 1500007438, 1500004405, 1500004417, 1500093410, 1500093416, 1500093417, 1500007492, 1500081012, 1500007430, 1500081015, 1500020574, 1500020576, 2800081209, 2800093487, 3600031890, 3600048756, 3600050467, 3600055530, 1920077182, 1920089346, 1920089347, 1920081700, 1920097181, 1920085058, 1920081145, 1920081143, 1920099802, 1920089289, 1920098772, 1920075352, 1920099650, 1920002522, 1920076878, 1920098391, 1920080088, 1920085020, 1920002699, 1920000888, 1920099653, 1920002569, 1920078915, 1920082515, 1920082516, 1920082513, 4142004854, 7920006068, 4142001623, 4142008472, 4142008084, 4142001625, 4142008085, 4142008023, 7920005523, 4142008090, 4142008092, 7920008227, 3746601584, 954244133, 954244298, 3746601855, 3746601585, 954203446, 3746601400, 954200906, 954203189, 954245414, 954200419, 7046203596, 7046200905, 7046203598, 7046201372, 7046201371, 7046203600, 7046200920, 7046243351, 7046201090, 7046200522, 5770001727, 2089124709, 3077213354, 3077213353, 3700074968, 3700074969, 3700074971, 3700082881, 3700079466, 3700082879, 3700082876, 3700074962, 3700077583, 3700077584, 3700077599, 3700059643, 3700059644, 3700059605, 3077218866, 3700059606, 3700059627, 3077218865, 3700086225, 3700086226, 3700086224, 3700086223, 3700071507, 3700071512, 3700071543, 3700071486, 3077213355, 3077213352, 3700071483, 3700076469, 3700076470, 3700072406, 3700072407, 3700076466, 3700076510, 3700076468, 3700076416, 3077210431, 3700094174, 3700075416, 2113034614, 2113034615, 7989311055, 7989316144, 7989316179, 7989316178, 7989316180, 7989340589, 7989316181, 7989312499, 7989312498, 7989311116, 7989311115, 7989311118, 7989311117, 2113008800, 2113008490, 2113009261, 2113009262, 2113008970, 2113008853, 2113008810, 2113008767, 2113008801, 2113008802, 2113008803, 2113008808, 2113008809, 2113013356, 2113013355, 2113016442, 2113016440, 2113009671, 2113024246, 2113024247, 2113008860, 2113009675, 2113008862, 2113009676, 2113009677, 2113008820, 2113009678, 2113008469, 2113008813, 2113008857, 2113008815, 2113008818, 2113008819, 2113016439, 2113016438, 2113035095, 2113009200, 2113009486, 2113009201, 2113009126, 2113008830, 2113008822, 2113008824, 2113008826, 2113008828, 2113008949, 2113008192, 2113009292, 2113013353, 2113008881, 2113008884, 2113008765, 2113008834, 2113008168, 2113008837, 2113016419, 2113016418, 2113032277, 2113011900, 2113011909, 2113018360, 2113011907, 2113011908, 2113011901, 2113011912, 2113011902, 2113011910, 2113013836, 2113011911, 2113011905, 2113033969, 2113011906, 2113011903, 2113016428, 2113034147, 2113034138, 2113018359, 2113004466, 2113016354, 2113016353, 2113016355, 2113004602, 2113004526, 2113004603, 2113004600, 2113004601, 2113004610, 2113004896, 2113035053, 2113034607, 2113004263, 2113034608, 2113016358, 2113016357, 2113004550, 2113004518, 2113004837, 2113004519, 2113004517, 2113004836, 2113004515, 2113004598, 2113004726, 2113004947, 2113004948, 2113004868, 2113004945, 2113004261, 2113004780, 2113004267, 2113004419, 2113004614, 2113004729, 2113004251, 2113004933, 2113004259, 2113004822, 2113004866, 2113004867, 2113004944, 2113004865, 2113004942, 2113004871, 2113004872, 2113004275, 2113016359, 2113004870, 2113004752, 2113004833, 2113004877, 2113004754, 2113004831, 2113004952, 2113004830, 2113033012, 2113004761, 2113004317, 2113004305, 2113004888, 2113004889, 2113004884, 2113004764, 2113004885, 2113004262, 2113004481, 2113033011, 2113004753, 2113004762, 2113009499, 2113013691, 2113019919, 2113009684, 2113014845, 2113009951, 2113020785, 2113032338, 2113029519, 40320028801, 2113035283, 2113029515, 2113046196, 2113046191, 2113046317, 2113046190, 2113046158, 2113046157, 2113046188, 2113046186, 2113046185, 2113046184, 2113046250, 2113046183, 2113046664, 2113014142, 2113016730, 2113046666, 2113046665, 2113047302, 2113047300, 2113047309, 2113045265, 2113024245, 2113045536, 2113045316, 2113045733, 2113045457, 2113045732, 2113045456, 2113045256, 2113045279, 2113045453, 2113045452, 2113045319, 2113045317, 2113045538, 2113045318, 2113045142, 2113033783, 2113033784, 2113033785, 2113045448, 2113045247, 2113045269, 2113045468, 2113045267, 2113045147, 2113045246, 2113045268, 2113045266, 2113045091, 2113012878, 2113014117, 2113045153, 2113045296, 2113045451, 2113045154, 2113045151, 2113045295, 2113045270, 2113045095, 2113045150, 2113045092, 2113026271, 2113026274, 2113026286, 2113034695, 2113017510, 2113032547, 2113034697, 2113007938, 2113007940, 2113004380, 2113007410, 2113045525, 2113017610, 2113019146, 2113007525, 2113007579, 2113007413, 2113007501, 2113007444, 2113007598, 2113007498, 2113007575, 2113017609, 2113007485, 2113007595, 2113032287, 2113009202, 2113009208, 2113009268, 2113009260, 2113016443, 2113019497, 2113009210, 2113009213, 2113020673, 2113009226, 2113009216, 2113009206, 2113009207, 2113009229, 2113034703, 2113009209, 2113009407, 2113034506, 2113034704, 2113034507, 2113019415, 2113019416, 2113000815, 2113047756, 2113000853, 2113048086, 2113048088, 2113048012, 2113048022, 2113048014, 2113048013, 2113048018, 2113048082, 2113048083, 2113047737, 2113033796, 2113015828, 2113033035, 2113015960, 2113034815, 2113033034, 2113015961, 2113004770, 2113004398, 2113004718, 2113004949, 2113004719, 2113034781, 2113004946, 2113004778, 2113004779, 2113004402, 2113004776, 2113004741, 2113004950, 2113004335, 2113004399, 2113004396, 2113004880, 2113004397, 2113004881, 2113014869, 2113034782, 2113034783, 2113009358, 2113033999))
group by 1,2;


--redeemed superbowl
create or replace temporary table redeemed_sb_in_observation_hh as
select household_id,
1 as sb_redeemed,
count(household_id) as sb_redemptions,
count(case when (upper(OFFER_TYPE) = 'PD') then household_id else null end) as sb_pd_redemptions,
count(case when (upper(OFFER_TYPE) = 'SC') then household_id else null end) as sb_sc_redemptions,
count(case when (upper(OFFER_TYPE) = 'MF') then household_id else null end) as sb_mf_redemptions,
count(case when (upper(OFFER_TYPE) = 'GR') then household_id else null end) as sb_gr_redemptions
--from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_REDEMPTIONS
from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.c360_online_redeeming_hhs
where txn_dte between min_obs_date and max_obs_date and household_id is not null
and (CAST(trim(CAST(CAST(length(CLIENT_OFFER_ID) as BIGNUMERIC) as STRING)) as BIGNUMERIC) > NUMERIC '1') 
AND (trim(CLIENT_OFFER_ID) NOT LIKE '%-ND')
and client_offer_id in (
select distinct offer.client_offer_id from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_offer_upcs upc 
left join gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.c360_offer offer on upc.oms_offer_id = offer.oms_offer_id
where cast(upc.upc_id as numeric) in (7114242378, 7114281777, 7114200948, 7572000854, 7572030020, 7572073411, 8265741157, 8265772323, 8265754221, 2259200811, 2259206669, 2259263777, 8304600817, 8304613480, 8304691164, 88939200031, 88939201017, 88939200028, 88939201019, 85248100715, 88939200090, 88939200091, 88939200170, 88939200172, 88939202131, 88939200075, 88939200130, 88939200174, 88939200032, 88939200132, 88939200154, 88939200176, 88939201002, 88939201001, 88939200134, 88939200156, 88939200178, 88939200059, 88939202139, 88939200139, 85248100712, 85248100711, 85248100710, 88939202141, 88939200086, 88939200362, 88939200120, 88939202143, 88939202145, 88939201014, 81829001279, 81829001280, 81829001193, 81829001281, 81829001282, 81829001381, 81829001851, 81829001833, 81829001834, 81829001937, 81829001850, 81829001832, 81829001283, 81829001382, 81829001284, 81829001285, 81829001275, 81829001672, 81829001277, 81829001854, 81829001944, 81829001626, 85977400784, 85977400727, 85977400772, 86998200005, 86998200001, 86998200000, 85977400742, 85977400783, 78616200151, 78616241107, 78616200612, 78616200610, 78616200622, 78616241121, 78616241076, 78616241059, 78616241068, 78616200608, 78616241069, 78616201000, 78616200530, 78616200298, 78616200485, 78616200498, 78616200531, 78616200379, 78616241074, 78616200425, 78616241083, 78616204000, 78616241188, 78616241186, 78616241136, 78616207000, 78616200297, 78616241134, 78616200296, 78616200373, 78616208000, 78616215000, 78616211000, 4900007935, 4900007940, 4900055573, 4900055572, 4900007933, 4900055571, 4900007934, 4900007931, 4900007942, 4900007932, 4900007937, 4900007938, 4900055417, 4900007936, 4900007939, 4900055444, 85817600206, 85000994257, 85000994233, 85817600248, 85817600205, 85817600227, 85817600217, 85000994259, 81011383022, 81011383134, 85817600250, 81011383136, 85817600211, 85817600277, 85817600213, 81011383140, 85817600295, 85000994231, 85817600252, 85817600296, 81011383021, 81011383020, 81011383130, 62830814009, 62830814011, 62830814010, 62830814031, 62825084280, 62825084276, 62825084278, 7342011614, 7342001614, 2529300149, 2529300099, 2529300098, 2529300136, 2529300119, 2529360217, 3663208014, 3663208078, 3663207267, 3663207268, 3663207735, 4127102564, 3663207974, 3663207810, 3663208006, 4127100955, 4127101788, 4127101997, 4127102502, 4127102568, 4127100970, 4127101993, 4127102258, 4127102256, 3663208092, 4127100472, 4127102253, 3663208091, 4127102260, 3663207809, 4127100908, 7457000400, 7457046203, 7457091010, 7457065140, 7457095015, 7457044400, 7457002400, 7457052400, 7457008406, 7457098025, 7457061739, 7457004408, 7457009400, 7457060686, 7457092849, 7457073192, 7457003400, 7457067459, 7457057918, 7457061532, 7457065057, 7457065058, 7457048338, 7457065030, 7457065176, 7457095003, 7457043400, 7457020864, 7457025117, 7457097608, 7457001400, 7457036092, 7457048418, 7457053400, 7457008400, 7457008005, 7457061007, 7457081011, 7457087659, 7457031995, 7457004400, 7457030544, 7457011400, 7457027400, 7255400154, 7255487026, 7255411146, 7255411057, 7255438745, 7255485201, 7255400153, 5000069659, 7255411119, 7255427399, 7255481457, 7255494573, 7255472183, 4154861004, 4154879245, 4154875095, 4154875150, 4154861404, 4154800004, 4154861604, 4154800005, 4154800007, 4154831260, 4154851718, 4154824404, 4154861204, 4154875092, 4154841362, 7457003310, 7457091935, 7457022403, 7457042854, 7457001310, 7457002310, 7457065562, 7255400004, 7255400003, 7255400005, 7255400002, 2780006763, 2780006558, 2780006469, 2780006557, 2780007657, 2780006644, 2780007810, 3010003319, 2780006467, 2780006555, 2780006643, 2780006477, 3010050561, 2780006476, 2780006586, 2780005860, 2780006794, 2780006970, 2780006571, 2780006394, 2780006570, 2780006580, 3010010026, 2780006480, 7225002108, 7225008396, 7225002109, 7225001137, 7225001138, 7225000685, 7225008420, 2840073740, 2840076296, 2840030850, 2840073580, 2840076014, 2840015458, 2840076017, 2840073742, 2840073745, 2840031501, 2840070504, 2840067973, 2840015463, 2840067971, 2840068427, 2840067977, 2840069836, 2840025492, 2840075056, 2840073314, 2840015443, 2840051549, 2840073756, 2840015446, 2840072955, 2840073759, 2840067960, 2840067969, 2840022772, 2840063763, 2840068537, 2840068856, 81060702497, 2840076238, 2840076239, 2840072749, 2840067950, 2840020546, 2840069335, 2840076000, 2840051288, 2840073894, 2840075995, 2840076644, 2840076009, 2840069291, 2840069405, 2840069603, 2840070553, 2840067947, 2840068119, 2840067945, 2840031041, 2840051779, 2840037649, 2840075088, 2840007230, 2840073228, 2840073701, 2840022988, 2840011262, 2840037650, 2840075092, 2840075095, 2840037619, 2840037618, 2840051783, 2840051782, 2840051781, 2840048277, 2840051780, 2840074003, 2840073994, 2840076105, 2840076548, 2840051784, 2840076305, 2840073997, 2840069347, 2840052838, 2840069346, 2840031040, 81060702508, 2840031046, 2840031044, 2840031283, 2840053274, 2840031407, 2840051776, 2840068690, 2840051775, 2840051774, 2840073720, 2840031406, 2840051773, 2840031403, 2840070648, 2840017335, 2840031404, 2840051778, 2840051777, 2840000617, 2840037790, 2840031409, 2840031050, 2840048278, 2840065979, 2840003400, 2840008314, 2840031058, 81060702443, 2840059888, 2840031054, 2840031055, 81060702445, 2840076607, 2840031413, 2840068751, 1600012479, 1600022195, 1600022233, 1600027532, 1600023117, 1600022205, 1600020104, 1600022235, 1600021658, 1600015163, 1600027515, 1600027526, 1600012254, 1600012222, 1600012025, 1600012399, 1600015128, 1600012544, 1600012542, 1600019707, 1600021191, 1800000401, 1800000501, 1800000211, 1800000415, 1800000526, 1800000757, 1800000512, 1800000420, 1800000058, 1800000210, 1800000075, 1800000142, 1800000186, 1800000183, 1800000260, 1800000182, 1800000918, 1800000318, 4280010953, 4280010915, 4280010924, 4280010921, 4280010954, 4280013828, 4280010952, 1600026460, 1600020094, 1600020093, 1600022098, 1600046684, 1600018793, 1600027706, 1600018794, 1600018892, 1600027707, 1600041727, 1600041126, 1600043980, 1600028920, 1600027855, 1600022101, 1600023121, 1600023119, 1600021211, 1600022242, 1600022243, 1600046679, 1600014481, 1600046757, 1600046758, 1600017944, 1600041314, 1600045898, 1600045798, 1600045897, 1600016893, 1600040761, 1600026470, 1600028372, 1600014732, 1600049298, 1600027700, 1600022693, 1600020088, 1600018145, 1600022931, 1600019430, 1600042419, 1600022782, 1600018573, 1600022228, 1600018910, 1600035540, 1600016212, 1600018575, 1600039700, 1600022093, 1600014711, 1600014733, 4119613975, 4119613974, 4119613978, 4119613976, 4119613977, 1583909719, 1583909721, 1583909720, 1583909671, 7835557010, 7835557000, 7835558000, 7835560035, 7835557025, 7835555000, 7835557005, 7835560018, 82951532226, 82951532580, 82951532616, 82951532653, 82951532577, 82951532645, 85186100609, 81118403028, 85186100607, 85186100606, 85186100616, 81118403144, 81118403125, 81118403025, 81118403020, 85186100612, 85186100611, 85186100666, 81118403000, 85186100610, 81118403186, 85186100686, 85186100671, 7261373945, 2420009456, 7261347410, 7261347420, 7261347415, 2420005448, 7261347418, 2420005347, 7261347417, 2420005386, 2420005482, 2420005362, 2420009420, 2420005467, 2420005464, 7261373916, 7261373978, 7261373947, 2420004490, 3760013872, 3760028428, 3760014173, 3760031639, 3760043470, 3760017534, 3760033658, 3760015121, 3760011544, 3760035930, 3760016900, 3760022121, 3760064205, 3760021758, 3760021750, 3760036215, 3760021753, 3760021756, 3760021760, 3760013260, 3760005849, 3760026524, 3760043561, 3760013282, 3760013264, 3760088385, 3760013283, 3760088384, 3760026030, 3760059320, 3760088388, 3760073580, 3760025836, 3760049767, 3760039051, 3760073620, 3760035629, 3760018237, 3760037939, 3760027468, 3760047371, 7287829078, 3760025756, 7287829079, 3760015491, 7287829080, 3760048713, 4410015618, 4410015619, 4410015620, 4410019081, 4410019092, 4410015621, 4410019080, 4410019093, 4157005617, 4157005621, 4157009915, 4157005670, 4157014999, 4157005618, 4157010993, 4157005625, 4157010964, 4410019074, 4410019095, 4410016502, 4410019094, 4410019076, 4410019075, 7357013000, 7357013006, 7357013007, 7357056575, 7357013033, 7357013003, 5150004815, 5150000630, 5150004816, 5150004962, 5150021179, 5150082556, 2550030407, 2550030439, 2550030442, 2550030443, 2550030440, 2550030441, 2550030411, 2550030444, 2550030445, 88810911010, 88810911180, 88810911060, 88810911061, 88810911385, 88810911423, 88810911224, 88810925261, 88810911503, 88810925022, 88810925584, 88810925661, 88810925266, 88810925614, 88810925458, 88810925937, 88810925934, 88810925616, 88810925858, 88810925935, 88810925939, 88810911497, 88810911016, 88810911058, 88810911059, 88810911411, 88810925450, 25136200000, 88810925454, 88810925850, 88810925688, 88810925524, 88810911084, 88810911001, 88810911485, 88810911401, 88810911006, 88810911402, 88810911004, 88810911009, 88810911007, 88810911525, 88810925488, 88810925437, 88810925559, 88810925999, 88810925556, 88810926008, 88810925439, 88810925516, 88810911078, 88810911155, 88810911079, 88810911198, 88810925032, 88810925472, 88810925475, 88810911403, 88810925994, 88810911535, 88810911459, 88810925514, 88810925901, 88810911121, 88810911131, 88810911138, 88810911244, 88810911428, 88810911064, 88810911312, 88810925744, 88810911090, 88810915003, 88810915004, 88810911188, 88810911065, 88810911088, 88810911154, 88810915002, 88810925465, 3997800844, 3997802596, 3997803420, 7430500132, 86000046850, 86000046853, 85004792019, 4364620128, 4364620400, 4364610482, 4364646101, 4364620758, 2410010685, 2410000017, 2410044077, 2410051445, 2410078925, 2410011098, 2410078887, 2410059473, 2410000019, 2410059475, 2410012137, 2410010633, 2410011660, 2410011487, 2410078909, 2410012418, 2410078938, 2410012090, 2410078914, 2410011062, 2410059441, 2410078895, 2410011060, 2410012292, 2410012424, 2410012435, 2410010443, 2410012129, 2410012404, 2410010445, 2410049384, 2410010608, 3010010057, 3010010055, 3010010068, 3010010309, 3010012460, 3010078458, 3010010614, 3010011176, 3010012902, 3010010070, 3010012977, 2410011441, 3800013841, 3800013927, 3800029312, 3800028445, 3800018060, 3800028447, 3800029835, 3800030500, 3800030263, 3800024939, 3800013881, 3800013860, 3800030190, 3800024556, 3800013863, 3800013843, 3800013887, 3800024553, 3800029741, 3800029322, 3800030498, 3800030496, 3800028017, 3800029888, 3800028458, 3800028019, 3800018371, 3800027647, 3800024349, 3800013872, 3800013897, 3800016527, 3800021791, 3800013857, 3800028021, 3800029310, 3800029376, 3800028023, 8768400107, 8768400094, 8768401063, 8768400287, 8768400113, 8768400112, 4300008403, 8768400100, 8768400099, 8768400110, 4300008401, 8768400097, 8768400095, 8768400106, 8768400115, 8768400114, 2100065883, 2100002809, 7766100316, 7766100313, 7766100412, 7766101513, 7766104813, 7766111909, 7766100112, 7766102913, 7766116185, 7766101413, 7766100813, 7766111792, 7766111593, 7766116628, 7766113858, 7766111798, 7766104213, 7766100012, 89824800107, 89824800150, 84029070014, 89824800184, 89824800156, 89824800157, 89824800110, 89824800143, 89824800100, 89824800111, 84029070031, 84029070030, 89824800106, 89824800158, 89824800148, 4767739129, 4767748527, 4767739128, 4767748525, 4400006023, 4400006045, 4400007299, 4400007298, 4400006842, 4400007975, 4400007215, 4400007214, 4400001473, 4400007378, 4400008142, 4400006041, 4400007803, 4400007767, 4400005903, 4400005869, 4400006518, 4400007805, 4400007465, 4400006017, 4400006699, 4400007227, 4400006016, 4400006697, 4400007742, 4400008151, 4400008152, 4400008070, 4400007183, 4400008108, 4400007739, 4400006024, 4400007550, 4400006028, 4400007832, 4400006027, 4400007798, 4400006026, 4400007511, 4400007797, 4400008168, 4400006025, 4400006063, 4400007196, 4400007590, 4400006854, 4400007708, 4400007706, 4400007705, 4400006112, 4400007321, 4400007320, 4400005389, 4400006039, 4400007722, 4400006038, 4400007963, 4400006113, 4400007759, 4400007515, 4400007559, 4400003111, 4400007773, 4400008104, 4400007249, 4400005781, 4400005043, 4400005094, 4400005041, 4400005109, 4400005105, 4400005129, 4400005106, 4400005104, 4400007771, 4400007545, 4400007770, 4400007970, 4400003483, 4400008039, 4400008248, 4400003133, 4400008343, 4400003113, 4400008042, 4400008175, 4400002389, 4400003115, 4400003545, 4400003117, 4400003116, 4400003544, 4400005359, 4400003119, 4400007905, 4400005098, 4400005550, 4400008107, 4400008067, 4400008066, 4400008143, 4400003049, 4400003048, 4400007526, 4400007525, 4400005549, 4400004472, 4400005166, 4400004471, 4400005642, 4400006457, 4400008078, 4400005643, 4400005840, 4400006456, 4400005168, 4400005839, 4400004546, 4400006923, 4400006922, 4400004545, 4400006409, 4400006925, 4400006924, 4400005099, 4400005132, 4400005133, 4400005174, 4400007232, 4400008404, 4400005136, 4400004488, 4400005134, 4400005135, 4400005172, 4400000878, 4400005801, 4400006458, 4400007828, 4400007827, 4400005100, 4400007524, 4400003047, 4400005101, 4400005138, 4400004446, 4400003219, 4400003394, 4400006397, 4400003223, 4400004466, 4400007269, 4400002991, 4400003221, 4400008131, 4400006393, 4400002456, 4400003225, 4400006986, 4400004913, 4400004637, 81029100100, 81029100775, 81029100797, 81029100896, 81029100876, 81029100413, 81029100778, 81029100719, 81029100101, 81029100685, 81029100102, 81029100783, 81029100367, 81029100445, 81029100687, 81029100104, 81029100105, 81029100766, 81029100106, 81029100446, 81029100724, 81029100768, 81029100108, 81029100109, 81029100208, 81029100092, 81029100192, 81029100370, 81029100230, 81029100790, 81029100176, 81029100694, 81029100771, 81029100298, 81029100696, 81029100795, 81029100894, 81029100794, 4400007841, 4400007792, 4400007840, 4400008125, 4400008010, 4400008021, 4400008172, 4400007836, 4400007835, 4400007846, 4400007834, 4400007845, 4400007844, 4400007839, 4400007838, 81029100982, 4400007837, 4470002454, 4470010319, 4470010416, 4470010417, 4470007092, 4470010349, 4470010426, 4470010320, 4470010321, 4470010351, 4470002410, 4470036000, 4470010350, 4470036002, 4470036035, 4470002411, 4470002455, 4470036001, 4470002458, 75166677155, 75166616505, 75166648005, 75166695005, 75166677225, 75166610315, 75166610305, 75166641685, 75166610345, 75166641645, 76770700214, 76770700106, 76770700167, 76770701480, 76770701350, 76770700125, 76770700215, 3077213451, 3077208813, 3077204311, 3077204312, 3077209204, 3077206132, 3077208797, 3077213217, 3077201570, 3077204170, 3077208471, 3077208470, 3077215705, 3077216014, 3077216019, 3077205662, 3077216041, 3077205630, 3077206166, 3077215663, 3077215662, 3077216020, 3077216277, 3077219274, 1200000230, 7800001356, 1200010542, 7800001397, 1200003098, 7800003532, 7800003536, 1200000971, 1200000496, 1200024029, 1200000935, 4300099608, 1200017226, 1200020237, 7800020746, 7092500030, 7800009846, 7800001407, 1200000492, 7800008246, 7800003552, 7800001371, 7800001336, 1200016346, 1200017237, 7800002300, 7800000408, 7800021546, 7800003119, 7800001416, 1200000113, 1200000311, 1200000233, 1200001321, 1200000231, 1200001881, 1200022147, 1200000952, 1660051312, 4300095265, 7800020646, 1200003066, 1200006453, 7800020446, 1200006452, 1200024014, 4171011288, 1200000341, 7800039416, 7800008346, 1200000746, 1200017213, 1200017258, 1200017252, 1200017176, 1200014092, 7800001315, 7800003507, 1200014113, 1200017173, 1200014093, 1200014095, 7800008239, 1200014094, 1200020320, 7800002639, 7800003823, 5200013513, 5200004234, 5200004233, 5200004232, 5200004231, 5200004678, 5200004314, 5200005028, 5200010411, 5200010410, 5200013508, 5200004704, 5200004328, 5200004327, 5200010241, 5200013490, 5200004403, 5200005798, 5200004400, 5200013514, 5200013515, 5200005451, 5200013516, 5200005230, 5200013517, 5200013519, 5200001029, 5200013528, 5200005802, 5200010297, 81809400577, 81809400580, 81809400581, 81809400582, 81809400583, 81809400585, 81809400860, 81809400025, 81809400300, 81809400586, 81809400587, 81809400588, 1200022092, 81809400589, 81809400828, 81809400070, 81809400590, 81809400591, 81809400592, 81809400593, 81809400594, 81809400873, 1200023071, 81809400875, 81809400998, 1200022186, 81809400681, 81809400002, 81809400840, 1200023041, 81809400208, 1200023043, 81809400691, 81809400495, 81809400650, 81809400497, 81809400574, 81809400575, 81809400971, 81809400499, 81809400576, 81809400973, 1200024060, 81809400578, 81809400579, 81809400975, 1200023051, 1200024062, 81809400537, 81809400977, 1200023053, 81809400858, 1200023045, 1200023047, 1200023049, 5200000339, 5200001361, 5200000296, 5200005035, 5200004154, 5200000342, 5200000297, 5200000344, 5200000299, 5200000343, 5200005270, 5200004274, 5200070778, 5200070777, 5200070779, 5200001358, 5200000338, 5200004749, 5200005490, 1200028617, 1200020649, 9800010035, 1200020651, 1200004283, 1200028621, 1200028620, 1200021351, 1200018094, 1200028624, 1200028623, 1200028622, 1200004643, 1200028618, 1200004117, 1200021346, 1200004644, 1200018103, 1200021348, 9800010043, 1200018105, 1200028619, 7701361557, 7701361559, 7701361563, 7701361574, 7701361598, 7701361570, 7701361581, 7701361572, 7701301172, 7701301317, 7701301314, 7701301065, 7701301131, 7701301130, 75579517501, 75579537539, 75579537504, 75579537527, 75579537513, 75579537535, 75579537568, 75579537514, 75579537577, 75579537545, 75579537567, 75579537575, 75579537551, 75579537573, 75579537552, 75579537574, 75579537571, 75579537550, 75579517502, 75579570000, 75579570007, 75579570008, 75579570101, 75579570003, 75579570005, 75579570001, 75579570100, 81006371030, 81006371170, 81006371031, 81006371130, 81006371032, 81006371033, 81006371055, 70958651483, 81006371105, 81006371007, 81006371029, 81006371008, 81006371107, 70958651489, 70958651487, 70958651485, 81006371088, 81006371012, 81006371013, 81006371035, 72419081287, 81006371014, 81006371036, 81006371059, 81006371016, 81006371017, 81006371039, 3000031182, 3000031181, 3000031280, 3000031407, 3000031188, 3000031271, 3000031282, 3000031184, 3000031175, 3000031269, 3000031180, 3000006322, 3000057322, 3000057802, 3000057801, 3000057812, 3000057853, 3000056083, 3000006354, 3000057323, 3000057288, 3000057321, 3000066507, 3000057361, 3000057578, 3000057362, 1530044051, 1530043053, 1530044082, 42630004801, 1530043048, 1530044017, 1530043047, 1530043006, 1530043028, 1530044016, 1530043980, 1530044035, 1530044036, 1530043024, 1530044033, 1530044132, 1530043023, 1530043061, 1530044032, 1530043060, 26755, 1530001406, 1530001428, 26757, 1530043059, 42632009101, 1530044049, 1530044002, 1530044025, 1530043034, 1530043078, 61126981899, 61126900312, 61126900214, 61126917452, 61126932121, 61126918246, 61126900192, 61126920643, 61126900173, 61126900130, 61126900252, 61126900165, 61126900101, 61126900244, 61126928310, 61126900226, 61126900304, 61126900206, 61126911357, 61126971646, 61126962373, 61126933282, 61126921245, 61126900184, 61126900261, 61126900164, 61126900270, 61126900276, 4610000122, 4610000123, 4610000189, 4610000222, 4610000223, 4610002048, 4610000121, 4610000165, 4610000221, 4610002046, 4610000226, 4610000106, 4610000125, 4610000224, 4610000268, 4610000107, 4610035788, 4610035786, 4610041107, 4610041106, 4610040059, 4610020303, 4610040076, 4610040096, 4610040051, 4610000692, 4610040012, 4610000272, 4610000233, 4610000113, 4610000110, 4610000694, 4610000114, 4610040092, 4610040029, 4610080085, 4610000163, 4610000164, 4610040002, 4610020295, 4610040066, 4610035403, 4610000941, 4610000942, 4610035627, 4610000940, 4610001115, 4610000967, 4610035339, 4610000968, 4610035338, 4610000943, 4610001912, 4610035632, 4610035631, 4610035341, 85006583502, 85006583508, 85006583504, 85006583512, 85006583500, 85006583510, 85006583514, 85006583532, 1657191030, 1657194035, 1657194037, 1657194038, 1657195087, 1657194033, 1657194034, 1657195084, 1657195085, 1657195086, 1657191126, 1657195924, 1657195926, 1657191125, 1657194039, 1657195920, 1657195889, 1657195922, 1657124611, 1657191031, 1657195477, 1657124614, 1657195352, 1657195396, 1657191032, 1657195030, 1657195790, 1657124574, 1657124573, 1657124576, 1657124575, 1657191037, 1657195436, 1657195437, 1657195267, 1657195268, 1657195424, 1657195780, 1657195781, 1657195029, 1657195696, 1657195334, 1657194042, 1657196023, 1657195210, 1657195211, 1657194040, 1657195535, 1657195810, 1657195338, 1657195812, 1657195966, 1657195968, 1657195970, 1657196055, 1657196059, 1657196061, 3022304156, 3022302433, 3022302432, 3022304218, 3022306138, 3022304114, 3022302434, 3022304230, 82486200631, 3022304150, 82486200630, 3022304074, 3022304151, 3022306099, 3022306110, 3022304152, 82486200632, 3022306161, 3022304206, 3022301198, 3022304109, 3022304048, 3022306126, 3022304225, 3022306008, 3022304186, 3022306200, 3022304189, 3022304064, 3022304185, 7283008114, 7283008141, 7283008140, 7283008101, 7283008123, 7283008122, 7283008144, 7283008121, 7283008143, 7283008105, 7283008127, 7283008104, 7283008126, 7283008103, 7283008125, 7283008109, 7283008108, 7283008107, 7283008129, 7283008106, 7283008112, 7283008111, 7283008110, 7283008132, 7283008116, 7283008138, 7283008115, 7283008137, 7283008136, 7283008113, 7283008119, 7283008118, 7283008139, 2370005588, 2370005585, 4800121348, 4800120436, 4800121358, 4800120437, 4800121351, 4800121350, 4800121372, 4800101663, 4800101662, 4800135450, 4800135428, 4800135385, 4800135384, 4800135449, 4800102599, 4800110896, 4800135386, 7585600110, 7585600170, 7585613901, 7585602415, 7585603114, 7585601113, 7585600089, 7585601120, 7585600084, 7756700154, 7756700158, 7756700157, 7756700388, 7756700156, 7756700365, 7756700121, 7756700363, 7756700384, 7756708516, 7756727442, 7756700381, 7222022032, 7222022041, 7222021997, 7222021996, 7222021994, 7222021990, 7222022034, 1411373406, 1411391084, 1411391061, 1411391063, 1411391085, 1411370194, 1411370238, 1411370035, 1411370156, 1411370036, 1411370104, 85002101543, 85005175526, 85002101526, 85002101562, 85002101544, 85002101532, 85002101565, 5000024731, 5000037753, 5000045530, 5000045676, 5000048025, 5000061599, 5000061944, 5000064869, 5000066617, 5000068446, 5000069669, 5000070500, 5000074875, 5000083281, 5000087685, 76211197222, 5000094788, 5000094919, 76211100099, 76211100109, 76211100139, 76211188810, 76211188811, 76211188812, 76211194958, 76211194960, 76211188813, 76211188818, 76211189531, 76211192557, 76211193025, 76211140508, 76211144221, 76211108024, 76211109333, 76211110555, 76211116504, 76211142732, 76211169195, 76211143432, 76211116506, 76211116543, 76211123603, 76211130100, 76211130528, 76211114275, 76211101439, 76211120602, 76211120603, 76211120604, 76211120605, 76211120609, 76211120611, 76211120612, 76211120613, 76211120624, 76211120625, 76211123334, 76211134374, 76211140598, 76211143514, 76211145398, 76211148306, 76211148308, 76211151103, 76211152983, 76211155935, 76211157059, 76211157170, 76211162281, 76211162285, 76211162286, 76211162287, 76211162289, 76211162290, 76211162291, 76211179575, 76211181056, 76211181059, 76211185714, 76211188554, 76211193428, 76211193446, 76211193448, 76211193598, 76211194980, 76211198040, 76211199617, 76211199618, 76211138012, 76211138013, 76211138015, 76211147021, 76211156158, 980000055, 980051204, 82926200034, 82926200033, 82926200143, 82926200035, 82926200069, 82926200218, 82926200452, 82926200453, 82926200454, 82926200469, 82926200468, 81012597069, 81012597070, 86373700016, 85174100833, 84026632458, 84026630000, 88939200116, 88939200128, 88939208076, 88939208061, 88939208862, 88939208005, 64384371448, 64384380086, 64384371466, 64384380073, 64384380095, 64384371451, 64384371504, 64384371658, 64384371655, 64384371610, 64384371502, 64384371667, 64384371588, 64384371590, 7007466897, 7007468167, 7007466891, 7007467166, 7007468461, 7007468170, 7007440711, 7007440705, 7007453807, 7007451785, 7007440701, 4167967566, 4167967466, 4167967666, 74982600016, 74982600008, 74982600019, 74982600010, 81771902240, 81771902175, 81771902165, 81771902248, 81771902171, 78656015312, 82926200181, 82926200183, 82926200184, 82926200182, 82926200023, 82926200095, 82926200096, 82926200020, 82926200031, 82926200010, 82926200021, 82926200170, 82926200094, 82926200004, 82926200007, 82926200022, 82926200001, 82926200002, 82926200003, 82926200157, 82926200008, 82926200009, 82926200331, 82926200386, 85777700423, 85777700418, 85777700419, 85777700468, 85777700420, 19390800517, 85777700474, 78769283961, 78769283964, 72225206876, 72225206869, 72225206877, 72225206879, 72225206878, 72225206880, 72225206882, 72225206881, 81000647272, 81000647270, 81000647984, 81000647278, 81000647280, 1204405897, 1204406060, 1204406064, 1204405892, 1204406309, 1204406320, 1204403753, 1204403752, 1204403861, 1204401113, 1204403963, 1204405654, 1204403969, 1204403869, 3700073388, 3700073413, 3700094479, 3700098325, 3700094480, 1204404494, 1204403750, 1204404609, 1204404610, 1204404611, 1204404612, 1204404613, 1204404614, 1204404816, 1204404817, 1204404989, 1204405381, 1204405657, 1204405661, 1204405666, 1204405667, 1204405670, 1204405671, 1204405678, 1204405737, 1204438970, 12044045145, 12044056769, 1204401560, 1204402036, 1204402180, 1204402335, 1204402983, 1204402999, 1204403000, 1204403006, 1204403756, 1204403759, 1204403962, 1204404089, 1204404108, 1204404407, 1204404511, 7940026654, 7940044834, 7940035299, 7940038641, 7940035293, 7940035297, 7940035120, 7940059301, 7940063101, 7940069144, 7940006671, 7940031153, 7940059303, 7940031152, 7940006672, 7940044603, 7940034218, 7940057629, 7940034242, 7940059146, 7940034219, 7940051183, 7940051182, 7940060068, 7940044778, 7940063428, 7940046946, 7940069179, 7940045814, 7940044786, 7940051753, 7940051776, 7940051755, 7940051978, 7940052806, 7940007217, 7940007216, 7940044821, 7940051995, 7940026655, 7940051996, 7940045025, 7940051999, 7940031247, 7940051997, 7940026540, 7940026570, 7940044870, 7940020570, 7940021628, 7940066914, 7940006147, 7940031260, 7940001343, 7940001743, 7940025190, 7940058719, 7940026560, 7940058708, 7940011802, 7940031175, 7940027532, 7940031268, 7940046170, 1111157598, 1111124093, 1111126285, 1111100793, 7940055020, 7940055110, 7940016118, 7940058983, 7940046106, 7940006125, 7940007365, 7940046105, 7940046969, 7940046978, 7940026102, 7940053430, 7940019720, 7940055300, 7940058987, 7940026094, 7940026093, 7940037997, 85003036052, 85003036030, 85004205829, 85003036042, 85005667118, 85005667119, 85005667120, 85005667168, 81215403001, 81215403081, 81215403508, 81215403838, 81215403008, 81215403018, 81215403117, 81215403005, 3077218337, 81215403003, 81215403144, 3077218340, 81215403172, 81215403293, 38371100250, 38371100249, 38371100246, 38371100247, 7940005248, 7940044659, 7940020239, 7940051328, 2279691670, 2279691006, 2279691611, 2279691005, 2279690090, 2279691612, 2279690092, 5280068184, 5280068187, 2279691671, 2279691015, 2279691014, 7940086660, 7940050730, 7940050740, 4589308053, 7940064948, 7940064949, 4589303305, 7940086670, 2240001176, 2240000521, 2240001408, 2240001407, 2240064045, 2240064261, 2240064316, 2240001392, 2240064336, 2240001173, 2240001393, 2240039368, 2240039366, 2240039365, 2240001177, 2240001394, 2240039363, 2240039362, 2240039361, 2240026512, 2240000522, 2240000800, 2240000205, 2240000986, 2240026518, 2240062374, 2240062392, 2240039379, 2240062366, 2240001181, 2240039377, 2240001143, 2240001264, 2240039375, 2240001362, 2240039373, 2240001147, 2240039372, 2240001145, 2240001266, 2240001146, 2240001267, 7940018181, 7940046666, 7940006664, 4589306359, 7940085860, 7940081670, 7940006296, 7940006663, 7940006661, 7940006662, 7940018182, 7940045031, 7940018183, 7940045030, 7940019375, 7940019373, 7940045953, 7940045948, 7940012196, 7940049593, 7940049597, 7940049592, 7940049596, 7940049594, 7940049599, 38371100049, 7940046535, 7940049797, 38371100048, 7940049272, 7940049269, 7940052235, 81215403327, 81215403849, 81215403328, 81215403658, 81215403657, 81215403535, 81215403325, 81215403534, 81215403324, 81215403533, 81215403323, 81215403322, 81215403531, 81215403762, 81215403850, 81215403761, 81215403661, 81215403660, 3077206325, 3077206328, 3077206329, 3077206324, 3077206301, 3077206299, 30772062999, 30772063019, 30772063248, 30772063255, 30772063286, 30772063293, 84031740079, 1204404622, 1204404624, 1204404604, 1204404593, 1204404771, 1204404597, 1204404773, 1700002404, 1700002411, 1111161011, 1111101073, 1111161164, 1111102717, 1111104066, 1111161015, 1111161334, 1111161117, 1111104898, 1111121648, 1111107626, 85523500748, 81000647159, 81000647801, 85523500751, 81793901861, 81793901860, 84353610788, 84353611137, 84353610024, 81793901858, 84353610482, 81793901859, 81793901856, 81793901944, 81793901857, 81793901945, 81793901855, 81215403329, 81215403504, 81215403334, 81215403344, 81215403685, 81215403332, 81215403330, 1204405139, 3700085205, 1204405084, 1204405082, 1204405086, 1204405097, 1204405136, 1204405089, 7940032362, 7940032371, 7940049667, 7940032363, 7940049784, 7940049780, 7940032369, 1111112425, 1111163154, 1111112331, 1111104908, 1111101722, 1111104008, 1111102583, 1111101040, 1111103344, 1111107973, 1111112518, 1111152720, 1111107470, 1111111522, 1111112224, 1111126270, 1111101412, 1111165323, 1111101413, 1111101414, 1700035085, 1700035079, 1700004728, 1700015083, 1700098870, 4589307224, 4589307227, 7214002747, 7214003606, 7214003517, 7214003205, 7214003520, 7214002717, 7214002739, 7965604971, 7965604496, 7965604972, 7965614296, 7965602451, 7965613321, 7965613323, 7965614297, 7965600025, 7965604663, 7965601332, 7965603165, 7965603178, 7965603179, 7965604968, 7965605080, 7965605140, 7965605141, 7965613089, 7965613153, 7965613160, 7965614029, 7965614293, 7965601806, 7965602560, 7965605082, 7965614030, 7548608989, 7548609112, 7548608965, 7548609192, 7548613763, 7548614034, 7548614035, 7548614292, 7548614294, 7548614295, 7548608747, 7548608742, 7548608743, 7548609191, 7548614311, 7548608987, 7548609114, 7548609117, 8680068790, 8680010039, 8680010038, 8680068785, 8680087025, 8680087270, 8680011282, 8680010357, 8680011082, 8680068770, 8680010043, 8680011158, 8680011151, 8680011254, 8680011253, 8680006650, 8680087274, 8680019456, 8680019370, 8680006645, 8680087272, 8680010032, 81134602003, 81134602001, 81134602007, 81134602009, 84105800564, 84105800338, 84105800549, 84105801990, 84105800562, 84105802345, 84105802209, 7033074663, 7033074915, 7033074784, 7033074938, 7033071417, 7033072259, 7033074181, 7033074327, 7033071987, 7033073231, 84105800520, 84105800526, 84105800528, 84105800529, 84105801196, 84105800365, 84105802009, 84105804802, 85424200604, 85538000428, 81007508012, 81007508016, 85462000805, 81000647929, 81007508170, 85538000487, 85462000801, 85462000803, 85523500799, 85424200608, 4740011579, 4740067214, 4740067215, 4740012598, 4740065867, 4740011566, 4740012602, 4740004474, 4740004472, 4740068036, 4740064990, 4740031391, 4740031535, 4740030071, 4740031389, 4740030106, 4740031392, 7830009922, 7830009923, 7830014110, 7830008136, 7830014108, 7830013518, 7830014109, 7830014038, 7830014022, 7830014044, 7830014042, 7830014043, 7830014027, 3700093755, 3700081684, 3700086648, 3700088761, 3700088757, 3700088736, 3700088707, 3700081022, 3700056218, 3700073804, 3700088727, 3700088730, 3700072810, 7301071441, 7301071447, 7301071830, 7301071135, 7301000922, 7301071124, 7301071631, 7301071633, 7301071338, 7301071450, 7301000455, 7301071453, 7301000915, 7301000370, 7301001217, 7301001531, 7301001347, 7301071133, 7301063111, 7301071513, 7301071297, 3077200441, 3077203236, 7301071302, 7301071629, 7301071630, 7301071829, 7301071831, 3700076566, 3700081756, 3077203242, 3700025540, 3700097949, 3700081690, 7007458050, 7007458059, 7007458056, 7007458053, 7007466920, 81957301066, 85269700128, 85269700127, 81957301027, 81957301566, 81957301699, 85269700129, 81957301553, 81957301700, 81957301173, 81957301592, 81957301171, 81957301172, 81957301590, 81957301067, 81957301232, 81957301552, 81957301231, 81957301170, 2392320196, 2392320459, 2392333498, 82951532364, 2392323624, 2392323603, 2392323627, 2392323628, 2392353295, 2392353297, 2392333012, 2392333013, 2392333011, 1500007437, 1500004414, 1500007439, 1500007458, 1500081018, 1500004411, 1500004466, 1500007433, 1500007444, 1500007438, 1500004405, 1500004417, 1500093410, 1500093416, 1500093417, 1500007492, 1500081012, 1500007430, 1500081015, 1500020574, 1500020576, 2800081209, 2800093487, 3600031890, 3600048756, 3600050467, 3600055530, 1920077182, 1920089346, 1920089347, 1920081700, 1920097181, 1920085058, 1920081145, 1920081143, 1920099802, 1920089289, 1920098772, 1920075352, 1920099650, 1920002522, 1920076878, 1920098391, 1920080088, 1920085020, 1920002699, 1920000888, 1920099653, 1920002569, 1920078915, 1920082515, 1920082516, 1920082513, 4142004854, 7920006068, 4142001623, 4142008472, 4142008084, 4142001625, 4142008085, 4142008023, 7920005523, 4142008090, 4142008092, 7920008227, 3746601584, 954244133, 954244298, 3746601855, 3746601585, 954203446, 3746601400, 954200906, 954203189, 954245414, 954200419, 7046203596, 7046200905, 7046203598, 7046201372, 7046201371, 7046203600, 7046200920, 7046243351, 7046201090, 7046200522, 5770001727, 2089124709, 3077213354, 3077213353, 3700074968, 3700074969, 3700074971, 3700082881, 3700079466, 3700082879, 3700082876, 3700074962, 3700077583, 3700077584, 3700077599, 3700059643, 3700059644, 3700059605, 3077218866, 3700059606, 3700059627, 3077218865, 3700086225, 3700086226, 3700086224, 3700086223, 3700071507, 3700071512, 3700071543, 3700071486, 3077213355, 3077213352, 3700071483, 3700076469, 3700076470, 3700072406, 3700072407, 3700076466, 3700076510, 3700076468, 3700076416, 3077210431, 3700094174, 3700075416, 2113034614, 2113034615, 7989311055, 7989316144, 7989316179, 7989316178, 7989316180, 7989340589, 7989316181, 7989312499, 7989312498, 7989311116, 7989311115, 7989311118, 7989311117, 2113008800, 2113008490, 2113009261, 2113009262, 2113008970, 2113008853, 2113008810, 2113008767, 2113008801, 2113008802, 2113008803, 2113008808, 2113008809, 2113013356, 2113013355, 2113016442, 2113016440, 2113009671, 2113024246, 2113024247, 2113008860, 2113009675, 2113008862, 2113009676, 2113009677, 2113008820, 2113009678, 2113008469, 2113008813, 2113008857, 2113008815, 2113008818, 2113008819, 2113016439, 2113016438, 2113035095, 2113009200, 2113009486, 2113009201, 2113009126, 2113008830, 2113008822, 2113008824, 2113008826, 2113008828, 2113008949, 2113008192, 2113009292, 2113013353, 2113008881, 2113008884, 2113008765, 2113008834, 2113008168, 2113008837, 2113016419, 2113016418, 2113032277, 2113011900, 2113011909, 2113018360, 2113011907, 2113011908, 2113011901, 2113011912, 2113011902, 2113011910, 2113013836, 2113011911, 2113011905, 2113033969, 2113011906, 2113011903, 2113016428, 2113034147, 2113034138, 2113018359, 2113004466, 2113016354, 2113016353, 2113016355, 2113004602, 2113004526, 2113004603, 2113004600, 2113004601, 2113004610, 2113004896, 2113035053, 2113034607, 2113004263, 2113034608, 2113016358, 2113016357, 2113004550, 2113004518, 2113004837, 2113004519, 2113004517, 2113004836, 2113004515, 2113004598, 2113004726, 2113004947, 2113004948, 2113004868, 2113004945, 2113004261, 2113004780, 2113004267, 2113004419, 2113004614, 2113004729, 2113004251, 2113004933, 2113004259, 2113004822, 2113004866, 2113004867, 2113004944, 2113004865, 2113004942, 2113004871, 2113004872, 2113004275, 2113016359, 2113004870, 2113004752, 2113004833, 2113004877, 2113004754, 2113004831, 2113004952, 2113004830, 2113033012, 2113004761, 2113004317, 2113004305, 2113004888, 2113004889, 2113004884, 2113004764, 2113004885, 2113004262, 2113004481, 2113033011, 2113004753, 2113004762, 2113009499, 2113013691, 2113019919, 2113009684, 2113014845, 2113009951, 2113020785, 2113032338, 2113029519, 40320028801, 2113035283, 2113029515, 2113046196, 2113046191, 2113046317, 2113046190, 2113046158, 2113046157, 2113046188, 2113046186, 2113046185, 2113046184, 2113046250, 2113046183, 2113046664, 2113014142, 2113016730, 2113046666, 2113046665, 2113047302, 2113047300, 2113047309, 2113045265, 2113024245, 2113045536, 2113045316, 2113045733, 2113045457, 2113045732, 2113045456, 2113045256, 2113045279, 2113045453, 2113045452, 2113045319, 2113045317, 2113045538, 2113045318, 2113045142, 2113033783, 2113033784, 2113033785, 2113045448, 2113045247, 2113045269, 2113045468, 2113045267, 2113045147, 2113045246, 2113045268, 2113045266, 2113045091, 2113012878, 2113014117, 2113045153, 2113045296, 2113045451, 2113045154, 2113045151, 2113045295, 2113045270, 2113045095, 2113045150, 2113045092, 2113026271, 2113026274, 2113026286, 2113034695, 2113017510, 2113032547, 2113034697, 2113007938, 2113007940, 2113004380, 2113007410, 2113045525, 2113017610, 2113019146, 2113007525, 2113007579, 2113007413, 2113007501, 2113007444, 2113007598, 2113007498, 2113007575, 2113017609, 2113007485, 2113007595, 2113032287, 2113009202, 2113009208, 2113009268, 2113009260, 2113016443, 2113019497, 2113009210, 2113009213, 2113020673, 2113009226, 2113009216, 2113009206, 2113009207, 2113009229, 2113034703, 2113009209, 2113009407, 2113034506, 2113034704, 2113034507, 2113019415, 2113019416, 2113000815, 2113047756, 2113000853, 2113048086, 2113048088, 2113048012, 2113048022, 2113048014, 2113048013, 2113048018, 2113048082, 2113048083, 2113047737, 2113033796, 2113015828, 2113033035, 2113015960, 2113034815, 2113033034, 2113015961, 2113004770, 2113004398, 2113004718, 2113004949, 2113004719, 2113034781, 2113004946, 2113004778, 2113004779, 2113004402, 2113004776, 2113004741, 2113004950, 2113004335, 2113004399, 2113004396, 2113004880, 2113004397, 2113004881, 2113014869, 2113034782, 2113034783, 2113009358, 2113033999))
group by 1,2; 

--shopped superbowl
create or replace temporary table shopped_sb_in_observation_hh as
select household_id,
count(distinct txn_id) as sb_txn_hh,
sum(item_qty) as sb_qty_hh,
sum(net_sales) as sb_net_sales_hh,
sum(net_sales- markdown_amt) as sb_gross_sales_hh
from  gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_TXN_UPC
where TRUE
and upc_id in (7114242378, 7114281777, 7114200948, 7572000854, 7572030020, 7572073411, 8265741157, 8265772323, 8265754221, 2259200811, 2259206669, 2259263777, 8304600817, 8304613480, 8304691164, 88939200031, 88939201017, 88939200028, 88939201019, 85248100715, 88939200090, 88939200091, 88939200170, 88939200172, 88939202131, 88939200075, 88939200130, 88939200174, 88939200032, 88939200132, 88939200154, 88939200176, 88939201002, 88939201001, 88939200134, 88939200156, 88939200178, 88939200059, 88939202139, 88939200139, 85248100712, 85248100711, 85248100710, 88939202141, 88939200086, 88939200362, 88939200120, 88939202143, 88939202145, 88939201014, 81829001279, 81829001280, 81829001193, 81829001281, 81829001282, 81829001381, 81829001851, 81829001833, 81829001834, 81829001937, 81829001850, 81829001832, 81829001283, 81829001382, 81829001284, 81829001285, 81829001275, 81829001672, 81829001277, 81829001854, 81829001944, 81829001626, 85977400784, 85977400727, 85977400772, 86998200005, 86998200001, 86998200000, 85977400742, 85977400783, 78616200151, 78616241107, 78616200612, 78616200610, 78616200622, 78616241121, 78616241076, 78616241059, 78616241068, 78616200608, 78616241069, 78616201000, 78616200530, 78616200298, 78616200485, 78616200498, 78616200531, 78616200379, 78616241074, 78616200425, 78616241083, 78616204000, 78616241188, 78616241186, 78616241136, 78616207000, 78616200297, 78616241134, 78616200296, 78616200373, 78616208000, 78616215000, 78616211000, 4900007935, 4900007940, 4900055573, 4900055572, 4900007933, 4900055571, 4900007934, 4900007931, 4900007942, 4900007932, 4900007937, 4900007938, 4900055417, 4900007936, 4900007939, 4900055444, 85817600206, 85000994257, 85000994233, 85817600248, 85817600205, 85817600227, 85817600217, 85000994259, 81011383022, 81011383134, 85817600250, 81011383136, 85817600211, 85817600277, 85817600213, 81011383140, 85817600295, 85000994231, 85817600252, 85817600296, 81011383021, 81011383020, 81011383130, 62830814009, 62830814011, 62830814010, 62830814031, 62825084280, 62825084276, 62825084278, 7342011614, 7342001614, 2529300149, 2529300099, 2529300098, 2529300136, 2529300119, 2529360217, 3663208014, 3663208078, 3663207267, 3663207268, 3663207735, 4127102564, 3663207974, 3663207810, 3663208006, 4127100955, 4127101788, 4127101997, 4127102502, 4127102568, 4127100970, 4127101993, 4127102258, 4127102256, 3663208092, 4127100472, 4127102253, 3663208091, 4127102260, 3663207809, 4127100908, 7457000400, 7457046203, 7457091010, 7457065140, 7457095015, 7457044400, 7457002400, 7457052400, 7457008406, 7457098025, 7457061739, 7457004408, 7457009400, 7457060686, 7457092849, 7457073192, 7457003400, 7457067459, 7457057918, 7457061532, 7457065057, 7457065058, 7457048338, 7457065030, 7457065176, 7457095003, 7457043400, 7457020864, 7457025117, 7457097608, 7457001400, 7457036092, 7457048418, 7457053400, 7457008400, 7457008005, 7457061007, 7457081011, 7457087659, 7457031995, 7457004400, 7457030544, 7457011400, 7457027400, 7255400154, 7255487026, 7255411146, 7255411057, 7255438745, 7255485201, 7255400153, 5000069659, 7255411119, 7255427399, 7255481457, 7255494573, 7255472183, 4154861004, 4154879245, 4154875095, 4154875150, 4154861404, 4154800004, 4154861604, 4154800005, 4154800007, 4154831260, 4154851718, 4154824404, 4154861204, 4154875092, 4154841362, 7457003310, 7457091935, 7457022403, 7457042854, 7457001310, 7457002310, 7457065562, 7255400004, 7255400003, 7255400005, 7255400002, 2780006763, 2780006558, 2780006469, 2780006557, 2780007657, 2780006644, 2780007810, 3010003319, 2780006467, 2780006555, 2780006643, 2780006477, 3010050561, 2780006476, 2780006586, 2780005860, 2780006794, 2780006970, 2780006571, 2780006394, 2780006570, 2780006580, 3010010026, 2780006480, 7225002108, 7225008396, 7225002109, 7225001137, 7225001138, 7225000685, 7225008420, 2840073740, 2840076296, 2840030850, 2840073580, 2840076014, 2840015458, 2840076017, 2840073742, 2840073745, 2840031501, 2840070504, 2840067973, 2840015463, 2840067971, 2840068427, 2840067977, 2840069836, 2840025492, 2840075056, 2840073314, 2840015443, 2840051549, 2840073756, 2840015446, 2840072955, 2840073759, 2840067960, 2840067969, 2840022772, 2840063763, 2840068537, 2840068856, 81060702497, 2840076238, 2840076239, 2840072749, 2840067950, 2840020546, 2840069335, 2840076000, 2840051288, 2840073894, 2840075995, 2840076644, 2840076009, 2840069291, 2840069405, 2840069603, 2840070553, 2840067947, 2840068119, 2840067945, 2840031041, 2840051779, 2840037649, 2840075088, 2840007230, 2840073228, 2840073701, 2840022988, 2840011262, 2840037650, 2840075092, 2840075095, 2840037619, 2840037618, 2840051783, 2840051782, 2840051781, 2840048277, 2840051780, 2840074003, 2840073994, 2840076105, 2840076548, 2840051784, 2840076305, 2840073997, 2840069347, 2840052838, 2840069346, 2840031040, 81060702508, 2840031046, 2840031044, 2840031283, 2840053274, 2840031407, 2840051776, 2840068690, 2840051775, 2840051774, 2840073720, 2840031406, 2840051773, 2840031403, 2840070648, 2840017335, 2840031404, 2840051778, 2840051777, 2840000617, 2840037790, 2840031409, 2840031050, 2840048278, 2840065979, 2840003400, 2840008314, 2840031058, 81060702443, 2840059888, 2840031054, 2840031055, 81060702445, 2840076607, 2840031413, 2840068751, 1600012479, 1600022195, 1600022233, 1600027532, 1600023117, 1600022205, 1600020104, 1600022235, 1600021658, 1600015163, 1600027515, 1600027526, 1600012254, 1600012222, 1600012025, 1600012399, 1600015128, 1600012544, 1600012542, 1600019707, 1600021191, 1800000401, 1800000501, 1800000211, 1800000415, 1800000526, 1800000757, 1800000512, 1800000420, 1800000058, 1800000210, 1800000075, 1800000142, 1800000186, 1800000183, 1800000260, 1800000182, 1800000918, 1800000318, 4280010953, 4280010915, 4280010924, 4280010921, 4280010954, 4280013828, 4280010952, 1600026460, 1600020094, 1600020093, 1600022098, 1600046684, 1600018793, 1600027706, 1600018794, 1600018892, 1600027707, 1600041727, 1600041126, 1600043980, 1600028920, 1600027855, 1600022101, 1600023121, 1600023119, 1600021211, 1600022242, 1600022243, 1600046679, 1600014481, 1600046757, 1600046758, 1600017944, 1600041314, 1600045898, 1600045798, 1600045897, 1600016893, 1600040761, 1600026470, 1600028372, 1600014732, 1600049298, 1600027700, 1600022693, 1600020088, 1600018145, 1600022931, 1600019430, 1600042419, 1600022782, 1600018573, 1600022228, 1600018910, 1600035540, 1600016212, 1600018575, 1600039700, 1600022093, 1600014711, 1600014733, 4119613975, 4119613974, 4119613978, 4119613976, 4119613977, 1583909719, 1583909721, 1583909720, 1583909671, 7835557010, 7835557000, 7835558000, 7835560035, 7835557025, 7835555000, 7835557005, 7835560018, 82951532226, 82951532580, 82951532616, 82951532653, 82951532577, 82951532645, 85186100609, 81118403028, 85186100607, 85186100606, 85186100616, 81118403144, 81118403125, 81118403025, 81118403020, 85186100612, 85186100611, 85186100666, 81118403000, 85186100610, 81118403186, 85186100686, 85186100671, 7261373945, 2420009456, 7261347410, 7261347420, 7261347415, 2420005448, 7261347418, 2420005347, 7261347417, 2420005386, 2420005482, 2420005362, 2420009420, 2420005467, 2420005464, 7261373916, 7261373978, 7261373947, 2420004490, 3760013872, 3760028428, 3760014173, 3760031639, 3760043470, 3760017534, 3760033658, 3760015121, 3760011544, 3760035930, 3760016900, 3760022121, 3760064205, 3760021758, 3760021750, 3760036215, 3760021753, 3760021756, 3760021760, 3760013260, 3760005849, 3760026524, 3760043561, 3760013282, 3760013264, 3760088385, 3760013283, 3760088384, 3760026030, 3760059320, 3760088388, 3760073580, 3760025836, 3760049767, 3760039051, 3760073620, 3760035629, 3760018237, 3760037939, 3760027468, 3760047371, 7287829078, 3760025756, 7287829079, 3760015491, 7287829080, 3760048713, 4410015618, 4410015619, 4410015620, 4410019081, 4410019092, 4410015621, 4410019080, 4410019093, 4157005617, 4157005621, 4157009915, 4157005670, 4157014999, 4157005618, 4157010993, 4157005625, 4157010964, 4410019074, 4410019095, 4410016502, 4410019094, 4410019076, 4410019075, 7357013000, 7357013006, 7357013007, 7357056575, 7357013033, 7357013003, 5150004815, 5150000630, 5150004816, 5150004962, 5150021179, 5150082556, 2550030407, 2550030439, 2550030442, 2550030443, 2550030440, 2550030441, 2550030411, 2550030444, 2550030445, 88810911010, 88810911180, 88810911060, 88810911061, 88810911385, 88810911423, 88810911224, 88810925261, 88810911503, 88810925022, 88810925584, 88810925661, 88810925266, 88810925614, 88810925458, 88810925937, 88810925934, 88810925616, 88810925858, 88810925935, 88810925939, 88810911497, 88810911016, 88810911058, 88810911059, 88810911411, 88810925450, 25136200000, 88810925454, 88810925850, 88810925688, 88810925524, 88810911084, 88810911001, 88810911485, 88810911401, 88810911006, 88810911402, 88810911004, 88810911009, 88810911007, 88810911525, 88810925488, 88810925437, 88810925559, 88810925999, 88810925556, 88810926008, 88810925439, 88810925516, 88810911078, 88810911155, 88810911079, 88810911198, 88810925032, 88810925472, 88810925475, 88810911403, 88810925994, 88810911535, 88810911459, 88810925514, 88810925901, 88810911121, 88810911131, 88810911138, 88810911244, 88810911428, 88810911064, 88810911312, 88810925744, 88810911090, 88810915003, 88810915004, 88810911188, 88810911065, 88810911088, 88810911154, 88810915002, 88810925465, 3997800844, 3997802596, 3997803420, 7430500132, 86000046850, 86000046853, 85004792019, 4364620128, 4364620400, 4364610482, 4364646101, 4364620758, 2410010685, 2410000017, 2410044077, 2410051445, 2410078925, 2410011098, 2410078887, 2410059473, 2410000019, 2410059475, 2410012137, 2410010633, 2410011660, 2410011487, 2410078909, 2410012418, 2410078938, 2410012090, 2410078914, 2410011062, 2410059441, 2410078895, 2410011060, 2410012292, 2410012424, 2410012435, 2410010443, 2410012129, 2410012404, 2410010445, 2410049384, 2410010608, 3010010057, 3010010055, 3010010068, 3010010309, 3010012460, 3010078458, 3010010614, 3010011176, 3010012902, 3010010070, 3010012977, 2410011441, 3800013841, 3800013927, 3800029312, 3800028445, 3800018060, 3800028447, 3800029835, 3800030500, 3800030263, 3800024939, 3800013881, 3800013860, 3800030190, 3800024556, 3800013863, 3800013843, 3800013887, 3800024553, 3800029741, 3800029322, 3800030498, 3800030496, 3800028017, 3800029888, 3800028458, 3800028019, 3800018371, 3800027647, 3800024349, 3800013872, 3800013897, 3800016527, 3800021791, 3800013857, 3800028021, 3800029310, 3800029376, 3800028023, 8768400107, 8768400094, 8768401063, 8768400287, 8768400113, 8768400112, 4300008403, 8768400100, 8768400099, 8768400110, 4300008401, 8768400097, 8768400095, 8768400106, 8768400115, 8768400114, 2100065883, 2100002809, 7766100316, 7766100313, 7766100412, 7766101513, 7766104813, 7766111909, 7766100112, 7766102913, 7766116185, 7766101413, 7766100813, 7766111792, 7766111593, 7766116628, 7766113858, 7766111798, 7766104213, 7766100012, 89824800107, 89824800150, 84029070014, 89824800184, 89824800156, 89824800157, 89824800110, 89824800143, 89824800100, 89824800111, 84029070031, 84029070030, 89824800106, 89824800158, 89824800148, 4767739129, 4767748527, 4767739128, 4767748525, 4400006023, 4400006045, 4400007299, 4400007298, 4400006842, 4400007975, 4400007215, 4400007214, 4400001473, 4400007378, 4400008142, 4400006041, 4400007803, 4400007767, 4400005903, 4400005869, 4400006518, 4400007805, 4400007465, 4400006017, 4400006699, 4400007227, 4400006016, 4400006697, 4400007742, 4400008151, 4400008152, 4400008070, 4400007183, 4400008108, 4400007739, 4400006024, 4400007550, 4400006028, 4400007832, 4400006027, 4400007798, 4400006026, 4400007511, 4400007797, 4400008168, 4400006025, 4400006063, 4400007196, 4400007590, 4400006854, 4400007708, 4400007706, 4400007705, 4400006112, 4400007321, 4400007320, 4400005389, 4400006039, 4400007722, 4400006038, 4400007963, 4400006113, 4400007759, 4400007515, 4400007559, 4400003111, 4400007773, 4400008104, 4400007249, 4400005781, 4400005043, 4400005094, 4400005041, 4400005109, 4400005105, 4400005129, 4400005106, 4400005104, 4400007771, 4400007545, 4400007770, 4400007970, 4400003483, 4400008039, 4400008248, 4400003133, 4400008343, 4400003113, 4400008042, 4400008175, 4400002389, 4400003115, 4400003545, 4400003117, 4400003116, 4400003544, 4400005359, 4400003119, 4400007905, 4400005098, 4400005550, 4400008107, 4400008067, 4400008066, 4400008143, 4400003049, 4400003048, 4400007526, 4400007525, 4400005549, 4400004472, 4400005166, 4400004471, 4400005642, 4400006457, 4400008078, 4400005643, 4400005840, 4400006456, 4400005168, 4400005839, 4400004546, 4400006923, 4400006922, 4400004545, 4400006409, 4400006925, 4400006924, 4400005099, 4400005132, 4400005133, 4400005174, 4400007232, 4400008404, 4400005136, 4400004488, 4400005134, 4400005135, 4400005172, 4400000878, 4400005801, 4400006458, 4400007828, 4400007827, 4400005100, 4400007524, 4400003047, 4400005101, 4400005138, 4400004446, 4400003219, 4400003394, 4400006397, 4400003223, 4400004466, 4400007269, 4400002991, 4400003221, 4400008131, 4400006393, 4400002456, 4400003225, 4400006986, 4400004913, 4400004637, 81029100100, 81029100775, 81029100797, 81029100896, 81029100876, 81029100413, 81029100778, 81029100719, 81029100101, 81029100685, 81029100102, 81029100783, 81029100367, 81029100445, 81029100687, 81029100104, 81029100105, 81029100766, 81029100106, 81029100446, 81029100724, 81029100768, 81029100108, 81029100109, 81029100208, 81029100092, 81029100192, 81029100370, 81029100230, 81029100790, 81029100176, 81029100694, 81029100771, 81029100298, 81029100696, 81029100795, 81029100894, 81029100794, 4400007841, 4400007792, 4400007840, 4400008125, 4400008010, 4400008021, 4400008172, 4400007836, 4400007835, 4400007846, 4400007834, 4400007845, 4400007844, 4400007839, 4400007838, 81029100982, 4400007837, 4470002454, 4470010319, 4470010416, 4470010417, 4470007092, 4470010349, 4470010426, 4470010320, 4470010321, 4470010351, 4470002410, 4470036000, 4470010350, 4470036002, 4470036035, 4470002411, 4470002455, 4470036001, 4470002458, 75166677155, 75166616505, 75166648005, 75166695005, 75166677225, 75166610315, 75166610305, 75166641685, 75166610345, 75166641645, 76770700214, 76770700106, 76770700167, 76770701480, 76770701350, 76770700125, 76770700215, 3077213451, 3077208813, 3077204311, 3077204312, 3077209204, 3077206132, 3077208797, 3077213217, 3077201570, 3077204170, 3077208471, 3077208470, 3077215705, 3077216014, 3077216019, 3077205662, 3077216041, 3077205630, 3077206166, 3077215663, 3077215662, 3077216020, 3077216277, 3077219274, 1200000230, 7800001356, 1200010542, 7800001397, 1200003098, 7800003532, 7800003536, 1200000971, 1200000496, 1200024029, 1200000935, 4300099608, 1200017226, 1200020237, 7800020746, 7092500030, 7800009846, 7800001407, 1200000492, 7800008246, 7800003552, 7800001371, 7800001336, 1200016346, 1200017237, 7800002300, 7800000408, 7800021546, 7800003119, 7800001416, 1200000113, 1200000311, 1200000233, 1200001321, 1200000231, 1200001881, 1200022147, 1200000952, 1660051312, 4300095265, 7800020646, 1200003066, 1200006453, 7800020446, 1200006452, 1200024014, 4171011288, 1200000341, 7800039416, 7800008346, 1200000746, 1200017213, 1200017258, 1200017252, 1200017176, 1200014092, 7800001315, 7800003507, 1200014113, 1200017173, 1200014093, 1200014095, 7800008239, 1200014094, 1200020320, 7800002639, 7800003823, 5200013513, 5200004234, 5200004233, 5200004232, 5200004231, 5200004678, 5200004314, 5200005028, 5200010411, 5200010410, 5200013508, 5200004704, 5200004328, 5200004327, 5200010241, 5200013490, 5200004403, 5200005798, 5200004400, 5200013514, 5200013515, 5200005451, 5200013516, 5200005230, 5200013517, 5200013519, 5200001029, 5200013528, 5200005802, 5200010297, 81809400577, 81809400580, 81809400581, 81809400582, 81809400583, 81809400585, 81809400860, 81809400025, 81809400300, 81809400586, 81809400587, 81809400588, 1200022092, 81809400589, 81809400828, 81809400070, 81809400590, 81809400591, 81809400592, 81809400593, 81809400594, 81809400873, 1200023071, 81809400875, 81809400998, 1200022186, 81809400681, 81809400002, 81809400840, 1200023041, 81809400208, 1200023043, 81809400691, 81809400495, 81809400650, 81809400497, 81809400574, 81809400575, 81809400971, 81809400499, 81809400576, 81809400973, 1200024060, 81809400578, 81809400579, 81809400975, 1200023051, 1200024062, 81809400537, 81809400977, 1200023053, 81809400858, 1200023045, 1200023047, 1200023049, 5200000339, 5200001361, 5200000296, 5200005035, 5200004154, 5200000342, 5200000297, 5200000344, 5200000299, 5200000343, 5200005270, 5200004274, 5200070778, 5200070777, 5200070779, 5200001358, 5200000338, 5200004749, 5200005490, 1200028617, 1200020649, 9800010035, 1200020651, 1200004283, 1200028621, 1200028620, 1200021351, 1200018094, 1200028624, 1200028623, 1200028622, 1200004643, 1200028618, 1200004117, 1200021346, 1200004644, 1200018103, 1200021348, 9800010043, 1200018105, 1200028619, 7701361557, 7701361559, 7701361563, 7701361574, 7701361598, 7701361570, 7701361581, 7701361572, 7701301172, 7701301317, 7701301314, 7701301065, 7701301131, 7701301130, 75579517501, 75579537539, 75579537504, 75579537527, 75579537513, 75579537535, 75579537568, 75579537514, 75579537577, 75579537545, 75579537567, 75579537575, 75579537551, 75579537573, 75579537552, 75579537574, 75579537571, 75579537550, 75579517502, 75579570000, 75579570007, 75579570008, 75579570101, 75579570003, 75579570005, 75579570001, 75579570100, 81006371030, 81006371170, 81006371031, 81006371130, 81006371032, 81006371033, 81006371055, 70958651483, 81006371105, 81006371007, 81006371029, 81006371008, 81006371107, 70958651489, 70958651487, 70958651485, 81006371088, 81006371012, 81006371013, 81006371035, 72419081287, 81006371014, 81006371036, 81006371059, 81006371016, 81006371017, 81006371039, 3000031182, 3000031181, 3000031280, 3000031407, 3000031188, 3000031271, 3000031282, 3000031184, 3000031175, 3000031269, 3000031180, 3000006322, 3000057322, 3000057802, 3000057801, 3000057812, 3000057853, 3000056083, 3000006354, 3000057323, 3000057288, 3000057321, 3000066507, 3000057361, 3000057578, 3000057362, 1530044051, 1530043053, 1530044082, 42630004801, 1530043048, 1530044017, 1530043047, 1530043006, 1530043028, 1530044016, 1530043980, 1530044035, 1530044036, 1530043024, 1530044033, 1530044132, 1530043023, 1530043061, 1530044032, 1530043060, 26755, 1530001406, 1530001428, 26757, 1530043059, 42632009101, 1530044049, 1530044002, 1530044025, 1530043034, 1530043078, 61126981899, 61126900312, 61126900214, 61126917452, 61126932121, 61126918246, 61126900192, 61126920643, 61126900173, 61126900130, 61126900252, 61126900165, 61126900101, 61126900244, 61126928310, 61126900226, 61126900304, 61126900206, 61126911357, 61126971646, 61126962373, 61126933282, 61126921245, 61126900184, 61126900261, 61126900164, 61126900270, 61126900276, 4610000122, 4610000123, 4610000189, 4610000222, 4610000223, 4610002048, 4610000121, 4610000165, 4610000221, 4610002046, 4610000226, 4610000106, 4610000125, 4610000224, 4610000268, 4610000107, 4610035788, 4610035786, 4610041107, 4610041106, 4610040059, 4610020303, 4610040076, 4610040096, 4610040051, 4610000692, 4610040012, 4610000272, 4610000233, 4610000113, 4610000110, 4610000694, 4610000114, 4610040092, 4610040029, 4610080085, 4610000163, 4610000164, 4610040002, 4610020295, 4610040066, 4610035403, 4610000941, 4610000942, 4610035627, 4610000940, 4610001115, 4610000967, 4610035339, 4610000968, 4610035338, 4610000943, 4610001912, 4610035632, 4610035631, 4610035341, 85006583502, 85006583508, 85006583504, 85006583512, 85006583500, 85006583510, 85006583514, 85006583532, 1657191030, 1657194035, 1657194037, 1657194038, 1657195087, 1657194033, 1657194034, 1657195084, 1657195085, 1657195086, 1657191126, 1657195924, 1657195926, 1657191125, 1657194039, 1657195920, 1657195889, 1657195922, 1657124611, 1657191031, 1657195477, 1657124614, 1657195352, 1657195396, 1657191032, 1657195030, 1657195790, 1657124574, 1657124573, 1657124576, 1657124575, 1657191037, 1657195436, 1657195437, 1657195267, 1657195268, 1657195424, 1657195780, 1657195781, 1657195029, 1657195696, 1657195334, 1657194042, 1657196023, 1657195210, 1657195211, 1657194040, 1657195535, 1657195810, 1657195338, 1657195812, 1657195966, 1657195968, 1657195970, 1657196055, 1657196059, 1657196061, 3022304156, 3022302433, 3022302432, 3022304218, 3022306138, 3022304114, 3022302434, 3022304230, 82486200631, 3022304150, 82486200630, 3022304074, 3022304151, 3022306099, 3022306110, 3022304152, 82486200632, 3022306161, 3022304206, 3022301198, 3022304109, 3022304048, 3022306126, 3022304225, 3022306008, 3022304186, 3022306200, 3022304189, 3022304064, 3022304185, 7283008114, 7283008141, 7283008140, 7283008101, 7283008123, 7283008122, 7283008144, 7283008121, 7283008143, 7283008105, 7283008127, 7283008104, 7283008126, 7283008103, 7283008125, 7283008109, 7283008108, 7283008107, 7283008129, 7283008106, 7283008112, 7283008111, 7283008110, 7283008132, 7283008116, 7283008138, 7283008115, 7283008137, 7283008136, 7283008113, 7283008119, 7283008118, 7283008139, 2370005588, 2370005585, 4800121348, 4800120436, 4800121358, 4800120437, 4800121351, 4800121350, 4800121372, 4800101663, 4800101662, 4800135450, 4800135428, 4800135385, 4800135384, 4800135449, 4800102599, 4800110896, 4800135386, 7585600110, 7585600170, 7585613901, 7585602415, 7585603114, 7585601113, 7585600089, 7585601120, 7585600084, 7756700154, 7756700158, 7756700157, 7756700388, 7756700156, 7756700365, 7756700121, 7756700363, 7756700384, 7756708516, 7756727442, 7756700381, 7222022032, 7222022041, 7222021997, 7222021996, 7222021994, 7222021990, 7222022034, 1411373406, 1411391084, 1411391061, 1411391063, 1411391085, 1411370194, 1411370238, 1411370035, 1411370156, 1411370036, 1411370104, 85002101543, 85005175526, 85002101526, 85002101562, 85002101544, 85002101532, 85002101565, 5000024731, 5000037753, 5000045530, 5000045676, 5000048025, 5000061599, 5000061944, 5000064869, 5000066617, 5000068446, 5000069669, 5000070500, 5000074875, 5000083281, 5000087685, 76211197222, 5000094788, 5000094919, 76211100099, 76211100109, 76211100139, 76211188810, 76211188811, 76211188812, 76211194958, 76211194960, 76211188813, 76211188818, 76211189531, 76211192557, 76211193025, 76211140508, 76211144221, 76211108024, 76211109333, 76211110555, 76211116504, 76211142732, 76211169195, 76211143432, 76211116506, 76211116543, 76211123603, 76211130100, 76211130528, 76211114275, 76211101439, 76211120602, 76211120603, 76211120604, 76211120605, 76211120609, 76211120611, 76211120612, 76211120613, 76211120624, 76211120625, 76211123334, 76211134374, 76211140598, 76211143514, 76211145398, 76211148306, 76211148308, 76211151103, 76211152983, 76211155935, 76211157059, 76211157170, 76211162281, 76211162285, 76211162286, 76211162287, 76211162289, 76211162290, 76211162291, 76211179575, 76211181056, 76211181059, 76211185714, 76211188554, 76211193428, 76211193446, 76211193448, 76211193598, 76211194980, 76211198040, 76211199617, 76211199618, 76211138012, 76211138013, 76211138015, 76211147021, 76211156158, 980000055, 980051204, 82926200034, 82926200033, 82926200143, 82926200035, 82926200069, 82926200218, 82926200452, 82926200453, 82926200454, 82926200469, 82926200468, 81012597069, 81012597070, 86373700016, 85174100833, 84026632458, 84026630000, 88939200116, 88939200128, 88939208076, 88939208061, 88939208862, 88939208005, 64384371448, 64384380086, 64384371466, 64384380073, 64384380095, 64384371451, 64384371504, 64384371658, 64384371655, 64384371610, 64384371502, 64384371667, 64384371588, 64384371590, 7007466897, 7007468167, 7007466891, 7007467166, 7007468461, 7007468170, 7007440711, 7007440705, 7007453807, 7007451785, 7007440701, 4167967566, 4167967466, 4167967666, 74982600016, 74982600008, 74982600019, 74982600010, 81771902240, 81771902175, 81771902165, 81771902248, 81771902171, 78656015312, 82926200181, 82926200183, 82926200184, 82926200182, 82926200023, 82926200095, 82926200096, 82926200020, 82926200031, 82926200010, 82926200021, 82926200170, 82926200094, 82926200004, 82926200007, 82926200022, 82926200001, 82926200002, 82926200003, 82926200157, 82926200008, 82926200009, 82926200331, 82926200386, 85777700423, 85777700418, 85777700419, 85777700468, 85777700420, 19390800517, 85777700474, 78769283961, 78769283964, 72225206876, 72225206869, 72225206877, 72225206879, 72225206878, 72225206880, 72225206882, 72225206881, 81000647272, 81000647270, 81000647984, 81000647278, 81000647280, 1204405897, 1204406060, 1204406064, 1204405892, 1204406309, 1204406320, 1204403753, 1204403752, 1204403861, 1204401113, 1204403963, 1204405654, 1204403969, 1204403869, 3700073388, 3700073413, 3700094479, 3700098325, 3700094480, 1204404494, 1204403750, 1204404609, 1204404610, 1204404611, 1204404612, 1204404613, 1204404614, 1204404816, 1204404817, 1204404989, 1204405381, 1204405657, 1204405661, 1204405666, 1204405667, 1204405670, 1204405671, 1204405678, 1204405737, 1204438970, 12044045145, 12044056769, 1204401560, 1204402036, 1204402180, 1204402335, 1204402983, 1204402999, 1204403000, 1204403006, 1204403756, 1204403759, 1204403962, 1204404089, 1204404108, 1204404407, 1204404511, 7940026654, 7940044834, 7940035299, 7940038641, 7940035293, 7940035297, 7940035120, 7940059301, 7940063101, 7940069144, 7940006671, 7940031153, 7940059303, 7940031152, 7940006672, 7940044603, 7940034218, 7940057629, 7940034242, 7940059146, 7940034219, 7940051183, 7940051182, 7940060068, 7940044778, 7940063428, 7940046946, 7940069179, 7940045814, 7940044786, 7940051753, 7940051776, 7940051755, 7940051978, 7940052806, 7940007217, 7940007216, 7940044821, 7940051995, 7940026655, 7940051996, 7940045025, 7940051999, 7940031247, 7940051997, 7940026540, 7940026570, 7940044870, 7940020570, 7940021628, 7940066914, 7940006147, 7940031260, 7940001343, 7940001743, 7940025190, 7940058719, 7940026560, 7940058708, 7940011802, 7940031175, 7940027532, 7940031268, 7940046170, 1111157598, 1111124093, 1111126285, 1111100793, 7940055020, 7940055110, 7940016118, 7940058983, 7940046106, 7940006125, 7940007365, 7940046105, 7940046969, 7940046978, 7940026102, 7940053430, 7940019720, 7940055300, 7940058987, 7940026094, 7940026093, 7940037997, 85003036052, 85003036030, 85004205829, 85003036042, 85005667118, 85005667119, 85005667120, 85005667168, 81215403001, 81215403081, 81215403508, 81215403838, 81215403008, 81215403018, 81215403117, 81215403005, 3077218337, 81215403003, 81215403144, 3077218340, 81215403172, 81215403293, 38371100250, 38371100249, 38371100246, 38371100247, 7940005248, 7940044659, 7940020239, 7940051328, 2279691670, 2279691006, 2279691611, 2279691005, 2279690090, 2279691612, 2279690092, 5280068184, 5280068187, 2279691671, 2279691015, 2279691014, 7940086660, 7940050730, 7940050740, 4589308053, 7940064948, 7940064949, 4589303305, 7940086670, 2240001176, 2240000521, 2240001408, 2240001407, 2240064045, 2240064261, 2240064316, 2240001392, 2240064336, 2240001173, 2240001393, 2240039368, 2240039366, 2240039365, 2240001177, 2240001394, 2240039363, 2240039362, 2240039361, 2240026512, 2240000522, 2240000800, 2240000205, 2240000986, 2240026518, 2240062374, 2240062392, 2240039379, 2240062366, 2240001181, 2240039377, 2240001143, 2240001264, 2240039375, 2240001362, 2240039373, 2240001147, 2240039372, 2240001145, 2240001266, 2240001146, 2240001267, 7940018181, 7940046666, 7940006664, 4589306359, 7940085860, 7940081670, 7940006296, 7940006663, 7940006661, 7940006662, 7940018182, 7940045031, 7940018183, 7940045030, 7940019375, 7940019373, 7940045953, 7940045948, 7940012196, 7940049593, 7940049597, 7940049592, 7940049596, 7940049594, 7940049599, 38371100049, 7940046535, 7940049797, 38371100048, 7940049272, 7940049269, 7940052235, 81215403327, 81215403849, 81215403328, 81215403658, 81215403657, 81215403535, 81215403325, 81215403534, 81215403324, 81215403533, 81215403323, 81215403322, 81215403531, 81215403762, 81215403850, 81215403761, 81215403661, 81215403660, 3077206325, 3077206328, 3077206329, 3077206324, 3077206301, 3077206299, 30772062999, 30772063019, 30772063248, 30772063255, 30772063286, 30772063293, 84031740079, 1204404622, 1204404624, 1204404604, 1204404593, 1204404771, 1204404597, 1204404773, 1700002404, 1700002411, 1111161011, 1111101073, 1111161164, 1111102717, 1111104066, 1111161015, 1111161334, 1111161117, 1111104898, 1111121648, 1111107626, 85523500748, 81000647159, 81000647801, 85523500751, 81793901861, 81793901860, 84353610788, 84353611137, 84353610024, 81793901858, 84353610482, 81793901859, 81793901856, 81793901944, 81793901857, 81793901945, 81793901855, 81215403329, 81215403504, 81215403334, 81215403344, 81215403685, 81215403332, 81215403330, 1204405139, 3700085205, 1204405084, 1204405082, 1204405086, 1204405097, 1204405136, 1204405089, 7940032362, 7940032371, 7940049667, 7940032363, 7940049784, 7940049780, 7940032369, 1111112425, 1111163154, 1111112331, 1111104908, 1111101722, 1111104008, 1111102583, 1111101040, 1111103344, 1111107973, 1111112518, 1111152720, 1111107470, 1111111522, 1111112224, 1111126270, 1111101412, 1111165323, 1111101413, 1111101414, 1700035085, 1700035079, 1700004728, 1700015083, 1700098870, 4589307224, 4589307227, 7214002747, 7214003606, 7214003517, 7214003205, 7214003520, 7214002717, 7214002739, 7965604971, 7965604496, 7965604972, 7965614296, 7965602451, 7965613321, 7965613323, 7965614297, 7965600025, 7965604663, 7965601332, 7965603165, 7965603178, 7965603179, 7965604968, 7965605080, 7965605140, 7965605141, 7965613089, 7965613153, 7965613160, 7965614029, 7965614293, 7965601806, 7965602560, 7965605082, 7965614030, 7548608989, 7548609112, 7548608965, 7548609192, 7548613763, 7548614034, 7548614035, 7548614292, 7548614294, 7548614295, 7548608747, 7548608742, 7548608743, 7548609191, 7548614311, 7548608987, 7548609114, 7548609117, 8680068790, 8680010039, 8680010038, 8680068785, 8680087025, 8680087270, 8680011282, 8680010357, 8680011082, 8680068770, 8680010043, 8680011158, 8680011151, 8680011254, 8680011253, 8680006650, 8680087274, 8680019456, 8680019370, 8680006645, 8680087272, 8680010032, 81134602003, 81134602001, 81134602007, 81134602009, 84105800564, 84105800338, 84105800549, 84105801990, 84105800562, 84105802345, 84105802209, 7033074663, 7033074915, 7033074784, 7033074938, 7033071417, 7033072259, 7033074181, 7033074327, 7033071987, 7033073231, 84105800520, 84105800526, 84105800528, 84105800529, 84105801196, 84105800365, 84105802009, 84105804802, 85424200604, 85538000428, 81007508012, 81007508016, 85462000805, 81000647929, 81007508170, 85538000487, 85462000801, 85462000803, 85523500799, 85424200608, 4740011579, 4740067214, 4740067215, 4740012598, 4740065867, 4740011566, 4740012602, 4740004474, 4740004472, 4740068036, 4740064990, 4740031391, 4740031535, 4740030071, 4740031389, 4740030106, 4740031392, 7830009922, 7830009923, 7830014110, 7830008136, 7830014108, 7830013518, 7830014109, 7830014038, 7830014022, 7830014044, 7830014042, 7830014043, 7830014027, 3700093755, 3700081684, 3700086648, 3700088761, 3700088757, 3700088736, 3700088707, 3700081022, 3700056218, 3700073804, 3700088727, 3700088730, 3700072810, 7301071441, 7301071447, 7301071830, 7301071135, 7301000922, 7301071124, 7301071631, 7301071633, 7301071338, 7301071450, 7301000455, 7301071453, 7301000915, 7301000370, 7301001217, 7301001531, 7301001347, 7301071133, 7301063111, 7301071513, 7301071297, 3077200441, 3077203236, 7301071302, 7301071629, 7301071630, 7301071829, 7301071831, 3700076566, 3700081756, 3077203242, 3700025540, 3700097949, 3700081690, 7007458050, 7007458059, 7007458056, 7007458053, 7007466920, 81957301066, 85269700128, 85269700127, 81957301027, 81957301566, 81957301699, 85269700129, 81957301553, 81957301700, 81957301173, 81957301592, 81957301171, 81957301172, 81957301590, 81957301067, 81957301232, 81957301552, 81957301231, 81957301170, 2392320196, 2392320459, 2392333498, 82951532364, 2392323624, 2392323603, 2392323627, 2392323628, 2392353295, 2392353297, 2392333012, 2392333013, 2392333011, 1500007437, 1500004414, 1500007439, 1500007458, 1500081018, 1500004411, 1500004466, 1500007433, 1500007444, 1500007438, 1500004405, 1500004417, 1500093410, 1500093416, 1500093417, 1500007492, 1500081012, 1500007430, 1500081015, 1500020574, 1500020576, 2800081209, 2800093487, 3600031890, 3600048756, 3600050467, 3600055530, 1920077182, 1920089346, 1920089347, 1920081700, 1920097181, 1920085058, 1920081145, 1920081143, 1920099802, 1920089289, 1920098772, 1920075352, 1920099650, 1920002522, 1920076878, 1920098391, 1920080088, 1920085020, 1920002699, 1920000888, 1920099653, 1920002569, 1920078915, 1920082515, 1920082516, 1920082513, 4142004854, 7920006068, 4142001623, 4142008472, 4142008084, 4142001625, 4142008085, 4142008023, 7920005523, 4142008090, 4142008092, 7920008227, 3746601584, 954244133, 954244298, 3746601855, 3746601585, 954203446, 3746601400, 954200906, 954203189, 954245414, 954200419, 7046203596, 7046200905, 7046203598, 7046201372, 7046201371, 7046203600, 7046200920, 7046243351, 7046201090, 7046200522, 5770001727, 2089124709, 3077213354, 3077213353, 3700074968, 3700074969, 3700074971, 3700082881, 3700079466, 3700082879, 3700082876, 3700074962, 3700077583, 3700077584, 3700077599, 3700059643, 3700059644, 3700059605, 3077218866, 3700059606, 3700059627, 3077218865, 3700086225, 3700086226, 3700086224, 3700086223, 3700071507, 3700071512, 3700071543, 3700071486, 3077213355, 3077213352, 3700071483, 3700076469, 3700076470, 3700072406, 3700072407, 3700076466, 3700076510, 3700076468, 3700076416, 3077210431, 3700094174, 3700075416, 2113034614, 2113034615, 7989311055, 7989316144, 7989316179, 7989316178, 7989316180, 7989340589, 7989316181, 7989312499, 7989312498, 7989311116, 7989311115, 7989311118, 7989311117, 2113008800, 2113008490, 2113009261, 2113009262, 2113008970, 2113008853, 2113008810, 2113008767, 2113008801, 2113008802, 2113008803, 2113008808, 2113008809, 2113013356, 2113013355, 2113016442, 2113016440, 2113009671, 2113024246, 2113024247, 2113008860, 2113009675, 2113008862, 2113009676, 2113009677, 2113008820, 2113009678, 2113008469, 2113008813, 2113008857, 2113008815, 2113008818, 2113008819, 2113016439, 2113016438, 2113035095, 2113009200, 2113009486, 2113009201, 2113009126, 2113008830, 2113008822, 2113008824, 2113008826, 2113008828, 2113008949, 2113008192, 2113009292, 2113013353, 2113008881, 2113008884, 2113008765, 2113008834, 2113008168, 2113008837, 2113016419, 2113016418, 2113032277, 2113011900, 2113011909, 2113018360, 2113011907, 2113011908, 2113011901, 2113011912, 2113011902, 2113011910, 2113013836, 2113011911, 2113011905, 2113033969, 2113011906, 2113011903, 2113016428, 2113034147, 2113034138, 2113018359, 2113004466, 2113016354, 2113016353, 2113016355, 2113004602, 2113004526, 2113004603, 2113004600, 2113004601, 2113004610, 2113004896, 2113035053, 2113034607, 2113004263, 2113034608, 2113016358, 2113016357, 2113004550, 2113004518, 2113004837, 2113004519, 2113004517, 2113004836, 2113004515, 2113004598, 2113004726, 2113004947, 2113004948, 2113004868, 2113004945, 2113004261, 2113004780, 2113004267, 2113004419, 2113004614, 2113004729, 2113004251, 2113004933, 2113004259, 2113004822, 2113004866, 2113004867, 2113004944, 2113004865, 2113004942, 2113004871, 2113004872, 2113004275, 2113016359, 2113004870, 2113004752, 2113004833, 2113004877, 2113004754, 2113004831, 2113004952, 2113004830, 2113033012, 2113004761, 2113004317, 2113004305, 2113004888, 2113004889, 2113004884, 2113004764, 2113004885, 2113004262, 2113004481, 2113033011, 2113004753, 2113004762, 2113009499, 2113013691, 2113019919, 2113009684, 2113014845, 2113009951, 2113020785, 2113032338, 2113029519, 40320028801, 2113035283, 2113029515, 2113046196, 2113046191, 2113046317, 2113046190, 2113046158, 2113046157, 2113046188, 2113046186, 2113046185, 2113046184, 2113046250, 2113046183, 2113046664, 2113014142, 2113016730, 2113046666, 2113046665, 2113047302, 2113047300, 2113047309, 2113045265, 2113024245, 2113045536, 2113045316, 2113045733, 2113045457, 2113045732, 2113045456, 2113045256, 2113045279, 2113045453, 2113045452, 2113045319, 2113045317, 2113045538, 2113045318, 2113045142, 2113033783, 2113033784, 2113033785, 2113045448, 2113045247, 2113045269, 2113045468, 2113045267, 2113045147, 2113045246, 2113045268, 2113045266, 2113045091, 2113012878, 2113014117, 2113045153, 2113045296, 2113045451, 2113045154, 2113045151, 2113045295, 2113045270, 2113045095, 2113045150, 2113045092, 2113026271, 2113026274, 2113026286, 2113034695, 2113017510, 2113032547, 2113034697, 2113007938, 2113007940, 2113004380, 2113007410, 2113045525, 2113017610, 2113019146, 2113007525, 2113007579, 2113007413, 2113007501, 2113007444, 2113007598, 2113007498, 2113007575, 2113017609, 2113007485, 2113007595, 2113032287, 2113009202, 2113009208, 2113009268, 2113009260, 2113016443, 2113019497, 2113009210, 2113009213, 2113020673, 2113009226, 2113009216, 2113009206, 2113009207, 2113009229, 2113034703, 2113009209, 2113009407, 2113034506, 2113034704, 2113034507, 2113019415, 2113019416, 2113000815, 2113047756, 2113000853, 2113048086, 2113048088, 2113048012, 2113048022, 2113048014, 2113048013, 2113048018, 2113048082, 2113048083, 2113047737, 2113033796, 2113015828, 2113033035, 2113015960, 2113034815, 2113033034, 2113015961, 2113004770, 2113004398, 2113004718, 2113004949, 2113004719, 2113034781, 2113004946, 2113004778, 2113004779, 2113004402, 2113004776, 2113004741, 2113004950, 2113004335, 2113004399, 2113004396, 2113004880, 2113004397, 2113004881, 2113014869, 2113034782, 2113034783, 2113009358, 2113033999)
and txn_dte between min_obs_date and max_obs_date and household_id is not null
group by 1; 



--funnel
create or replace temporary table funnel as
with int as (
select
  comm.household_id,
  email_flag,
  push_flag,
  sms_flag,
  all_delivery_labels_email,
  all_delivery_labels_push,
  all_delivery_labels_sms,
  COALESCE(total_send_email,0) as total_send_email,
  COALESCE(total_send_push,0) as total_send_push,
  COALESCE(total_send_sms,0) as total_send_sms,

  COALESCE(total_open_email,0) as total_open_email,
  COALESCE(total_click_email,0) as total_click_email,
  COALESCE(total_open_push,0) as total_open_push,
  COALESCE(total_click_push,0) as total_click_push,
  COALESCE(total_open_sms,0) as total_open_sms,
  COALESCE(total_click_sms,0) as total_click_sms,

  COALESCE(distinct_open_email,0) as distinct_open_email,
  COALESCE(distinct_click_email,0) as distinct_click_email,
  COALESCE(distinct_open_push,0) as distinct_open_push,
  COALESCE(distinct_click_push,0) as distinct_click_push,
  COALESCE(distinct_open_sms,0) as distinct_open_sms,
  COALESCE(distinct_click_sms,0) as distinct_click_sms,
  COALESCE(unsubscribe_email,0) as unsubscribe_email,
  COALESCE(unsubscribe_push,0) as unsubscribe_push,
  COALESCE(unsubscribe_sms,0) as unsubscribe_sms,
  case when total_send_email>0 or total_send_push>0 or total_send_sms>0 then 1 else 0 end as hh_send,
  case when unsubscribe_push=1 or unsubscribe_email=1 or unsubscribe_sms=1 then 1 else 0 end as hh_unsubscribe,
  engaged
from all_campaigns_hh comm
)
select 
  household_id,
  int.email_flag as email_flag_sent,
  int.push_flag as push_flag_sent,
  int.sms_flag as sms_flag_sent,
  all_delivery_labels_email,
  all_delivery_labels_push,
  all_delivery_labels_sms,
  total_send_email,
  total_send_push,
  total_send_sms,
  total_open_email,
  total_click_email,
  total_open_push,
  total_click_push,
  total_open_sms,
  total_click_sms,
  distinct_open_email,
  distinct_click_email,
  distinct_open_push,
  distinct_click_push,
  distinct_open_sms,
  distinct_click_sms,
  unsubscribe_email,
  unsubscribe_push,
  unsubscribe_sms,
  hh_send,
  hh_unsubscribe,
  engaged
from int;

--shopping channel
create or replace temporary table shopping_channel_hh as
with
hh_level as (
select household_id,
max(case when ecom_ind=0 then 1 else 0 end) as instore_engaged,
max(ecom_ind) as ecom_engaged,
from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_TXN
where txn_dte between min_obs_date - 1 - 12*7 and min_obs_date - 1
group by 1)
select *,
case when instore_engaged=1 and ecom_engaged=1 then 1 else 0 end as omni_channel
from hh_level;
--
create or replace temporary table customer_profile as
with 
hh_division as (
select household_id,
primary_division_id as division_id,
FACTS_SEGMENT_NAME
from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_HH_PRIM_STORE
where fiscal_week_id <= fiscal_week_id_customer_profile
--QUALIFY ROW_NUMBER() over (partition by household_id order by NULL) = 1
QUALIFY ROW_NUMBER() over (partition by household_id order by fiscal_week_id desc) = 1
),
--HH with at least 1 B4U redemption in the last 12 wks
b4u_eng as (
select
    household_id,
    sum(B4U_REDEMPTIONS) as b4u_reds
  from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_HH_Eng
  where fiscal_week_id between run_fiscal_week_id_12_w_ago and fiscal_week_id_customer_profile
  group by 1
  having sum(b4u_REDEMPTIONS)>0
),
-- HH who are FreshPass members before the campaign started
-- fresh_pass as (
-- select distinct household_id, 1 as freshpass,
-- case when FRESHPASS_SUBSCRIPTION_DT < min_obs_date then 1 else 0 end as fresh_pass_registered,  
-- from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_CUSTOMER_PROFILE d
-- where TRUE
-- and DW_CURRENT_VERSION_IND
-- and REG_REPORT_IND
-- ),
-- HH with login and shopping since beginning of FY24
dig_eng as (
select household_id, 1 as digitally_engaged
from  gcp-abs-udco-bsvw-prod-prj-01.udco_ds_bizops.DIG_ENG_OKR_STAGE_FISCAL a
WHERE TRUE 
AND DIGITALLY_ENGAGED_12W=1
and fiscal_week_id = fiscal_week_id_customer_profile
group by 1,2
)
select 
t.household_id,
d.division_id,
d.facts_segment_name,
COALESCE(b4u_reds,0) as b4u_reds_12_wk,
-- COALESCE(freshpass,0) as freshpass,
COALESCE(digitally_engaged,0) as digitally_engaged,
from tvc t
left join hh_division d on t.household_id=d.household_id
left join b4u_eng b on t.household_id=b.household_id
-- left join fresh_pass f on t.household_id=f.household_id
left join dig_eng  de on t.household_id=de.household_id;

-- weekly spend
create or replace temporary table hh_avg_weekly_spend as
with
all_hh as (
select household_id
        from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_MR_FISCAL_WK_HH_SPEND_EDW  
        where week_id between (run_fiscal_week_id_12_w_ago) and fiscal_week_id_customer_profile	
        group by 1
),
all_weeks as (
select fiscal_week_id as week_id
        from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_DATES 
        where fiscal_week_id between (run_fiscal_week_id_12_w_ago) and fiscal_week_id_customer_profile			
        group by 1
),
all_hh_weeks as (
select household_id,week_id
from all_hh
cross join all_weeks
),
spends as (
select household_id
        , week_id
        , cast(sum(net_amt) as decimal) as avg_wkly_spend
        , sum(TXN_CNT) as avg_wkly_txn
        from gcp-abs-udco-bqvw-prod-prj-01.udco_ds_cust.C360_MR_FISCAL_WK_HH_SPEND_EDW
        where week_id between (run_fiscal_week_id_12_w_ago) and fiscal_week_id_customer_profile	
        
        group by 1,2
),
hh_week_spend as (
select
a.household_id,
a.week_id,
coalesce (avg_wkly_spend, 0) as weekly_spend,
coalesce (avg_wkly_txn, 0) as weekly_txn
from all_hh_weeks a
left join spends b on a.household_id=b.household_id and a.week_id=b.week_id
)
select household_id
	, sum(weekly_spend)/12 as avg_weekly_spend_hh
	, stddev_samp(weekly_spend) as sd_avg_weekly_spend_hh
    , sum(weekly_txn)/12 as avg_weekly_txn_hh
from hh_week_spend
group by 1;


-- funnel + dimensions
create or replace temporary table tvc_funnel_w_dimensions as
select t.household_id,
t.target_group as target_group_tvc,
t.email_flag,
t.push_flag,
t.sms_flag,
t.channel as channel_tvc,
t.division_id as division_id_tvc,
t.b4u_status as b4u_status_tvc,
t.facts_seg as facts_seg_tvc,
t.avg_weekly_spend_bucket as avg_weekly_spend_bucket_tvc,
t.true_price_segment_id as true_price_segment_id_tvc,
t.my_needs_segment_id as my_needs_segment_id_tvc,
t.ecom_ind as ecom_ind_tvc,
case 
    when COALESCE(f.hh_send,0) > 0 and t.target_group='Test' then "Test" 
    when COALESCE(f.hh_send,0) > 0 and t.target_group='Control' then null
    when COALESCE(f.hh_send,0) = 0 and t.target_group='Test' then 'Control_2'
    when COALESCE(f.hh_send,0) = 0 and t.target_group='Control' then 'Control_1'
end as target_group_ops,
case 
    when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) = 0 then '1.Email-only'
    when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) = 0 then '2.Push-only'
    when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) > 0 then '3.SMS-only'
    when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) = 0 then '4.Email+Push'
    when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) > 0 then '5.Email+SMS'
    when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) > 0 then '6.Push+SMS'
    when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) > 0 then '7.Email+Push+SMS'
    else t.channel
end as channel_ops,
case 
    when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) = 0 then '1.Email-only'
    when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) = 0 then '2.Push-only'
    when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) > 0 then '3.SMS-only'
    when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) = 0 then '4.Email+Push'
    when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) > 0 then '5.Email+SMS'
    when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) > 0 then '6.Push+SMS'
    when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) > 0 then '7.Email+Push+SMS'
    else '8.No Communication Sent'
end as channel_ops_2,
f.* except (household_id),
cp.division_id,
facts_segment_name,
b4u_reds_12_wk,
-- freshpass,
digitally_engaged,
COALESCE(clipped,0) as hh_clipped,
COALESCE(shopped,0) as hh_shopped,
COALESCE(redeemed,0) as hh_redeemed,
COALESCE(redemptions,0) as redemptions,
COALESCE(pd_redemptions,0) as pd_redemptions,
COALESCE(sc_redemptions,0) as sc_redemptions,
COALESCE(mf_redemptions,0) as mf_redemptions,
COALESCE(gr_redemptions,0) as gr_redemptions,
COALESCE(n_clips, 0) as n_clips,
COALESCE(pd_clips, 0) as pd_clips,
COALESCE(sc_clips, 0) as sc_clips,
COALESCE(mf_clips, 0) as mf_clips,
COALESCE(gr_clips, 0) as gr_clips,
COALESCE(txn_hh,0) as txn_hh,
COALESCE(qty_hh,0) as qty_hh,
COALESCE(net_sales_hh,0) as net_sales_hh,
COALESCE(gross_sales_hh,0) as gross_sales_hh,
COALESCE(sb_txn_hh,0) as sb_txn_hh,
COALESCE(sb_qty_hh,0) as sb_qty_hh,
COALESCE(sb_net_sales_hh,0) as sb_net_sales_hh,
COALESCE(sb_gross_sales_hh,0) as sb_gross_sales_hh,
COALESCE(sb_n_clips, 0) as sb_n_clips,
COALESCE(sb_pd_clips, 0) as sb_pd_clips,
COALESCE(sb_sc_clips, 0) as sb_sc_clips,
COALESCE(sb_mf_clips, 0) as sb_mf_clips,
COALESCE(sb_gr_clips, 0) as sb_gr_clips,
COALESCE(sb_redemptions,0) as sb_redemptions,
COALESCE(sb_pd_redemptions,0) as sb_pd_redemptions,
COALESCE(sb_sc_redemptions,0) as sb_sc_redemptions,
COALESCE(sb_mf_redemptions,0) as sb_mf_redemptions,
COALESCE(sb_gr_redemptions,0) as sb_gr_redemptions,
COALESCE(avg_weekly_spend_hh,0) as avg_weekly_spend_hh
-- COALESCE(instore_engaged,0) as instore_engaged,
-- COALESCE(ecom_engaged,0) as ecom_engaged,
-- COALESCE(omni_channel,0) as omni_channel,
-- case when ch.household_id is null then 1 else 0 end as non_shopping,
from tvc t
left join funnel f on t.household_id=f.household_id
left join customer_profile cp on t.household_id=cp.household_id
left join clip_in_observation_hh c on t.household_id=c.household_id
left join redeemed_in_observation_hh r on t.household_id=r.household_id
left join shopped_in_observation_hh s on t.household_id=s.household_id
left join clip_sb_in_observation_hh c_sb on t.household_id=c_sb.household_id
left join redeemed_sb_in_observation_hh r_sb on t.household_id=r_sb.household_id
left join shopped_sb_in_observation_hh s_sb on t.household_id=s_sb.household_id
left join hh_avg_weekly_spend aws on t.household_id=aws.household_id
-- left join shopping_channel_hh ch on f.household_id=ch.household_id
;

-- -- funnel + dimensions
-- create or replace table gcp-abs-udco-mkbz-prod-prj-01.udco_ds_dem.kd_superbowl_tvc_funnel_w_dimensions as
-- select t.household_id,
-- t.target_group as target_group_tvc,
-- t.email_flag,
-- t.push_flag,
-- t.sms_flag,
-- t.channel as channel_tvc,
-- t.division_id as division_id_tvc,
-- t.b4u_status as b4u_status_tvc,
-- t.facts_seg as facts_seg_tvc,
-- t.avg_weekly_spend_bucket as avg_weekly_spend_bucket_tvc,
-- t.true_price_segment_id as true_price_segment_id_tvc,
-- t.my_needs_segment_id as my_needs_segment_id_tvc,
-- t.ecom_ind as ecom_ind_tvc,
-- case 
--     when COALESCE(f.hh_send,0) > 0 and t.target_group='Test' then "Test" 
--     when COALESCE(f.hh_send,0) > 0 and t.target_group='Control' then null
--     when COALESCE(f.hh_send,0) = 0 and t.target_group='Test' then 'Control_2'
--     when COALESCE(f.hh_send,0) = 0 and t.target_group='Control' then 'Control_1'
-- end as target_group_ops,
-- case 
--     when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) = 0 then '1.Email-only'
--     when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) = 0 then '2.Push-only'
--     when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) > 0 then '3.SMS-only'
--     when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) = 0 then '4.Email+Push'
--     when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) > 0 then '5.Email+SMS'
--     when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) > 0 then '6.Push+SMS'
--     when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) > 0 then '7.Email+Push+SMS'
--     else t.channel
-- end as channel_ops,
-- case 
--     when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) = 0 then '1.Email-only'
--     when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) = 0 then '2.Push-only'
--     when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) > 0 then '3.SMS-only'
--     when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) = 0 then '4.Email+Push'
--     when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) = 0  and COALESCE(total_send_sms,0) > 0 then '5.Email+SMS'
--     when COALESCE(total_send_email,0) = 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) > 0 then '6.Push+SMS'
--     when COALESCE(total_send_email,0) > 0 and COALESCE(total_send_push,0) > 0  and COALESCE(total_send_sms,0) > 0 then '7.Email+Push+SMS'
--     else '8.No Communication Sent'
-- end as channel_ops_2,
-- f.* except (household_id),
-- cp.division_id,
-- facts_segment_name,
-- b4u_reds_12_wk,
-- freshpass,
-- digitally_engaged,
-- COALESCE(clipped,0) as hh_clipped,
-- COALESCE(shopped,0) as hh_shopped,
-- COALESCE(redeemed,0) as hh_redeemed,
-- COALESCE(redemptions,0) as redemptions,
-- COALESCE(n_clips, 0) as n_clips,
-- COALESCE(txn_hh,0) as txn_hh,
-- COALESCE(qty_hh,0) as qty_hh,
-- COALESCE(net_sales_hh,0) as net_sales_hh,
-- COALESCE(gross_sales_hh,0) as gross_sales_hh,
-- COALESCE(avg_weekly_spend_hh,0) as avg_weekly_spend_hh
-- -- COALESCE(instore_engaged,0) as instore_engaged,
-- -- COALESCE(ecom_engaged,0) as ecom_engaged,
-- -- COALESCE(omni_channel,0) as omni_channel,
-- -- case when ch.household_id is null then 1 else 0 end as non_shopping,
-- from tvc t
-- left join funnel f on t.household_id=f.household_id
-- left join customer_profile cp on t.household_id=cp.household_id
-- left join clip_in_observation_hh c on t.household_id=c.household_id
-- left join shopped_in_observation_hh s on t.household_id=s.household_id
-- left join redeemed_in_observation_hh r on t.household_id=r.household_id
-- left join hh_avg_weekly_spend aws on t.household_id=aws.household_id
-- left join shopping_channel_hh ch on f.household_id=ch.household_id
-- ;

--select target_group_tvc, target_group_ops, count(*) from tvc_funnel_w_dimensions group by 1,2;
--select channel_tvc, channel_ops, count(*) from tvc_funnel_w_dimensions group by 1,2;
--select target_group_tvc, target_group_ops, channel_tvc, count(*) from tvc_funnel_w_dimensions group by 1,2,3;
--select target_group_tvc, target_group_ops, channel_ops, count(*) from tvc_funnel_w_dimensions group by 1,2,3;
select channel_tvc, target_group_tvc, channel_ops_2, count(*) as count, COUNT(*) / SUM(COUNT(*)) OVER (PARTITION BY channel_tvc, target_group_tvc) AS percentage_within_group from tvc_funnel_w_dimensions group by 1,2,3 order by 1,2 desc, 3;
select target_group_tvc,
case 
    when channel_tvc = channel_ops_2 then '1.Same Communication'
    when channel_tvc != channel_ops_2 and channel_ops_2 != '8.No Communication Sent' then '2.Other Communication'
    when channel_ops_2 = '8.No Communication Sent' then '3.No Communication'
    else 'Not classified'
end as channel_ops_3, count(*) as count, COUNT(*) / SUM(COUNT(*)) OVER (PARTITION BY target_group_tvc) AS percentage_within_group
 from tvc_funnel_w_dimensions group by 1,2 order by 1 desc,2;
select channel_tvc, target_group_tvc,
case 
    when channel_tvc = channel_ops_2 then '1.Same Communication'
    when channel_tvc != channel_ops_2 and channel_ops_2 != '8.No Communication Sent' then '2.Other Communication'
    when channel_ops_2 = '8.No Communication Sent' then '3.No Communication'
    else 'Not classified'
end as channel_ops_3, count(*) as count, COUNT(*) / SUM(COUNT(*)) OVER (PARTITION BY channel_tvc, target_group_tvc) AS percentage_within_group
 from tvc_funnel_w_dimensions group by 1,2,3 order by 1,2 desc, 3;

 select  target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when txn_hh>0 then household_id else null end) as buying_hhs,
  sum(COALESCE(txn_hh,0)) as transactions,
  sum(COALESCE(qty_hh,0)) as quantities_sold,
  sum(COALESCE(net_sales_hh,0)) as net_sales,
  sum(COALESCE(gross_sales_hh,0)) as gross_sales,
  sum(COALESCE(n_clips,0)) as total_offers_clipped,
  sum(COALESCE(pd_clips,0)) as pd_offers_clipped,
  sum(COALESCE(sc_clips,0)) as sc_offers_clipped,
  sum(COALESCE(mf_clips,0)) as mf_offers_clipped,
  -- sum(COALESCE(gr_clips,0)) as gr_offers_clipped,
  count(case when COALESCE(n_clips,0)>0 then household_id else null end) as clipping_hhs,
  sum(COALESCE(redemptions,0)) as redemptions,
  sum(COALESCE(pd_redemptions,0)) as pd_redemptions,
  sum(COALESCE(sc_redemptions,0)) as sc_redemptions,
  sum(COALESCE(mf_redemptions,0)) as mf_redemptions,
  -- sum(COALESCE(gr_redemptions,0)) as gr_redemptions,
  count(case when COALESCE(redemptions,0)>0 then household_id else null end) as redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  

  -- count(case when COALESCE(engaged,0)>0 then household_id else null end) as engaged_hhs, 
  -- count(case when txn_hh>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_buying_hhs,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(txn_hh,0) else null end) as engaged_transactions,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(qty_hh,0) else null end) as engaged_quantities_sold,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(net_sales_hh,0) else null end) as engaged_net_sales,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(gross_sales_hh,0) else null end) as engaged_gross_sales,
  -- avg(case when COALESCE(engaged,0)>0 then COALESCE(avg_weekly_spend_hh,0) else null end) as engaged_avg_weekly_spend,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(n_clips,0) else null end) as engaged_total_offers_clipped,
  --count(case when COALESCE(n_clips,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_clipping_hhs,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(redemptions,0) else null end) as engaged_redemptions,
  --count(case when COALESCE(redemptions,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_redeeming_hhs
  from tvc_funnel_w_dimensions
  --where target_group_ops is not null
  group by 1
  order by 1 desc;

select  channel_tvc, target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when txn_hh>0 then household_id else null end) as buying_hhs,
  sum(COALESCE(txn_hh,0)) as transactions,
  sum(COALESCE(qty_hh,0)) as quantities_sold,
  sum(COALESCE(net_sales_hh,0)) as net_sales,
  sum(COALESCE(gross_sales_hh,0)) as gross_sales,
  sum(COALESCE(n_clips,0)) as total_offers_clipped,
  sum(COALESCE(pd_clips,0)) as pd_offers_clipped,
  sum(COALESCE(sc_clips,0)) as sc_offers_clipped,
  sum(COALESCE(mf_clips,0)) as mf_offers_clipped,
  -- sum(COALESCE(gr_clips,0)) as gr_offers_clipped,
  count(case when COALESCE(n_clips,0)>0 then household_id else null end) as clipping_hhs,
  sum(COALESCE(redemptions,0)) as redemptions,
  sum(COALESCE(pd_redemptions,0)) as pd_redemptions,
  sum(COALESCE(sc_redemptions,0)) as sc_redemptions,
  sum(COALESCE(mf_redemptions,0)) as mf_redemptions,
  -- sum(COALESCE(gr_redemptions,0)) as gr_redemptions,
  count(case when COALESCE(redemptions,0)>0 then household_id else null end) as redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  

  -- count(case when COALESCE(engaged,0)>0 then household_id else null end) as engaged_hhs, 
  -- count(case when txn_hh>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_buying_hhs,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(txn_hh,0) else null end) as engaged_transactions,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(qty_hh,0) else null end) as engaged_quantities_sold,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(net_sales_hh,0) else null end) as engaged_net_sales,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(gross_sales_hh,0) else null end) as engaged_gross_sales,
  -- avg(case when COALESCE(engaged,0)>0 then COALESCE(avg_weekly_spend_hh,0) else null end) as engaged_avg_weekly_spend,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(n_clips,0) else null end) as engaged_total_offers_clipped,
  --count(case when COALESCE(n_clips,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_clipping_hhs,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(redemptions,0) else null end) as engaged_redemptions,
  --count(case when COALESCE(redemptions,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_redeeming_hhs
  from tvc_funnel_w_dimensions
  --where target_group_ops is not null
  group by 1,2
  order by 1,2 desc;

select  facts_seg_tvc, target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when txn_hh>0 then household_id else null end) as buying_hhs,
  sum(COALESCE(txn_hh,0)) as transactions,
  sum(COALESCE(qty_hh,0)) as quantities_sold,
  sum(COALESCE(net_sales_hh,0)) as net_sales,
  sum(COALESCE(gross_sales_hh,0)) as gross_sales,
  sum(COALESCE(n_clips,0)) as total_offers_clipped,
  sum(COALESCE(pd_clips,0)) as pd_offers_clipped,
  sum(COALESCE(sc_clips,0)) as sc_offers_clipped,
  sum(COALESCE(mf_clips,0)) as mf_offers_clipped,
  -- sum(COALESCE(gr_clips,0)) as gr_offers_clipped,
  count(case when COALESCE(n_clips,0)>0 then household_id else null end) as clipping_hhs,
  sum(COALESCE(redemptions,0)) as redemptions,
  sum(COALESCE(pd_redemptions,0)) as pd_redemptions,
  sum(COALESCE(sc_redemptions,0)) as sc_redemptions,
  sum(COALESCE(mf_redemptions,0)) as mf_redemptions,
  -- sum(COALESCE(gr_redemptions,0)) as gr_redemptions,
  count(case when COALESCE(redemptions,0)>0 then household_id else null end) as redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  

  -- count(case when COALESCE(engaged,0)>0 then household_id else null end) as engaged_hhs, 
  -- count(case when txn_hh>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_buying_hhs,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(txn_hh,0) else null end) as engaged_transactions,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(qty_hh,0) else null end) as engaged_quantities_sold,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(net_sales_hh,0) else null end) as engaged_net_sales,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(gross_sales_hh,0) else null end) as engaged_gross_sales,
  -- avg(case when COALESCE(engaged,0)>0 then COALESCE(avg_weekly_spend_hh,0) else null end) as engaged_avg_weekly_spend,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(n_clips,0) else null end) as engaged_total_offers_clipped,
  --count(case when COALESCE(n_clips,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_clipping_hhs,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(redemptions,0) else null end) as engaged_redemptions,
  --count(case when COALESCE(redemptions,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_redeeming_hhs
  from tvc_funnel_w_dimensions
  --where target_group_ops is not null
  group by 1,2
  order by 1,2 desc;


select  division_id_tvc, target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when txn_hh>0 then household_id else null end) as buying_hhs,
  sum(COALESCE(txn_hh,0)) as transactions,
  sum(COALESCE(qty_hh,0)) as quantities_sold,
  sum(COALESCE(net_sales_hh,0)) as net_sales,
  sum(COALESCE(gross_sales_hh,0)) as gross_sales,
  sum(COALESCE(n_clips,0)) as total_offers_clipped,
  sum(COALESCE(pd_clips,0)) as pd_offers_clipped,
  sum(COALESCE(sc_clips,0)) as sc_offers_clipped,
  sum(COALESCE(mf_clips,0)) as mf_offers_clipped,
  -- sum(COALESCE(gr_clips,0)) as gr_offers_clipped,
  count(case when COALESCE(n_clips,0)>0 then household_id else null end) as clipping_hhs,
  sum(COALESCE(redemptions,0)) as redemptions,
  sum(COALESCE(pd_redemptions,0)) as pd_redemptions,
  sum(COALESCE(sc_redemptions,0)) as sc_redemptions,
  sum(COALESCE(mf_redemptions,0)) as mf_redemptions,
  -- sum(COALESCE(gr_redemptions,0)) as gr_redemptions,
  count(case when COALESCE(redemptions,0)>0 then household_id else null end) as redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  

  -- count(case when COALESCE(engaged,0)>0 then household_id else null end) as engaged_hhs, 
  -- count(case when txn_hh>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_buying_hhs,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(txn_hh,0) else null end) as engaged_transactions,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(qty_hh,0) else null end) as engaged_quantities_sold,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(net_sales_hh,0) else null end) as engaged_net_sales,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(gross_sales_hh,0) else null end) as engaged_gross_sales,
  -- avg(case when COALESCE(engaged,0)>0 then COALESCE(avg_weekly_spend_hh,0) else null end) as engaged_avg_weekly_spend,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(n_clips,0) else null end) as engaged_total_offers_clipped,
  --count(case when COALESCE(n_clips,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_clipping_hhs,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(redemptions,0) else null end) as engaged_redemptions,
  --count(case when COALESCE(redemptions,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_redeeming_hhs
  from tvc_funnel_w_dimensions
  --where target_group_ops is not null
  group by 1,2
  order by 1,2 desc;

select  ecom_ind_tvc, target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when txn_hh>0 then household_id else null end) as buying_hhs,
  sum(COALESCE(txn_hh,0)) as transactions,
  sum(COALESCE(qty_hh,0)) as quantities_sold,
  sum(COALESCE(net_sales_hh,0)) as net_sales,
  sum(COALESCE(gross_sales_hh,0)) as gross_sales,
  sum(COALESCE(n_clips,0)) as total_offers_clipped,
  sum(COALESCE(pd_clips,0)) as pd_offers_clipped,
  sum(COALESCE(sc_clips,0)) as sc_offers_clipped,
  sum(COALESCE(mf_clips,0)) as mf_offers_clipped,
  -- sum(COALESCE(gr_clips,0)) as gr_offers_clipped,
  count(case when COALESCE(n_clips,0)>0 then household_id else null end) as clipping_hhs,
  sum(COALESCE(redemptions,0)) as redemptions,
  sum(COALESCE(pd_redemptions,0)) as pd_redemptions,
  sum(COALESCE(sc_redemptions,0)) as sc_redemptions,
  sum(COALESCE(mf_redemptions,0)) as mf_redemptions,
  -- sum(COALESCE(gr_redemptions,0)) as gr_redemptions,
  count(case when COALESCE(redemptions,0)>0 then household_id else null end) as redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  

  -- count(case when COALESCE(engaged,0)>0 then household_id else null end) as engaged_hhs, 
  -- count(case when txn_hh>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_buying_hhs,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(txn_hh,0) else null end) as engaged_transactions,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(qty_hh,0) else null end) as engaged_quantities_sold,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(net_sales_hh,0) else null end) as engaged_net_sales,
  -- sum(case when COALESCE(engaged,0)>0 then COALESCE(gross_sales_hh,0) else null end) as engaged_gross_sales,
  -- avg(case when COALESCE(engaged,0)>0 then COALESCE(avg_weekly_spend_hh,0) else null end) as engaged_avg_weekly_spend,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(n_clips,0) else null end) as engaged_total_offers_clipped,
  --count(case when COALESCE(n_clips,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_clipping_hhs,
  --sum(case when COALESCE(engaged,0)>0 then COALESCE(redemptions,0) else null end) as engaged_redemptions,
  --count(case when COALESCE(redemptions,0)>0 and COALESCE(engaged,0)>0 then household_id else null end) as engaged_redeeming_hhs
  from tvc_funnel_w_dimensions
  --where target_group_ops is not null
  group by 1,2
  order by 1,2 desc;

  
select  target_group_tvc, 
  count(distinct household_id) as hhs, 
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_pre_weekly_spend,
  avg(COALESCE(net_sales_hh,0)) as avg_post_weekly_spend,
  stddev_pop(COALESCE(avg_weekly_spend_hh,0)) as std_pre_weekly_spend,
  stddev_pop(COALESCE(net_sales_hh,0)) as std_post_weekly_spend,

  stddev_pop(case when txn_hh>0 then 1 else 0 end) as std_buying_hhs_perc, 
  stddev_pop(COALESCE(net_sales_hh,0)) as std_spend_per_hh,
  stddev_pop(case when txn_hh>0 then COALESCE(net_sales_hh,0)/COALESCE(txn_hh,0) else 0 end) as std_spend_per_visit,  
  stddev_pop(COALESCE(txn_hh,0)) as std_visit_per_hh, 
  stddev_pop(case when qty_hh>0 then COALESCE(net_sales_hh,0)/COALESCE(qty_hh,0) else 0 end) as std_spend_per_unit, 
  stddev_pop(case when txn_hh>0 then COALESCE(qty_hh,0)/COALESCE(txn_hh,0) else 0 end) as std_units_per_visit, 

  count(case when txn_hh>0 then household_id else null end)/count(distinct household_id) as buying_hhs_perc,
  avg(COALESCE(net_sales_hh,0)) as spend_per_hh,
  sum(COALESCE(net_sales_hh,0))/sum(COALESCE(txn_hh,0)) as spend_per_visit,
  sum(COALESCE(txn_hh,0))/count(distinct household_id) as visit_per_hh,
  sum(COALESCE(net_sales_hh,0))/sum(COALESCE(qty_hh,0)) as spend_per_unit,
  sum(COALESCE(qty_hh,0))/sum(COALESCE(txn_hh,0)) as units_per_visit
  from tvc_funnel_w_dimensions
  group by 1
  order by 1 desc;

select 
  count(distinct household_id) as hhs, 
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_pre_weekly_spend,
  avg(COALESCE(net_sales_hh,0)) as avg_post_weekly_spend,
  stddev_pop(COALESCE(avg_weekly_spend_hh,0)) as std_pre_weekly_spend,
  stddev_pop(COALESCE(net_sales_hh,0)) as std_post_weekly_spend,

  stddev_pop(case when txn_hh>0 then 1 else 0 end) as std_buying_hhs_perc, 
  stddev_pop(COALESCE(net_sales_hh,0)) as std_spend_per_hh,
  stddev_pop(case when txn_hh>0 then COALESCE(net_sales_hh,0)/COALESCE(txn_hh,0) else 0 end) as std_spend_per_visit,  
  stddev_pop(COALESCE(txn_hh,0)) as std_visit_per_hh, 
  stddev_pop(case when qty_hh>0 then COALESCE(net_sales_hh,0)/COALESCE(qty_hh,0) else 0 end) as std_spend_per_unit, 
  stddev_pop(case when txn_hh>0 then COALESCE(qty_hh,0)/COALESCE(txn_hh,0) else 0 end) as std_units_per_visit, 

  count(case when txn_hh>0 then household_id else null end)/count(distinct household_id) as buying_hhs_perc,
  avg(COALESCE(net_sales_hh,0)) as spend_per_hh,
  sum(COALESCE(net_sales_hh,0))/sum(COALESCE(txn_hh,0)) as spend_per_visit,
  sum(COALESCE(txn_hh,0))/count(distinct household_id) as visit_per_hh,
  sum(COALESCE(net_sales_hh,0))/sum(COALESCE(qty_hh,0)) as spend_per_unit,
  sum(COALESCE(qty_hh,0))/sum(COALESCE(txn_hh,0)) as units_per_visit
  from tvc_funnel_w_dimensions
  order by 1 desc;

select  
  case when target_group_tvc != 'C' then 'A+B'
  else 'C' end as target_group_tvc, 
  count(distinct household_id) as hhs, 
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_pre_weekly_spend,
  avg(COALESCE(net_sales_hh,0)) as avg_post_weekly_spend,
  stddev_pop(COALESCE(avg_weekly_spend_hh,0)) as std_pre_weekly_spend,
  stddev_pop(COALESCE(net_sales_hh,0)) as std_post_weekly_spend,

  stddev_pop(case when txn_hh>0 then 1 else 0 end) as std_buying_hhs_perc, 
  stddev_pop(COALESCE(net_sales_hh,0)) as std_spend_per_hh,
  stddev_pop(case when txn_hh>0 then COALESCE(net_sales_hh,0)/COALESCE(txn_hh,0) else 0 end) as std_spend_per_visit,  
  stddev_pop(COALESCE(txn_hh,0)) as std_visit_per_hh, 
  stddev_pop(case when qty_hh>0 then COALESCE(net_sales_hh,0)/COALESCE(qty_hh,0) else 0 end) as std_spend_per_unit, 
  stddev_pop(case when txn_hh>0 then COALESCE(qty_hh,0)/COALESCE(txn_hh,0) else 0 end) as std_units_per_visit, 

  count(case when txn_hh>0 then household_id else null end)/count(distinct household_id) as buying_hhs_perc,
  avg(COALESCE(net_sales_hh,0)) as spend_per_hh,
  sum(COALESCE(net_sales_hh,0))/sum(COALESCE(txn_hh,0)) as spend_per_visit,
  sum(COALESCE(txn_hh,0))/count(distinct household_id) as visit_per_hh,
  sum(COALESCE(net_sales_hh,0))/sum(COALESCE(qty_hh,0)) as spend_per_unit,
  sum(COALESCE(qty_hh,0))/sum(COALESCE(txn_hh,0)) as units_per_visit
  from tvc_funnel_w_dimensions
  group by 1
  order by 1 desc;


select  facts_seg_tvc, target_group_tvc, 
  count(distinct household_id) as hhs, 
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_pre_weekly_spend,
  avg(COALESCE(net_sales_hh,0)) as avg_post_weekly_spend,
  stddev_pop(COALESCE(avg_weekly_spend_hh,0)) as std_pre_weekly_spend,
  stddev_pop(COALESCE(net_sales_hh,0)) as std_post_weekly_spend,

  stddev_pop(case when txn_hh>0 then 1 else 0 end) as std_buying_hhs_perc, 
  stddev_pop(COALESCE(net_sales_hh,0)) as std_spend_per_hh,
  stddev_pop(case when txn_hh>0 then COALESCE(net_sales_hh,0)/COALESCE(txn_hh,0) else 0 end) as std_spend_per_visit,  
  stddev_pop(COALESCE(txn_hh,0)) as std_visit_per_hh, 
  stddev_pop(case when qty_hh>0 then COALESCE(net_sales_hh,0)/COALESCE(qty_hh,0) else 0 end) as std_spend_per_unit, 
  stddev_pop(case when txn_hh>0 then COALESCE(qty_hh,0)/COALESCE(txn_hh,0) else 0 end) as std_units_per_visit, 

  count(case when txn_hh>0 then household_id else null end)/count(distinct household_id) as buying_hhs_perc,
  avg(COALESCE(net_sales_hh,0)) as spend_per_hh,
  sum(COALESCE(net_sales_hh,0))/sum(COALESCE(txn_hh,0)) as spend_per_visit,
  sum(COALESCE(txn_hh,0))/count(distinct household_id) as visit_per_hh,
  sum(COALESCE(net_sales_hh,0))/sum(COALESCE(qty_hh,0)) as spend_per_unit,
  sum(COALESCE(qty_hh,0))/sum(COALESCE(txn_hh,0)) as units_per_visit
  from tvc_funnel_w_dimensions
  group by 1, 2
  order by 1, 2 desc;
  
-- select * from tvc_funnel_w_dimensions limit 100;

-- select target_group_tvc, count(*) as `All HHs`, sum(coalesce(push_flag_sent,0)) as `Push Sent HHs`, avg(coalesce(push_flag_sent,0)) as `Push Sent HHs` from tvc_funnel_w_dimensions group by all ;
-- select target_group_tvc, count(*) as `All HHs`, sum(case when total_send_push > 0 then 1 else 0 end) as `Push Sent HHs`, avg(case when total_send_push > 0 then 1 else 0 end) as `Push Sent HHs` from tvc_funnel_w_dimensions group by all ;


select target_group_tvc, count(*) as `All HHs`, sum(case when email_flag>0 then 1 else 0 end) as `Email Enabled HHs`, sum(case when total_send_email > 0 then 1 else 0 end) as `Email Sent HHs`, sum(case when total_send_email > 0 then 1 else 0 end)/NULLIF(sum(case when email_flag>0 then 1 else 0 end),0) as `Email Sent HHs %`,  sum(case when distinct_click_email > 0 then 1 else 0 end) as `Email Click HHs`, sum(case when distinct_click_email > 0 then 1 else 0 end)/NULLIF(sum(case when total_send_email > 0 then 1 else 0 end),0) as `Email Click vs Send HHs%`, sum(total_send_email) as `Total Emails Sent`, sum(total_click_email) as `Total Emails Clicked`, sum(total_click_email)/NULLIF(sum(total_send_email),0) as `Email CTR`, sum(case when unsubscribe_email>0 then 1 else 0 end) as `Email Unsubscribe HHs`, sum(case when unsubscribe_email>0 then 1 else 0 end)/NULLIF(sum(case when total_send_email > 0 then 1 else 0 end),0) as `Email Unsubscribe HHs%` from tvc_funnel_w_dimensions group by all  order by 1 desc;

select target_group_tvc, count(*) as `All HHs`, sum(case when push_flag>0 then 1 else 0 end) as `Push Enabled HHs`, sum(case when total_send_push > 0 then 1 else 0 end) as `Push Sent HHs`, sum(case when total_send_push > 0 then 1 else 0 end)/NULLIF(sum(case when push_flag>0 then 1 else 0 end),0) as `Push Sent HHs %`,  sum(case when distinct_open_push > 0 then 1 else 0 end) as `Push Open HHs`, sum(case when distinct_open_push > 0 then 1 else 0 end)/NULLIF(sum(case when total_send_push > 0 then 1 else 0 end),0) as `Push Open vs Send HHs%`, sum(total_send_push) as `Total Pushes Sent`, sum(total_open_push) as `Total Pushes Opened`, sum(total_open_push)/NULLIF(sum(total_send_push),0) as `Push Open Rate`, sum(case when unsubscribe_push>0 then 1 else 0 end) as `Push Unsubscribe HHs`, sum(case when unsubscribe_push>0 then 1 else 0 end)/NULLIF(sum(case when total_send_push > 0 then 1 else 0 end),0) as `Push Unsubscribe HHs%` from tvc_funnel_w_dimensions group by all  order by 1 desc;

select target_group_tvc, count(*) as `All HHs`, sum(case when sms_flag>0 then 1 else 0 end) as `SMS Enabled HHs`, sum(case when total_send_sms > 0 then 1 else 0 end) as `SMS Sent HHs`, sum(case when total_send_sms > 0 then 1 else 0 end)/NULLIF(sum(case when sms_flag>0 then 1 else 0 end),0) as `SMS Sent HHs %`,  sum(case when distinct_click_sms > 0 then 1 else 0 end) as `SMS Click HHs`, sum(case when distinct_click_sms > 0 then 1 else 0 end)/NULLIF(sum(case when total_send_sms > 0 then 1 else 0 end),0) as `SMS Click vs Send HHs%`, sum(total_send_sms) as `Total SMS Sent`, sum(total_click_sms) as `Total SMS Clicked`, sum(total_click_sms)/NULLIF(sum(total_send_sms),0) as `SMS CTR`, sum(case when unsubscribe_sms>0 then 1 else 0 end) as `SMS Unsubscribe HHs`, sum(case when unsubscribe_sms>0 then 1 else 0 end)/NULLIF(sum(case when total_send_sms > 0 then 1 else 0 end),0) as `SMS Unsubscribe HHs%` from tvc_funnel_w_dimensions group by all  order by 1 desc;

-- select channel_tvc, target_group_tvc, count(*) as `All HHs`, sum(case when email_flag>0 then 1 else 0 end) as `Email Enabled HHs`, sum(case when total_send_email > 0 then 1 else 0 end) as `Email Sent HHs`, sum(case when total_send_email > 0 then 1 else 0 end)/NULLIF(sum(case when email_flag>0 then 1 else 0 end),0) as `Email Sent HHs %`,  sum(case when distinct_click_email > 0 then 1 else 0 end) as `Email Click HHs`, sum(case when distinct_click_email > 0 then 1 else 0 end)/NULLIF(sum(case when total_send_email > 0 then 1 else 0 end),0) as `Email CTR`, sum(case when unsubscribe_email>0 then 1 else 0 end) as `Email Unsubscribe HHs` from tvc_funnel_w_dimensions group by all  order by 1 desc;

-- select channel_tvc, target_group_tvc, count(*) as `All HHs`, sum(case when push_flag>0 then 1 else 0 end) as `Push Enabled HHs`, sum(case when total_send_push > 0 then 1 else 0 end) as `Push Sent HHs`, sum(case when total_send_push > 0 then 1 else 0 end)/NULLIF(sum(case when push_flag>0 then 1 else 0 end),0) as `Push Sent HHs %`,  sum(case when distinct_open_push > 0 then 1 else 0 end) as `Push Open HHs`, sum(case when distinct_open_push > 0 then 1 else 0 end)/NULLIF(sum(case when total_send_push > 0 then 1 else 0 end),0) as `Push Open Rate`, sum(case when unsubscribe_push>0 then 1 else 0 end) as `Push Unsubscribe HHs` from tvc_funnel_w_dimensions group by all  order by 1 desc;

-- select channel_tvc, target_group_tvc, count(*) as `All HHs`, sum(case when sms_flag>0 then 1 else 0 end) as `SMS Enabled HHs`, sum(case when total_send_sms > 0 then 1 else 0 end) as `SMS Sent HHs`, sum(case when total_send_sms > 0 then 1 else 0 end)/NULLIF(sum(case when sms_flag>0 then 1 else 0 end),0) as `SMS Sent HHs %`,  sum(case when distinct_open_sms > 0 then 1 else 0 end) as `SMS Click HHs`, sum(case when distinct_open_sms > 0 then 1 else 0 end)/NULLIF(sum(case when total_send_sms > 0 then 1 else 0 end),0) as `SMS CTR`, sum(case when unsubscribe_sms>0 then 1 else 0 end) as `SMS Unsubscribe HHs` from tvc_funnel_w_dimensions group by all  order by 1 desc;

-- select division_id, target_group_tvc, count(*) as `All HHs`, sum(case when email_flag>0 then 1 else 0 end) as `Email Enabled HHs`, sum(case when total_send_email > 0 then 1 else 0 end) as `Email Sent HHs`, sum(case when total_send_email > 0 then 1 else 0 end)/NULLIF(sum(case when email_flag>0 then 1 else 0 end),0) as `Email Sent HHs %`,  sum(case when distinct_click_email > 0 then 1 else 0 end) as `Email Click HHs`, sum(case when distinct_click_email > 0 then 1 else 0 end)/NULLIF(sum(case when total_send_email > 0 then 1 else 0 end),0) as `Email CTR`, sum(case when unsubscribe_email>0 then 1 else 0 end) as `Email Unsubscribe HHs` from tvc_funnel_w_dimensions group by all  order by 1 desc;

-- select division_id, target_group_tvc, count(*) as `All HHs`, sum(case when push_flag>0 then 1 else 0 end) as `Push Enabled HHs`, sum(case when total_send_push > 0 then 1 else 0 end) as `Push Sent HHs`, sum(case when total_send_push > 0 then 1 else 0 end)/NULLIF(sum(case when push_flag>0 then 1 else 0 end),0) as `Push Sent HHs %`,  sum(case when distinct_open_push > 0 then 1 else 0 end) as `Push Open HHs`, sum(case when distinct_open_push > 0 then 1 else 0 end)/NULLIF(sum(case when total_send_push > 0 then 1 else 0 end),0) as `Push Open Rate`, sum(case when unsubscribe_push>0 then 1 else 0 end) as `Push Unsubscribe HHs` from tvc_funnel_w_dimensions group by all  order by 1 desc;

-- select division_id, target_group_tvc, count(*) as `All HHs`, sum(case when sms_flag>0 then 1 else 0 end) as `SMS Enabled HHs`, sum(case when total_send_sms > 0 then 1 else 0 end) as `SMS Sent HHs`, sum(case when total_send_sms > 0 then 1 else 0 end)/NULLIF(sum(case when sms_flag>0 then 1 else 0 end),0) as `SMS Sent HHs %`,  sum(case when distinct_open_sms > 0 then 1 else 0 end) as `SMS Click HHs`, sum(case when distinct_open_sms > 0 then 1 else 0 end)/NULLIF(sum(case when total_send_sms > 0 then 1 else 0 end),0) as `SMS CTR`, sum(case when unsubscribe_sms>0 then 1 else 0 end) as `SMS Unsubscribe HHs` from tvc_funnel_w_dimensions group by all  order by 1 desc;


 select  target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when sb_txn_hh>0 then household_id else null end) as sb_buying_hhs,
  sum(COALESCE(sb_txn_hh,0)) as sb_transactions,
  sum(COALESCE(sb_qty_hh,0)) as sb_quantities_sold,
  sum(COALESCE(sb_net_sales_hh,0)) as sb_net_sales,
  sum(COALESCE(sb_gross_sales_hh,0)) as sb_gross_sales,
  sum(COALESCE(sb_n_clips,0)) as sb_total_offers_clipped,
  sum(COALESCE(sb_pd_clips,0)) as sb_pd_offers_clipped,
  sum(COALESCE(sb_sc_clips,0)) as sb_sc_offers_clipped,
  sum(COALESCE(sb_mf_clips,0)) as sb_mf_offers_clipped,
  -- sum(COALESCE(sb_gr_clips,0)) as sb_gr_offers_clipped,
  count(case when COALESCE(sb_n_clips,0)>0 then household_id else null end) as sb_clipping_hhs,
  sum(COALESCE(sb_redemptions,0)) as sb_redemptions,
  sum(COALESCE(sb_pd_redemptions,0)) as sb_pd_redemptions,
  sum(COALESCE(sb_sc_redemptions,0)) as sb_sc_redemptions,
  sum(COALESCE(sb_mf_redemptions,0)) as sb_mf_redemptions,
  -- sum(COALESCE(sb_gr_redemptions,0)) as sb_gr_redemptions,
  count(case when COALESCE(sb_redemptions,0)>0 then household_id else null end) as sb_redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  from tvc_funnel_w_dimensions
  group by 1
  order by 1 desc;

select  channel_tvc, target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when sb_txn_hh>0 then household_id else null end) as sb_buying_hhs,
  sum(COALESCE(sb_txn_hh,0)) as sb_transactions,
  sum(COALESCE(sb_qty_hh,0)) as sb_quantities_sold,
  sum(COALESCE(sb_net_sales_hh,0)) as sb_net_sales,
  sum(COALESCE(sb_gross_sales_hh,0)) as sb_gross_sales,
  sum(COALESCE(sb_n_clips,0)) as sb_total_offers_clipped,
  sum(COALESCE(sb_pd_clips,0)) as sb_pd_offers_clipped,
  sum(COALESCE(sb_sc_clips,0)) as sb_sc_offers_clipped,
  sum(COALESCE(sb_mf_clips,0)) as sb_mf_offers_clipped,
  -- sum(COALESCE(sb_gr_clips,0)) as sb_gr_offers_clipped,
  count(case when COALESCE(sb_n_clips,0)>0 then household_id else null end) as sb_clipping_hhs,
  sum(COALESCE(sb_redemptions,0)) as sb_redemptions,
  sum(COALESCE(sb_pd_redemptions,0)) as sb_pd_redemptions,
  sum(COALESCE(sb_sc_redemptions,0)) as sb_sc_redemptions,
  sum(COALESCE(sb_mf_redemptions,0)) as sb_mf_redemptions,
  -- sum(COALESCE(sb_gr_redemptions,0)) as sb_gr_redemptions,
  count(case when COALESCE(sb_redemptions,0)>0 then household_id else null end) as sb_redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  from tvc_funnel_w_dimensions
  group by 1,2
  order by 1,2 desc;

select  facts_seg_tvc, target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when sb_txn_hh>0 then household_id else null end) as sb_buying_hhs,
  sum(COALESCE(sb_txn_hh,0)) as sb_transactions,
  sum(COALESCE(sb_qty_hh,0)) as sb_quantities_sold,
  sum(COALESCE(sb_net_sales_hh,0)) as sb_net_sales,
  sum(COALESCE(sb_gross_sales_hh,0)) as sb_gross_sales,
  sum(COALESCE(sb_n_clips,0)) as sb_total_offers_clipped,
  sum(COALESCE(sb_pd_clips,0)) as sb_pd_offers_clipped,
  sum(COALESCE(sb_sc_clips,0)) as sb_sc_offers_clipped,
  sum(COALESCE(sb_mf_clips,0)) as sb_mf_offers_clipped,
  -- sum(COALESCE(sb_gr_clips,0)) as sb_gr_offers_clipped,
  count(case when COALESCE(sb_n_clips,0)>0 then household_id else null end) as sb_clipping_hhs,
  sum(COALESCE(sb_redemptions,0)) as sb_redemptions,
  sum(COALESCE(sb_pd_redemptions,0)) as sb_pd_redemptions,
  sum(COALESCE(sb_sc_redemptions,0)) as sb_sc_redemptions,
  sum(COALESCE(sb_mf_redemptions,0)) as sb_mf_redemptions,
  -- sum(COALESCE(sb_gr_redemptions,0)) as sb_gr_redemptions,
  count(case when COALESCE(sb_redemptions,0)>0 then household_id else null end) as sb_redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  from tvc_funnel_w_dimensions
  group by 1,2
  order by 1,2 desc;


select  ecom_ind_tvc, target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when sb_txn_hh>0 then household_id else null end) as sb_buying_hhs,
  sum(COALESCE(sb_txn_hh,0)) as sb_transactions,
  sum(COALESCE(sb_qty_hh,0)) as sb_quantities_sold,
  sum(COALESCE(sb_net_sales_hh,0)) as sb_net_sales,
  sum(COALESCE(sb_gross_sales_hh,0)) as sb_gross_sales,
  sum(COALESCE(sb_n_clips,0)) as sb_total_offers_clipped,
  sum(COALESCE(sb_pd_clips,0)) as sb_pd_offers_clipped,
  sum(COALESCE(sb_sc_clips,0)) as sb_sc_offers_clipped,
  sum(COALESCE(sb_mf_clips,0)) as sb_mf_offers_clipped,
  -- sum(COALESCE(sb_gr_clips,0)) as sb_gr_offers_clipped,
  count(case when COALESCE(sb_n_clips,0)>0 then household_id else null end) as sb_clipping_hhs,
  sum(COALESCE(sb_redemptions,0)) as sb_redemptions,
  sum(COALESCE(sb_pd_redemptions,0)) as sb_pd_redemptions,
  sum(COALESCE(sb_sc_redemptions,0)) as sb_sc_redemptions,
  sum(COALESCE(sb_mf_redemptions,0)) as sb_mf_redemptions,
  -- sum(COALESCE(sb_gr_redemptions,0)) as sb_gr_redemptions,
  count(case when COALESCE(sb_redemptions,0)>0 then household_id else null end) as sb_redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  from tvc_funnel_w_dimensions
  group by 1,2
  order by 1,2 desc;

select  division_id_tvc, target_group_tvc, 
  count(distinct household_id) as hhs, 
  count(case when sb_txn_hh>0 then household_id else null end) as sb_buying_hhs,
  sum(COALESCE(sb_txn_hh,0)) as sb_transactions,
  sum(COALESCE(sb_qty_hh,0)) as sb_quantities_sold,
  sum(COALESCE(sb_net_sales_hh,0)) as sb_net_sales,
  sum(COALESCE(sb_gross_sales_hh,0)) as sb_gross_sales,
  sum(COALESCE(sb_n_clips,0)) as sb_total_offers_clipped,
  sum(COALESCE(sb_pd_clips,0)) as sb_pd_offers_clipped,
  sum(COALESCE(sb_sc_clips,0)) as sb_sc_offers_clipped,
  sum(COALESCE(sb_mf_clips,0)) as sb_mf_offers_clipped,
  -- sum(COALESCE(sb_gr_clips,0)) as sb_gr_offers_clipped,
  count(case when COALESCE(sb_n_clips,0)>0 then household_id else null end) as sb_clipping_hhs,
  sum(COALESCE(sb_redemptions,0)) as sb_redemptions,
  sum(COALESCE(sb_pd_redemptions,0)) as sb_pd_redemptions,
  sum(COALESCE(sb_sc_redemptions,0)) as sb_sc_redemptions,
  sum(COALESCE(sb_mf_redemptions,0)) as sb_mf_redemptions,
  -- sum(COALESCE(sb_gr_redemptions,0)) as sb_gr_redemptions,
  count(case when COALESCE(sb_redemptions,0)>0 then household_id else null end) as sb_redeeming_hhs,
  avg(COALESCE(avg_weekly_spend_hh,0)) as avg_weekly_spend,
  from tvc_funnel_w_dimensions
  group by 1,2
  order by 1,2 desc;

select sum(case when failed_to_send=0 then send else 0 end) as email_sends, sum(click) as clicks, sum(click)/sum(case when failed_to_send=0 then send else 0 end) as `Email CTR` from gcp-abs-udco-mkbz-prod-prj-01.udco_ds_dem.SQ_EMAIL_DATA
where True
and cast(send_date as date) >= '2024-10-01'
and cast(send_date as date) <= '2025-03-31'
and campaign in ('Weekly Savings', 'B_WeeklySavings')
group by all
order by 2 desc;

select campaign, sum(case when failed_to_send=0 then send else 0 end) as email_sends, sum(click) as clicks, sum(click)/sum(case when failed_to_send=0 then send else 0 end) as CTR from gcp-abs-udco-mkbz-prod-prj-01.udco_ds_dem.SQ_EMAIL_DATA
where True
and cast(send_date as date) >= '2024-10-01'
and cast(send_date as date) <= '2025-03-31'
and campaign = 'AdHoc'
group by all
order by 2 desc;


select sum(case when failed_to_send=0 then send else 0 end) as push_sends, sum(open) as opens, sum(open)/sum(case when failed_to_send=0 then send else 0 end) as `Push Open Rate` from gcp-abs-udco-mkbz-prod-prj-01.udco_ds_dem.SQ_PUSH_DATA
where True
and cast(send_date as date) >= '2024-10-01'
and cast(send_date as date) <= '2025-03-31'
and campaign in ('Ad Hoc', 'AdHoc')
group by all
order by 2 desc;

select sum(case when failed_to_send=0 then send else 0 end) as sms_sends, sum(click) as clicks, sum(click)/sum(case when failed_to_send=0 then send else 0 end) as `SMS CTR` from gcp-abs-udco-mkbz-prod-prj-01.udco_ds_dem.SQ_SMS_DATA
where True
and cast(send_date as date) >= '2024-10-01'
and cast(send_date as date) <= '2025-03-31'
and campaign in ('Adhoc')
group by all
order by 2 desc;

